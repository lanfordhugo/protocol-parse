meta:
  protocol: v8
  version: 1
  default_endian: LE
  notes: V8协议配置，支持充电桩通信数据解析

compatibility:
  head_len: 11
  tail_len: 2
  frame_head: "AA F5"
  head_fields:
    - {name: "cmd", offset: 4, length: 2, endian: "little", type: "uint"}
    - {name: "index", offset: 6, length: 2, endian: "little", type: "uint"}
    - {name: "deviceType", offset: 8, length: 1, endian: "little", type: "uint"}
    - {name: "addr", offset: 9, length: 1, endian: "little", type: "uint"}
    - {name: "gunNum", offset: 10, length: 1, endian: "little", type: "uint"}

types:
  uint8:   { base: uint, bytes: 1, signed: false }
  uint16:  { base: uint, bytes: 2, signed: false }
  uint32:  { base: uint, bytes: 4, signed: false }
  int32:   { base: int,  bytes: 4, signed: true }
  ascii:   { base: str,  encoding: ASCII }
  hex:     { base: hex }
  bcd4:    { base: bcd, bytes: 4 }
  bcd6:    { base: bcd, bytes: 6 }
  binary_str_1byte:  { base: binary_str, bytes: 1 }
  binary_str_2bytes: { base: binary_str, bytes: 2 }
  binary_str_3bytes: { base: binary_str, bytes: 3 }
  binary_str_4bytes: { base: binary_str, bytes: 4 }
  binary_str_8bytes: { base: binary_str, bytes: 8 }
  
  # 通用位段类型（仅描述存储形态）
  bitfield8:  { base: bitfield, bytes: 1, order: lsb0 }
  bitfield16: { base: bitfield, bytes: 2, order: lsb0 }
  bitfield32: { base: bitfield, bytes: 4, order: lsb0 }
  bitfield64: { base: bitfield, bytes: 8, order: lsb0 }

enums:
  login_result:
    0: 失败
    1: 成功
  charge_mode:
    1: 恒压充电
    2: 恒流充电
  work_status:
    0: 空闲
    1: 握手阶段
    2: 配置阶段
    3: 充电中
    4: 充电结束阶段
    5: 故障
    6: 副枪并充状态
    7: 维护模式
    8: 作为副枪并充中
  device_type:
    1: MCU
    2: M2
    3: C2
  gun_status:
    0: 空闲
    1: 准备
    2: 充电
    3: 故障
  pump_status:
    0: 正常
    1: 故障
    2: 手动
  upgrade_device_type:
    2: CCU/控制器
    3: 模块AC
    4: 模块DC
    6: 分体机主机控制器
    8: C2或C3板
    11: D1板
    12: 液冷M2板
    13: 液冷U1板
    14: 液冷U2板
  workshop_mode_cmd601:
    0: 退出所有工装流程
    1: 终端半自动工装模式
    2: 终端全自动工装模式
  workshop_mode_cmd607:
    0: 退出所有工装流程
    3: 主机半自动工装模式
  workshop_mode_cmd609:
    0: 退出所有工装流程
    4: 主机全自动工装模式
  workshop_result:
    170: 响应
    187: 拒绝响应
  workshop_refuse_reason:
    0: None
    1: 无效的设备类型
    2: 正在充电
    3: 已经处于工装模式
    4: 无效的工装模式参数
  terminal_type_auto:
    1: 单枪250A
    2: 双枪250A
    3: 单枪400A
    4: 双枪400A
    5: 液冷单枪
    6: 液冷双枪

cmds:
  # cmd1 - 设备信息上报
  1:
    - {len: 1, name: 硬件类型, type: uint8}
    - {len: 1, name: 拨码地址号, type: uint8}
    - {len: 1, name: 充电枪路数, type: uint8}
    - {len: 2, name: 项目号, type: uint16}
    - {len: 2, name: 软件版本号, type: uint16}
    - {len: 1, name: 需要更新参数, type: uint8}
    - {len: 32, name: 软件编译时间, type: ascii}
    - {len: 2, name: 硬件版本, type: uint16}
    - {len: 2, name: 协议版本号, type: uint16}

  # cmd2 - 登录响应
  2:
    - {len: 1, name: 登录结果, type: uint8, enum: login_result}
    - {len: 1, name: 登录失败原因, type: uint8}
    - {len: 2, name: MCU软件项目号, type: uint16}
    - {len: 2, name: MCU软件版本号, type: uint16}
    - {len: 1, name: 终端类型, type: uint8}
    - {len: 32, name: 终端桩编码, type: ascii}

  # cmd3 - 终端状态上报
  3:
    - {len: 1, name: 本终端枪数, type: uint8}
    - {len: 1, name: 车连接状态, type: uint8}
    - {len: 2, name: CC1电压, type: uint16, scale: 0.1}
    - {len: 1, name: 枪工作状态, type: uint8, enum: gun_status}
    - {len: 4, name: 当前枪最高告警编码, type: uint32}
    - {len: 2, name: 终端系统状态, type: binary_str_2bytes}
    - {len: 2, name: 枪状态, type: binary_str_2bytes}
    - {len: 1, name: 出风口温度, type: uint8, scale: 1}
    - {len: 1, name: 环境温度, type: uint8, scale: 1}
    - {len: 1, name: 枪正极温度, type: uint8, scale: 1}
    - {len: 1, name: 枪负极温度, type: uint8, scale: 1}

  # cmd4 - 服务器心跳包
  4:
    - {len: 4, name: 当前时间, type: uint32}
    - {len: 8, name: MCU 1枪告警状态, type: binary_str_8bytes}
    - {len: 8, name: MCU 2枪告警状态, type: binary_str_8bytes}
    - {len: 4, name: MCU对枪的禁用状态, type: binary_str_4bytes}

  # cmd5 - 启动充电命令
  5:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 1, name: 启动方式, type: uint8}
    - {len: 1, name: 限制SOC, type: uint8}
    - {len: 2, name: 限制充电电量, type: uint16, scale: 0.001}
    - {len: 2, name: 限功率大小, type: uint16, scale: 0.1}
    - {len: 1, name: BMS辅源电压, type: uint8, scale: 0.1}
    - {len: 32, name: 订单流水号, type: ascii}
    - {len: 1, name: VIN核对, type: uint8}
    - {len: 17, name: 车辆VIN码, type: ascii}
    - {len: 16, name: 停止充电密码, type: ascii}
    - {len: 1, name: 并充组网状态, type: uint8}
    - {len: 1, name: 组网枪数量, type: uint8}

  # cmd6 - 启动充电响应
  6:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 1, name: 命令执行结果, type: uint8}
    - {len: 2, name: 执行失败原因, type: uint16}

  # cmd7 - 停止充电命令
  7:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 停止原因, type: uint16}

  # cmd8 - 停止充电响应
  8:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 1, name: 命令执行结果, type: uint8}
    - {len: 1, name: 执行失败原因, type: uint8}

  # cmd9 - 充电握手阶段数据上报
  9:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 启动结果, type: uint16}
    - {len: 2, name: BMS协议类型, type: uint16}
    - {len: 3, name: 充电桩与 BMS 通信协议版本号, type: binary_str_3bytes}
    - {len: 3, name: BMS 与充电桩通信协议版本号, type: binary_str_3bytes}
    - {len: 2, name: 充电机最高输出电压, type: uint16, scale: 0.1}
    - {len: 2, name: 充电机最低输出电压, type: uint16, scale: 0.1}
    - {len: 2, name: 充电机最大输出电流, type: uint16, scale: 0.1}
    - {len: 2, name: BHM-绝缘电压, type: uint16, scale: 0.1}
    - {len: 1, name: BRM-电池类型, type: uint8}
    - {len: 2, name: BRM-整车动力蓄电池系统额定容量/Ah, type: uint16}
    - {len: 2, name: BRM-整车动力蓄电池系统额定总电压/V, type: uint16, scale: 0.1}
    - {len: 4, name: BRM-电池生产厂商, type: bcd4}
    - {len: 4, name: BRM-电池组序号, type: bcd4}
    - {len: 2, name: BRM-电池组生厂日期：年, type: uint16}
    - {len: 1, name: BRM-电池组生厂日期：月, type: uint8}
    - {len: 1, name: BRM-电池组生厂日期：日, type: uint8}
    - {len: 4, name: BRM-电池组充电次数, type: uint32}
    - {len: 1, name: BRM-电池组产权标识, type: uint8}
    - {len: 1, name: 预留, type: uint8}
    - {len: 17, name: BRM-车辆识别码vin, type: ascii}
    - {len: 8, name: BRM-BMS软件版本号, type: hex}
    - {len: 2, name: BCP-单体动力蓄电池最高允许充电电压, type: uint16, scale: 0.01}
    - {len: 2, name: BCP-最高允许充电电流, type: uint16, scale: 0.1}
    - {len: 2, name: BCP-动力蓄电池标称总能量, type: uint16, scale: 0.1}
    - {len: 2, name: BCP-最高允许充电总电压, type: uint16, scale: 0.1}
    - {len: 1, name: BCP-最高允许温度, type: uint8}
    - {len: 2, name: BCP-整车动力蓄电池荷电状态, type: uint16, scale: 0.1}
    - {len: 2, name: BCP-整车动力蓄电池当前电池电压, type: uint16, scale: 0.1}
    - {len: 1, name: BRO-BMS是否充电准备好, type: uint8}
    - {len: 2, name: 绝缘电压异常时模块电压值, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪绝缘设置电压, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪绝缘正电阻(无符号), type: uint16}
    - {len: 2, name: 主枪绝缘负电阻(无符号), type: uint16}
    - {len: 2, name: 主枪第一次绝缘正电压, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪第一次绝缘负电压, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪第二次绝缘正电压, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪第二次绝缘负电压, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪预启动枪头电压, type: uint16, scale: 0.1}
    - {len: 2, name: 主枪预启动模块电压, type: uint16, scale: 0.1}
    - {len: 2, name: BCP异常电压1, type: uint16, scale: 0.1}
    - {len: 2, name: BCP异常电压2, type: uint16, scale: 0.1}

  # cmd10 - 充电握手确认
  10:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 1, name: 确认结果, type: uint8}

  # cmd11 - 充电中BMS报文
  11:
    - {len: 16, name: BCS报文, type: hex, notes: "遵循27930最新协议标准"}
    - {len: 8, name: BSM报文, type: binary_str_8bytes, notes: "遵循27930最新协议标准"}

  # cmd13 - 充电结束数据上报
  13:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 停止充电原因, type: uint16}
    - {len: 4, name: 充电电量, type: uint32, scale: 0.001}
    - {len: 4, name: 开始电表电量, type: uint32, scale: 0.001}
    - {len: 4, name: 结束电表电量, type: uint32, scale: 0.001}
    - {len: 1, name: 开始SOC, type: uint8}
    - {len: 1, name: 结束SOC, type: uint8}
    - {len: 2, name: 停止参数1, type: uint16}
    - {len: 2, name: 停止参数2, type: uint16}
    - {len: 2, name: 停止参数3, type: uint16}
    - {len: 2, name: 停止参数4, type: uint16}
    - {len: 2, name: 停止参数5, type: uint16}
    - {len: 2, name: 停止参数6, type: uint16}
    - {len: 2, name: 停止参数7, type: uint16}
    - {len: 2, name: 停止参数8, type: uint16}
    - {len: 8, name: BST报文, type: binary_str_8bytes, notes: "遵循27930最新协议标准"}
    - {len: 8, name: BSD报文, type: binary_str_8bytes, notes: "遵循27930最新协议标准"}
    - {len: 8, name: BEM报文, type: binary_str_8bytes}
    - {len: 1, name: 充放电标志, type: uint8}
    - {len: 1, name: 瑞银电表标志, type: uint8}
    - {len: 34, name: 加密数据, type: hex}
    - {len: 6, name: 电表表号, type: bcd6}
    - {len: 2, name: 电表协议版本, type: uint16}
    - {len: 1, name: 加密方式, type: uint8}

  # cmd14 - 充电结束报文应答
  14:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 1, name: 确认结果, type: uint8}

  # cmd15 - 日志上传请求
  15:
    - {len: 32, name: 订单流水号, type: ascii}
    - {len: 1, name: 日志类型, type: uint8}
    - {len: 4, name: 总包数量, type: uint32}
    - {len: 4, name: 包序列号, type: uint32}
    - {len: 1024, name: 数据域, type: hex}

  # cmd16 - 日志上传响应
  16:
    - {len: 32, name: 订单流水号, type: ascii}
    - {len: 1, name: 日志类型, type: uint8}
    - {len: 4, name: 总包数量, type: uint32}
    - {len: 4, name: 包序列号, type: uint32}
    - {len: 1, name: 处理结果, type: uint8}

  # cmd21 - 整形参数设置
  21:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 参数地址, type: uint16}
    - {len: 4, name: 参数值, type: uint32}

  # cmd22 - 整形参数设置应答
  22:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 2, name: 参数地址, type: uint16}
    - {len: 4, name: 参数值, type: uint32}
    - {len: 2, name: 参数设置结果, type: uint16}

  # cmd23 - 参数查询命令
  23:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数, type: uint32}

  # cmd24 - 整形参数表查询应答
  24:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数(n), type: uint32, id: param_count}
    - repeat_by: param_count
      fields:
        - {len: 4, name: 整数参数内容, type: uint32}

  # cmd25 - CCU主动推送参数信息
  25:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数(n), type: uint32, id: param_count}
    - repeat_by: param_count
      fields:
        - {len: 4, name: 整数参数内容, type: uint32}

  # cmd26 - MCU应答CCU推送参数信息
  26:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数, type: uint32}
    - {len: 2, name: 参数设置结果, type: uint16}

  # cmd27 - MCU主动推送参数信息
  27:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数(n), type: uint32, id: param_count}
    - repeat_by: param_count
      fields:
        - {len: 4, name: 整数参数内容, type: uint32}

  # cmd28 - CCU应答MCU推送参数信息
  28:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数, type: uint32}
    - {len: 2, name: 参数设置结果, type: uint16}

  # cmd29 - 字符参数设置
  29:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 参数地址, type: uint16}
    - {len: 4, name: 参数长度, type: uint32, id: param_len}
    - {len: param_len, name: 参数值, type: hex}

  # cmd30 - 参数设置结果
  30:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 2, name: 参数地址, type: uint16}
    - {len: 2, name: 参数设置结果, type: uint16}

  # cmd31 - MCU下发计费模型
  31:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 1, name: 有效时段数量, type: uint8, id: period_count}
    - repeat_by: period_count
      fields:
        - {len: 2, name: 开始时间, type: uint16}
        - {len: 2, name: 结束时间, type: uint16}
        - {len: 4, name: 电费, type: uint32, scale: 0.00001}
        - {len: 4, name: 服务费, type: uint32, scale: 0.00001}
        - {len: 1, name: 尖峰平谷标志, type: uint8}

  # cmd32 - CCU费率模型应答
  32:
    - {len: 4, name: 响应命令序号, type: uint32}

  # cmd33 - 充电结算上报
  33:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 停止充电原因, type: uint16}
    - {len: 4, name: 开始充电电量, type: uint32, scale: 0.001}
    - {len: 4, name: 充电电量, type: uint32, scale: 0.001}
    - {len: 1, name: 开始SOC, type: uint8}
    - {len: 1, name: 结束SOC, type: uint8}
    - {len: 4, name: 开始充电时间, type: uint32}
    - {len: 4, name: 充电时长, type: uint32}
    - {len: 4, name: 电费, type: uint32, scale: 0.0001}
    - {len: 4, name: 服务费, type: uint32, scale: 0.0001}

  # cmd34 - CCU应答结算信息
  34:
    - {len: 4, name: 响应命令序号, type: uint32}

  # cmd35 - CCU请求主动充电
  35:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 1, name: 启动类型, type: uint8}
    - {len: 32, name: 充电卡卡号, type: ascii}
    - {len: 48, name: 充电卡随机数, type: ascii}
    - {len: 8, name: 物理卡号, type: ascii}
    - {len: 18, name: VIN码, type: ascii}
    - {len: 4, name: 充电时长, type: uint32}

  # cmd36 - MCU应答主动请求充电
  36:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 1, name: 启动类型, type: uint8}
    - {len: 1, name: 鉴权结果, type: uint8}
    - {len: 4, name: 余额, type: uint32, scale: 0.01}

  # cmd37 - CCU主动上传VIN充电失败信息
  37:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 停止充电原因, type: uint16}
    - {len: 4, name: 充电电量, type: uint32, scale: 0.001}
    - {len: 4, name: 开始电表电量, type: uint32, scale: 0.001}
    - {len: 4, name: 结束电表电量, type: uint32, scale: 0.001}
    - {len: 2, name: 停止参数1, type: uint16}
    - {len: 2, name: 停止参数2, type: uint16}
    - {len: 2, name: 停止参数3, type: uint16}
    - {len: 2, name: 停止参数4, type: uint16}
    - {len: 2, name: 停止参数5, type: uint16}
    - {len: 2, name: 停止参数6, type: uint16}
    - {len: 2, name: 停止参数7, type: uint16}
    - {len: 2, name: 停止参数8, type: uint16}

  # cmd71 - 控制命令
  71:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 控制命令索引, type: uint16}
    - {len: 4, name: 控制值, type: uint32}

  # cmd72 - 控制命令应答
  72:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 2, name: 控制命令索引, type: uint16}
    - {len: 2, name: 处理结果, type: uint16}

  # cmd100 - 系统状态上报
  100:
    - {len: 1, name: 总枪数, type: uint8}
    - {len: 4, name: 时间, type: uint32}
    - {len: 2, name: 时间ms, type: uint16}
    - {len: 4, name: MCU告警信息, type: binary_str_4bytes}
    - {len: 4, name: 运营后台连接情况, type: uint32}
    - {len: 1, name: 是否需要M2签到, type: uint8}
    - {len: 1, name: MCU掉电紧急停机, type: uint8}
    - {len: 4, name: 组网带宽, type: uint32}

  # cmd111 - 主机状态上报（复杂循环结构）
  111:
    - {len: 1, name: 主机工作状态, type: uint8}
    - len: 1
      name: 热电偶1反馈
      type: bitfield8
      bit_groups:
        - {name: "热电偶1反馈", start_bit: 0, width: 1}
    - len: 1
      name: 热电偶2反馈
      type: bitfield8
      bit_groups:
        - {name: "热电偶2反馈", start_bit: 0, width: 1}
    - len: 1
      name: 热电偶3反馈
      type: bitfield8
      bit_groups:
        - {name: "热电偶3反馈", start_bit: 0, width: 1}
    - len: 1
      name: 热电偶4反馈
      type: bitfield8
      bit_groups:
        - {name: "热电偶4反馈", start_bit: 0, width: 1}
    - {len: 1, name: 预留隔离反馈1, type: bitfield8, bit_groups: [{name: "预留隔离反馈1", start_bit: 0, width: 1}]}
    - {len: 1, name: 预留隔离反馈2, type: bitfield8, bit_groups: [{name: "预留隔离反馈2", start_bit: 0, width: 1}]}
    - {len: 1, name: 倾斜, type: bitfield8, bit_groups: [{name: "倾斜", start_bit: 0, width: 1}]}
    - {len: 1, name: 水浸, type: bitfield8, bit_groups: [{name: "水浸", start_bit: 0, width: 1}]}
    - {len: 1, name: 防雷1, type: bitfield8, bit_groups: [{name: "防雷1", start_bit: 0, width: 1}]}
    - {len: 1, name: 防雷2, type: bitfield8, bit_groups: [{name: "防雷2", start_bit: 0, width: 1}]}
    - {len: 1, name: 断路器1, type: bitfield8, bit_groups: [{name: "断路器1", start_bit: 0, width: 1}]}
    - {len: 1, name: 断路器2, type: bitfield8, bit_groups: [{name: "断路器2", start_bit: 0, width: 1}]}
    - {len: 1, name: 预留非隔离反馈1, type: bitfield8, bit_groups: [{name: "预留非隔离反馈1", start_bit: 0, width: 1}]}
    - {len: 1, name: 预留非隔离反馈2, type: bitfield8, bit_groups: [{name: "预留非隔离反馈2", start_bit: 0, width: 1}]}
    - {len: 1, name: 门禁1, type: bitfield8, bit_groups: [{name: "门禁1", start_bit: 0, width: 1}]}
    - {len: 1, name: 门禁2, type: bitfield8, bit_groups: [{name: "门禁2", start_bit: 0, width: 1}]}
    - {len: 1, name: 门禁3, type: bitfield8, bit_groups: [{name: "门禁3", start_bit: 0, width: 1}]}
    - {len: 1, name: 预留输入干接点1, type: bitfield8, bit_groups: [{name: "预留输入干接点1", start_bit: 0, width: 1}]}
    - {len: 1, name: 预留输入干接点2, type: bitfield8, bit_groups: [{name: "预留输入干接点2", start_bit: 0, width: 1}]}
    - {len: 1, name: 主机掉电保护, type: bitfield8, bit_groups: [{name: "主机掉电保护", start_bit: 0, width: 1}]}
    - {len: 1, name: 硬件版本1, type: bitfield8, bit_groups: [{name: "硬件版本1", start_bit: 0, width: 1}]}
    - {len: 1, name: 硬件版本2, type: bitfield8, bit_groups: [{name: "硬件版本2", start_bit: 0, width: 1}]}
    - {len: 2, name: LED状态, type: bitfield16, bit_groups: [{name: "LED状态", start_bit: 0, width: 1}]}
    - {len: 1, name: 风扇1调速, type: uint8}
    - {len: 1, name: 门禁4, type: bitfield8, bit_groups: [{name: "门禁4", start_bit: 0, width: 1}]}
    - {len: 1, name: 门禁5, type: bitfield8, bit_groups: [{name: "门禁5", start_bit: 0, width: 1}]}
    - {len: 1, name: 门禁6, type: bitfield8, bit_groups: [{name: "门禁6", start_bit: 0, width: 1}]}
    - {len: 1, name: C2掉电保护, type: bitfield8, bit_groups: [{name: "C2掉电保护", start_bit: 0, width: 1}]}
    - {len: 1, name: 断路器3, type: bitfield8, bit_groups: [{name: "断路器3", start_bit: 0, width: 1}]}
    - {len: 1, name: 断路器4, type: bitfield8, bit_groups: [{name: "断路器4", start_bit: 0, width: 1}]}
    - {len: 1, name: 防雷3, type: bitfield8, bit_groups: [{name: "防雷3", start_bit: 0, width: 1}]}
    - {len: 1, name: 防雷4, type: bitfield8, bit_groups: [{name: "防雷4", start_bit: 0, width: 1}]}
    - {len: 1, name: 断上级开关, type: bitfield8, bit_groups: [{name: "断上级开关", start_bit: 0, width: 1}]}
    - {len: 1, name: 急停状态, type: bitfield8, bit_groups: [{name: "急停状态", start_bit: 0, width: 1}]}
    - {len: 6, name: 预留状态, type: hex}
    - {len: 1, name: 预留状态2, type: uint8}
    - {len: 1, name: 风扇2速度, type: uint8}
    - {len: 4, name: 主机状态3, type: binary_str_4bytes}
    - {len: 4, name: 主机状态4, type: binary_str_4bytes}
    - {len: 2, name: A相电压, type: uint16, scale: 0.1}
    - {len: 2, name: B相电压, type: uint16, scale: 0.1}
    - {len: 2, name: C相电压, type: uint16, scale: 0.1}
    - {len: 2, name: A相电流, type: uint16, scale: 0.1}
    - {len: 2, name: B相电流, type: uint16, scale: 0.1}
    - {len: 2, name: C相电流, type: uint16, scale: 0.1}
    - {len: 1, name: 电网频率, type: uint8, scale: 0.1}
    - {len: 4, name: 交流电表值, type: uint32, scale: 0.001}
    - {len: 1, name: 模块环境温度最高值, type: uint8}
    - {len: 1, name: 模块环境温度最低值, type: uint8}
    - {len: 4, name: 主机当前总需求功率, type: uint32, scale: 0.1}
    - {len: 4, name: 主机当前输出功率, type: uint32, scale: 0.1}
    - {len: 1, name: 主机进风口温度A, type: uint8}
    - {len: 1, name: 主机进风口温度B, type: uint8}
    - {len: 1, name: 主机出风口温度A, type: uint8}
    - {len: 1, name: 主机出风口温度B, type: uint8}
    - repeat_const: 4
      fields:
        - {len: 4, name: 主机系统告警, type: binary_str_4bytes}
    - repeat_const: 28
      fields:
        - {len: 1, name: 枪状态, type: binary_str_1byte}
        - {len: 2, name: 枪输出电压, type: uint16, scale: 0.1}
        - {len: 2, name: 枪输出电流, type: uint16, scale: 0.1}
        - {len: 1, name: 枪当前实际占用模块个数, type: uint8}
        - {len: 1, name: 枪满足负载率最少模块个数, type: uint8}
        - {len: 1, name: 枪满足最大功率最少模块个数, type: uint8}
    - repeat_const: 2
      fields:
        - {len: 1, name: 液冷出口压力, type: uint8, scale: 0.1}

  # cmd112 - 模块状态上报
  112:
    - {len: 1, name: 模块数量, type: uint8, id: module_count}
    - repeat_const: 40
      fields:
        - {len: 2, name: 模块电压, type: uint16, scale: 0.1}
        - {len: 2, name: 模块电流, type: uint16, scale: 0.1}
        - {len: 1, name: 模块组号, type: uint8}
        - {len: 1, name: 父节点模块, type: uint8}
        - {len: 1, name: 子节点1模块, type: uint8}
        - {len: 1, name: 子节点2模块, type: uint8}
        - {len: 1, name: 子节点3模块, type: uint8}
        - {len: 1, name: 子节点4模块, type: uint8}
        - {len: 1, name: 子节点5模块, type: uint8}
        - {len: 1, name: 模块故障码, type: uint8}
        - {len: 2, name: 模块状态码, type: binary_str_2bytes}
    - repeat_const: 40
      fields:
        - {len: 1, name: 模块删除原因, type: bitfield8, bit_groups: [{name: 主机共享模块接触器粘连, start_bit: 0, width: 1}, {name: 主机判定中间接触器粘连, start_bit: 1, width: 1}, {name: 终端判定中间接触器DC+粘连, start_bit: 2, width: 1}, {name: 终端判定中间接触器DC-粘连, start_bit: 3, width: 1}, {name: 终端通讯故障, start_bit: 4, width: 1}, {name: 终端门禁故障, start_bit: 5, width: 1}, {name: 终端急停故障, start_bit: 6, width: 1}, {name: 预留, start_bit: 7, width: 1}], notes: "0正常 1故障，Bit0显示优先级最高"}

  # cmd113 - M2广播C3板接触器共享模块状态
  113:
    - {len: 1, name: 共享模块上层接触器个数, type: uint8}
    - {len: 1, name: 共享模块下层接触器个数, type: uint8}
    - repeat_const: 72
      fields:
        - {len: 2, name: 接触器状态, type: bitfield16, bit_groups: [{name: 存在, start_bit: 0, width: 1}, {name: 控制闭合, start_bit: 1, width: 1}, {name: 正极接触器反馈, start_bit: 2, width: 1}, {name: 负极接触器反馈, start_bit: 3, width: 1}, {name: 禁用, start_bit: 4, width: 1}, {name: 故障次数, start_bit: 5, width: 4}, {name: 预留, start_bit: 9, width: 7}], notes: "每组对应一个正负极接触器，1-36为A面，37-72为B面"}

  # cmd114 - 模块版本信息
  114:
    - repeat_const: 40
      fields:
        - {len: 2, name: 模块AC版本, type: uint16}
        - {len: 2, name: 模块DC版本, type: uint16}

  # cmd115 - 接触器状态
  115:
    - {len: 1, name: 共享模块上层接触器个数, type: uint8}
    - {len: 1, name: 共享模块下层接触器个数, type: uint8}
    - {len: 4, name: A面控制信号up, type: bitfield32, notes: "Bit0~Bit31 依次表示A面上层接触器的控制状态，0-断开，1-闭合"}
    - {len: 4, name: A面控制信号down, type: bitfield32, notes: "Bit0~Bit31 依次表示A面下层接触器的控制状态，0-断开，1-闭合"}
    - {len: 4, name: A面反馈信号up+, type: bitfield32, notes: "上层正极反馈，0-断开，1-闭合"}
    - {len: 4, name: A面反馈信号down+, type: bitfield32, notes: "下层正极反馈，0-断开，1-闭合"}
    - {len: 4, name: A面反馈信号up-, type: bitfield32, notes: "上层负极反馈，0-断开，1-闭合"}
    - {len: 4, name: A面反馈信号down-, type: bitfield32, notes: "下层负极反馈，0-断开，1-闭合"}
    - {len: 4, name: B面控制信号up, type: bitfield32, notes: "Bit0~Bit31 依次表示B面上层接触器的控制状态，0-断开，1-闭合"}
    - {len: 4, name: B面控制信号dwon, type: bitfield32, notes: "Bit0~Bit31 依次表示B面下层接触器的控制状态，0-断开，1-闭合"}
    - {len: 4, name: B面反馈信号up+, type: bitfield32, notes: "B面上层正极反馈"}
    - {len: 4, name: B面反馈信号down+, type: bitfield32, notes: "B面下层正极反馈"}
    - {len: 4, name: B面反馈信号up-, type: bitfield32, notes: "B面上层负极反馈"}
    - {len: 4, name: B面反馈信号down-, type: bitfield32, notes: "B面下层负极反馈"}

  # cmd120 - 液冷M2广播U2板接触器状态
  120:
    - {len: 4, name: "1U2", type: bitfield32, bit_groups: [{name: 接触器反馈状态, start_bit: 0, width: 21}, {name: 通信超时, start_bit: 21, width: 1}, {name: 地址重复, start_bit: 22, width: 1}, {name: 预留, start_bit: 23, width: 9}], notes: "Bit0~Bit20反馈断开/闭合，Bit21通信超时，Bit22地址重复"}
    - {len: 4, name: "2U2", type: bitfield32, bit_groups: [{name: 接触器反馈状态, start_bit: 0, width: 21}, {name: 通信超时, start_bit: 21, width: 1}, {name: 地址重复, start_bit: 22, width: 1}, {name: 预留, start_bit: 23, width: 9}], notes: "同1U2"}
    - {len: 4, name: "3U2", type: bitfield32, bit_groups: [{name: 接触器反馈状态, start_bit: 0, width: 21}, {name: 通信超时, start_bit: 21, width: 1}, {name: 地址重复, start_bit: 22, width: 1}, {name: 预留, start_bit: 23, width: 9}], notes: "同1U2"}
    - {len: 4, name: "4U2", type: bitfield32, bit_groups: [{name: 接触器反馈状态, start_bit: 0, width: 21}, {name: 通信超时, start_bit: 21, width: 1}, {name: 地址重复, start_bit: 22, width: 1}, {name: 预留, start_bit: 23, width: 9}], notes: "同1U2"}
    - {len: 1, name: "A+ 接触器数量", type: uint8, notes: "1-20"}
    - {len: 1, name: "A- 接触器数量", type: uint8, notes: "1-20"}
    - {len: 1, name: "B+ 接触器数量", type: uint8, notes: "1-20"}
    - {len: 1, name: "B- 接触器数量", type: uint8, notes: "1-20"}
    - repeat_const: 20
      fields:
        - {len: 2, name: A正接触器状态, type: bitfield16, bit_groups: [{name: 存在, start_bit: 0, width: 1}, {name: 控制闭合, start_bit: 1, width: 1}, {name: 拒动, start_bit: 2, width: 1}, {name: 粘连, start_bit: 3, width: 1}, {name: 禁用, start_bit: 4, width: 1}, {name: 故障次数, start_bit: 5, width: 4}, {name: 预留, start_bit: 9, width: 7}], notes: "对应1~20号A正接触器"}
    - repeat_const: 20
      fields:
        - {len: 2, name: A负接触器状态, type: bitfield16, bit_groups: [{name: 存在, start_bit: 0, width: 1}, {name: 控制闭合, start_bit: 1, width: 1}, {name: 拒动, start_bit: 2, width: 1}, {name: 粘连, start_bit: 3, width: 1}, {name: 禁用, start_bit: 4, width: 1}, {name: 故障次数, start_bit: 5, width: 4}, {name: 预留, start_bit: 9, width: 7}], notes: "对应1~20号A负接触器"}
    - repeat_const: 20
      fields:
        - {len: 2, name: B正接触器状态, type: bitfield16, bit_groups: [{name: 存在, start_bit: 0, width: 1}, {name: 控制闭合, start_bit: 1, width: 1}, {name: 拒动, start_bit: 2, width: 1}, {name: 粘连, start_bit: 3, width: 1}, {name: 禁用, start_bit: 4, width: 1}, {name: 故障次数, start_bit: 5, width: 4}, {name: 预留, start_bit: 9, width: 7}], notes: "对应1~20号B正接触器"}
    - repeat_const: 20
      fields:
        - {len: 2, name: B负接触器状态, type: bitfield16, bit_groups: [{name: 存在, start_bit: 0, width: 1}, {name: 控制闭合, start_bit: 1, width: 1}, {name: 拒动, start_bit: 2, width: 1}, {name: 粘连, start_bit: 3, width: 1}, {name: 禁用, start_bit: 4, width: 1}, {name: 故障次数, start_bit: 5, width: 4}, {name: 预留, start_bit: 9, width: 7}], notes: "对应1~20号B负接触器"}

  # cmd121 - M2广播液冷水泵及系统风扇信息
  121:
    - {len: 1, name: 液冷泵1状态, type: uint8, enum: pump_status}
    - {len: 1, name: 液冷泵2状态, type: uint8, enum: pump_status}
    - {len: 1, name: 液冷泵1 PWM, type: uint8}
    - {len: 1, name: 液冷泵2 PWM, type: uint8}
    - {len: 1, name: 液冷泵1压力, type: uint8}
    - {len: 1, name: 液冷泵2压力, type: uint8}
    - {len: 1, name: 换热器1出水口温度, type: uint8}
    - {len: 1, name: 进水口1温度, type: uint8, notes: "偏移-50"}
    - {len: 1, name: 换热器2出水口温度, type: uint8}
    - {len: 1, name: 进水口2温度, type: uint8, notes: "偏移-50"}
    - {len: 1, name: 系统风扇1转速, type: uint8}
    - {len: 1, name: 系统风扇2转速, type: uint8}
    - {len: 1, name: 系统风扇3转速, type: uint8}
    - {len: 1, name: 系统风扇4转速, type: uint8}
    - {len: 1, name: 系统风扇5转速, type: uint8}
    - {len: 4, name: M2软件版本号, type: uint32}
    - {len: 4, name: U1软件版本号, type: uint32}
    - {len: 4, name: U2-1号板软件版本号, type: uint32}
    - {len: 4, name: U2-2号板软件版本号, type: uint32}
    - {len: 4, name: U2-3号板软件版本号, type: uint32}
    - {len: 4, name: U2-4号板软件版本号, type: uint32}

  # cmd201 - 终端充电状态上报
  201:
    - {len: 1, name: 工作状态, type: uint8, enum: work_status}
    - {len: 32, name: 枪故障状态, type: hex}
    - {len: 1, name: 并充主枪的枪号, type: uint8}
    - {len: 4, name: 当前电表读数, type: uint32, scale: 0.001}
    - {len: 4, name: 本次充电累计充电电量, type: uint32, scale: 0.001}
    - {len: 2, name: 当前充电功率, type: uint16, scale: 0.1}
    - {len: 2, name: 终端充电状态(发给主机), type: bitfield16, bit_groups: [{name: 插枪信号, start_bit: 0, width: 1}, {name: 系统启动状态, start_bit: 1, width: 1}, {name: 模块启动状态, start_bit: 2, width: 1}, {name: 模块挡位, start_bit: 3, width: 1}, {name: 预留1, start_bit: 4, width: 1}, {name: 双枪单枪, start_bit: 5, width: 1}, {name: 风扇状态, start_bit: 6, width: 1}, {name: 并充状态, start_bit: 7, width: 1}, {name: 预留2, start_bit: 8, width: 1}, {name: 超充机型, start_bit: 9, width: 1}, {name: 绝缘状态, start_bit: 10, width: 1}, {name: 中间接触器状态, start_bit: 11, width: 1}, {name: 预充信号, start_bit: 12, width: 1}]}
    - {len: 2, name: 枪需要输出的电压(发给主机), type: uint16, scale: 0.1}
    - {len: 2, name: 枪需要输出的电流(发给主机), type: uint16, scale: 0.1}
    - {len: 1, name: 充电模式, type: uint8, enum: charge_mode}
    - {len: 2, name: BMS需求电压, type: uint16, scale: 0.1}
    - {len: 2, name: BMS需求电流, type: uint16, scale: 0.1}
    - {len: 2, name: 枪采样的模块电压, type: uint16, scale: 0.1}
    - {len: 2, name: 枪采样电池电压, type: uint16, scale: 0.1}
    - {len: 2, name: 单枪实际输出电流, type: uint16, scale: 0.1}
    - {len: 2, name: 总直流充电电流(并充), type: uint16, scale: 0.1}
    - {len: 4, name: 启动充电订单识别码, type: uint32}
    - {len: 2, name: 液冷2枪模块电压采样, type: uint16, scale: 0.1}
    - {len: 1, name: 并充组网状态, type: uint8}
    - {len: 1, name: 组网枪数量, type: uint8}
    - {len: 1, name: 并充组网枪1地址, type: uint8}
    - {len: 1, name: 并充组网枪2地址, type: uint8}
    - {len: 1, name: 并充组网枪3地址, type: uint8}
    - {len: 1, name: 并充组网枪4地址, type: uint8}
    - {len: 4, name: 1路电压, type: int32, scale: 0.0001, notes: "最高位符号位"}
    - {len: 4, name: 1路电流, type: int32, scale: 0.0001, notes: "最高位符号位"}
    - {len: 4, name: 1路功率, type: int32, scale: 0.0001, notes: "最高位符号位"}
    - {len: 4, name: 1路总电量, type: int32, scale: 0.001, notes: "最高位符号位"}


  # cmd202 - CCU-V8当前充电枪的液冷实时状态
  202:
    - {len: 1, name: 液冷系统风扇速率, type: uint8}
    - {len: 1, name: 液冷泵速, type: uint8}
    - {len: 1, name: 液冷枪进水温度, type: uint8, scale: 1, notes: "偏移-50"}
    - {len: 1, name: 液冷枪出水温度, type: uint8, scale: 1, notes: "偏移-50"}
    - {len: 1, name: 液冷量化水压, type: uint8}
    - {len: 2, name: 液冷水压压力值, type: uint16, scale: 0.01}
    - {len: 1, name: D1软件版本号, type: uint8}
    - {len: 1, name: D2软件版本号, type: uint8}

  # cmd203 - CCU-V8状态需求短报文
  203:
    - {len: 2, name: 终端充电状态(发给主机), type: binary_str_2bytes}
    - {len: 2, name: 枪需要输出的电流(发给主机), type: uint16, scale: 0.1}

  # cmd221 - CCU广播当前所有模块的状态信息数据
  221:
    - {len: 1, name: 最大模块数量, type: uint8, id: max_module_count, notes: "一体机支持的最大模块号"}
    - {len: 1, name: 实际模块数量, type: uint8, notes: "实际有效模块数量"}
    - repeat_by: max_module_count
      fields:
        - {len: 2, name: 模块电压, type: uint16, scale: 0.1}
        - {len: 2, name: 模块电流, type: uint16, scale: 0.1}
        - {len: 1, name: 模块当前设置分组号, type: uint8}
        - {len: 1, name: 模块故障码, type: uint8, notes: "参见附录模块告警定义"}
        - {len: 2, name: 模块状态码, type: bitfield16, bit_groups: [{name: 离线在线, start_bit: 0, width: 1}, {name: 正常故障, start_bit: 1, width: 1}, {name: 未就绪就绪, start_bit: 2, width: 1}, {name: 低压档高压档, start_bit: 3, width: 1}, {name: 关机开机, start_bit: 4, width: 1}, {name: EPO, start_bit: 5, width: 1}, {name: 下电上电, start_bit: 6, width: 1}, {name: 空槽状态, start_bit: 7, width: 1}, {name: 正常损坏, start_bit: 8, width: 1}, {name: 正常禁用, start_bit: 9, width: 1}]}
    - {len: 2, name: A相电压, type: uint16, scale: 0.1}
    - {len: 2, name: B相电压, type: uint16, scale: 0.1}
    - {len: 2, name: C相电压, type: uint16, scale: 0.1}
    - {len: 2, name: A相电流, type: uint16, scale: 0.1}
    - {len: 2, name: B相电流, type: uint16, scale: 0.1}
    - {len: 2, name: C相电流, type: uint16, scale: 0.1}
    - {len: 1, name: 电网频率, type: uint8}
    - {len: 4, name: 交流电表值, type: uint32, scale: 0.001}

  # cmd222 - CCU广播模块版本信息
  222:
    - {len: 1, name: 最大模块数量, type: uint8}
    - {len: 1, name: 实际模块数量, type: uint8, id: module_count}
    - repeat_by: module_count
      fields:
        - {len: 2, name: 模块AC版本, type: uint16}
        - {len: 2, name: 模块DC版本, type: uint16}

  # cmd301 - CCU-V8主机允许进入并枪的辅枪信息
  301:
    - {len: 1, name: 拨码地址, type: uint8}
    - {len: 1, name: 总枪数, type: uint8}
    - {len: 1, name: 本枪枪号, type: uint8}
    - {len: 1, name: 同一个CAN总线终端数量, type: uint8}
    - {len: 8, name: 允许进入辅枪的地址, type: hex}
    - {len: 8, name: 主机已收到副枪确认地址, type: hex}

  # cmd302 - CCU-MCU并枪的副枪信息
  302:
    - {len: 1, name: 拨码地址, type: uint8}
    - {len: 1, name: 总枪数, type: uint8}
    - {len: 1, name: 本枪枪号, type: uint8}
    - {len: 1, name: 并充状态, type: uint8}
    - {len: 1, name: 并充主机拨码地址, type: uint8}
    - {len: 1, name: 并充主机拨码枪号, type: uint8}
    - {len: 4, name: 初始电表度, type: uint32, scale: 0.001}
    - {len: 4, name: 当前电表度, type: uint32, scale: 0.001}
    - {len: 2, name: 当前充电电流, type: uint16, scale: 0.1}

  # cmd303 - CCU-V8并充订单信息
  303:
    - {len: 1, name: 主枪地址, type: uint8}
    - {len: 1, name: 并充状态, type: uint8}
    - {len: 1, name: 并充副枪数量, type: uint8}
    - repeat_const: 8
      fields:
        - {len: 1, name: 副枪地址, type: uint8}
        - {len: 4, name: 副枪起始电表值, type: uint32, scale: 0.001}
        - {len: 4, name: 副枪当前电表值, type: uint32, scale: 0.001}

  # cmd51 - M2注册帧
  51:
    - {len: 1, name: 硬件类型, type: uint8, enum: device_type}
    - {len: 1, name: 拨码地址号, type: uint8}
    - {len: 2, name: 项目号, type: uint16}
    - {len: 2, name: M2软件版本号, type: uint16}
    - {len: 32, name: M2软件编译时间, type: ascii}
    - {len: 2, name: C2软件版本号, type: uint16}
    - {len: 2, name: C3软件版本号-1号, type: uint16}
    - {len: 2, name: C3软件版本号-2号, type: uint16}
    - {len: 2, name: C3软件版本号-3号, type: uint16}
    - {len: 2, name: C3软件版本号-4号, type: uint16}
    - {len: 2, name: C3软件版本号-5号, type: uint16}
    - {len: 2, name: C3软件版本号-6号, type: uint16}
    - {len: 2, name: C3软件版本号-7号, type: uint16}
    - {len: 2, name: C3软件版本号-8号, type: uint16}
    - {len: 2, name: 主机类型, type: uint16}
    - {len: 4, name: 时间, type: uint32}

  # cmd52 - 注册回复帧
  52:
    - {len: 1, name: 登录结果, type: uint8, enum: login_result}
    - {len: 1, name: 登录失败原因, type: uint8}
    - {len: 2, name: MCU软件项目号, type: uint16}
    - {len: 2, name: MCU软件版本号, type: uint16}

  # cmd53 - 参数请求同步
  53:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数, type: uint32}

  # cmd54 - 参数请求同步应答
  54:
    - {len: 4, name: 参数开始地址, type: uint32}
    - {len: 4, name: 参数个数(n), type: uint32, id: param_count}
    - repeat_by: param_count
      fields:
        - {len: 4, name: 整数参数内容, type: uint32}

  # cmd55 - MCU-M2整形参数设置
  55:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 参数地址, type: uint16}
    - {len: 4, name: 参数值, type: uint32}

  # cmd56 - M2-MCU整形参数设置应答
  56:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 2, name: 参数地址, type: uint16}
    - {len: 4, name: 参数值, type: uint32}
    - {len: 2, name: 参数设置结果, type: uint16}

  # cmd57 - MCU请求获取模块详细状态
  57:
    - {len: 4, name: 命令序号, type: uint32}

  # cmd58 - M2应答模块详细状态信息
  58:
    - {len: 4, name: 响应命令序号, type: uint32}
    - {len: 1, name: 有效模块数量, type: uint8, id: module_count}
    - repeat_by: module_count
      fields:
        - {len: 1, name: PFC_MOS温度1, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: PFC_MOS温度2, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: PFC_MOS温度3, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: 防反二极管温度, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: 整流二极管温度, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: 谐振电感温度, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: 变压器温度, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: LLC_MOS温度, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: 环境温度或液冷进水口温度, type: uint8, scale: 1, notes: "偏移-50"}
        - {len: 1, name: 风扇转速, type: uint8}

  # cmd401 - 日志文件请求指令下发
  401:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 2, name: 设备类型, type: uint16}
    - {len: 2, name: 日志类型, type: binary_str_2bytes}
    - {len: 128, name: 日志上传文件路径, type: ascii}

  # cmd402 - 日志文件请求指令回复
  402:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 2, name: 设备类型, type: uint16}
    - {len: 1, name: 结果, type: uint8}
    - {len: 2, name: 拒绝原因, type: uint16}

  # cmd403 - 日志文件上传状态
  403:
    - {len: 2, name: 设备类型, type: uint16}
    - {len: 2, name: 上传状态, type: uint16}
    - {len: 1, name: 上传进度, type: uint8}

  # cmd411 - 在线升级指令下发
  411:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 2, name: 设备类型, type: uint16, enum: upgrade_device_type}
    - {len: 8, name: 设备范围, type: bitfield64, notes: "按位表示64个设备是否选中"}
    - {len: 2, name: 升级执行动作指示, type: bitfield16, bit_groups: [{name: 控制器控制复位升级逻辑, start_bit: 0, width: 1}, {name: MCU控制复位重启逻辑, start_bit: 1, width: 1}]}
    - {len: 2, name: 升级软件版本, type: uint16}
    - {len: 64, name: 升级文件路径, type: ascii}
    - {len: 4, name: 升级文件数据长度, type: uint32}

  # cmd412 - 在线升级指令应答
  412:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 1, name: 设备类型, type: uint8}
    - {len: 1, name: 结果, type: uint8}
    - {len: 2, name: 拒绝原因, type: uint16}

  # cmd413 - 在线升级状态上报
  413:
    - {len: 1, name: 设备类型, type: uint8}
    - {len: 2, name: 升级状态, type: uint16}
    - {len: 1, name: 下载进度, type: uint8}

  # cmd415 - 在线升级复位指令下发
  415:
    - {len: 4, name: 命令序号, type: uint32}

  # cmd416 - 在线升级复位指令回复
  416:
    - {len: 4, name: 命令序号, type: uint32}
    - {len: 1, name: 结果, type: uint8}
    - {len: 2, name: 拒绝原因, type: uint16}

# cmd601 - 终端启动或者退出工装流程
  601:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 1, name: 工装模式, type: uint8, enum: workshop_mode_cmd601}
    - {len: 2, name: CCU全自动工装使能, type: bitfield16, bit_groups: [{name: 干接点测试使能, start_bit: 0, width: 1}, {name: 辅助电源测试使能, start_bit: 1, width: 1}, {name: 电压采样测试使能, start_bit: 2, width: 1}, {name: 绝缘测试使能, start_bit: 3, width: 1}, {name: 电表计量测试使能, start_bit: 4, width: 1}, {name: 33008加测使能, start_bit: 5, width: 1}]}

# cmd602 - 设备响应工装控制指令
  602:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 1, name: 结果, type: uint8, enum: workshop_result}
    - {len: 2, name: 拒绝原因, type: uint16, enum: workshop_refuse_reason}

# cmd603 - 终端半自动化工装控制指令
  603:
    - {len: 1, name: YL风扇调速调节, type: uint8}
    - {len: 1, name: YL泵转速调节, type: uint8}
    - {len: 2, name: A枪干接点驱动测试, type: bitfield16, bit_groups: [{name: 灯带R红, start_bit: 0, width: 1}, {name: 灯带G绿, start_bit: 1, width: 1}, {name: 灯带B蓝, start_bit: 2, width: 1}, {name: 枪CC2电阻开关, start_bit: 3, width: 1}, {name: 辅助电源12V24V切换测试, start_bit: 4, width: 1}, {name: 枪锁, start_bit: 5, width: 1}, {name: 枪CC1电阻投切, start_bit: 6, width: 1}, {name: 辅助电源开关, start_bit: 7, width: 1}, {name: DC正接触器开关, start_bit: 8, width: 1}, {name: DC负接触器开关, start_bit: 9, width: 1}]}
    - {len: 2, name: B枪干接点驱动测试, type: bitfield16, bit_groups: [{name: 灯带R红, start_bit: 0, width: 1}, {name: 灯带G绿, start_bit: 1, width: 1}, {name: 灯带B蓝, start_bit: 2, width: 1}, {name: 枪CC2电阻开关, start_bit: 3, width: 1}, {name: 辅助电源12V24V切换测试, start_bit: 4, width: 1}, {name: 枪锁, start_bit: 5, width: 1}, {name: 枪CC1电阻投切, start_bit: 6, width: 1}, {name: 辅助电源开关, start_bit: 7, width: 1}, {name: DC接触器开关, start_bit: 8, width: 1}, {name: ABMS电阻投切控制, start_bit: 9, width: 1}]}
    - {len: 2, name: 终端干接点驱动测试, type: bitfield16, bit_groups: [{name: 终端风扇, start_bit: 0, width: 1}, {name: 中间接触器正开关, start_bit: 1, width: 1}, {name: 中间接触器负开关, start_bit: 2, width: 1}]}

  # cmd605 - 终端全自动工装模式下的实时状态数据
  605:
    - {len: 1, name: 终端类型, type: uint8, enum: terminal_type_auto}
    - {len: 2, name: 硬件版本, type: uint16}
    - {len: 2, name: 软件版本号, type: uint16}
    - {len: 1, name: 执行阶段, type: uint8}
    - {len: 4, name: 全自动工装结果, type: uint32}
    - {len: 2, name: 700V枪电压采数据, type: uint16, scale: 0.1}
    - {len: 2, name: 700V模块电压采数据, type: uint16, scale: 0.1}
    - {len: 2, name: 700V BMS工装电压数据, type: uint16, scale: 0.1}
    - {len: 2, name: 辅源测量电压, type: uint16, scale: 0.1}
    - {len: 4, name: 绝缘正阻值, type: uint32}
    - {len: 4, name: 绝缘负阻值, type: uint32}
    - {len: 2, name: 正桥臂电压X0, type: uint16, scale: 0.1}
    - {len: 2, name: 正桥臂电压X1, type: uint16, scale: 0.1}
    - {len: 2, name: 负桥臂电压Y0, type: uint16, scale: 0.1}
    - {len: 2, name: 负桥臂电压Y1, type: uint16, scale: 0.1}
    - {len: 4, name: 充电前桩电表电量, type: uint32, scale: 0.001, notes: "0.001kWh/bit"}
    - {len: 4, name: 充电后桩电表电量, type: uint32, scale: 0.001, notes: "0.001kWh/bit"}
    - {len: 4, name: 桩充电电量, type: uint32, scale: 0.001, notes: "0.001kWh/bit"}
    - {len: 4, name: 充电前工装电表电量, type: uint32, scale: 0.001, notes: "0.001kWh/bit"}
    - {len: 4, name: 充电后工装电表电量, type: uint32, scale: 0.001, notes: "0.001kWh/bit"}
    - {len: 4, name: 工装测量充电电量, type: uint32, scale: 0.001, notes: "0.001kWh/bit"}
    - {len: 1, name: 枪锁测试结果, type: uint8}
    - {len: 1, name: 直流接触器+结果, type: uint8}
    - {len: 1, name: 直流接触器-结果, type: uint8}
    - {len: 1, name: 中间接触器+结果, type: uint8}
    - {len: 1, name: 中间接触器-结果, type: uint8}
    - {len: 1, name: 倾斜结果, type: uint8}

  # cmd606 - 终端全自动工装模式下的实时状态数据回复
  606:
    - {len: 4, name: 预留, type: hex}

  # cmd607 - 主机半自动化工装控制指令
  607:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 1, name: 工装模式, type: uint8, enum: workshop_mode_cmd607}
    - {len: 1, name: 主机风扇PWM1调节, type: uint8}
    - {len: 1, name: 主机风扇PWM2调节, type: uint8}
    - {len: 4, name: A面主机地址N模块点亮和关闭, type: bitfield32}
    - {len: 4, name: B面主机地址N模块点亮和关闭, type: bitfield32}
    - {len: 4, name: A面主机接触器下层控制, type: bitfield32}
    - {len: 4, name: A面主机接触器上层控制, type: bitfield32}
    - {len: 4, name: B面主机接触器下层控制, type: bitfield32}
    - {len: 4, name: B面主机接触器上层控制, type: bitfield32}
    - {len: 2, name: M2半自动干接点驱动测试, type: bitfield16, bit_groups: [{name: R红灯, start_bit: 0, width: 1}, {name: G绿灯, start_bit: 1, width: 1}, {name: B蓝灯, start_bit: 2, width: 1}, {name: 断上级开关, start_bit: 3, width: 1}]}
    - {len: 1, name: 主机风扇PWM3调节, type: uint8}
    - {len: 1, name: 主机水泵PWM1调节, type: uint8}
    - {len: 1, name: 主机水泵PWM2调节, type: uint8}

  # cmd608 - 主机半自动化工装控制指令应答
  608:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 1, name: 结果, type: uint8, enum: workshop_result}
    - {len: 2, name: 拒绝原因, type: uint16, enum: workshop_refuse_reason}

  # cmd609 - 主机全自动化工装控制指令
  609:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 1, name: 工装模式, type: uint8, enum: workshop_mode_cmd609}
    - {len: 2, name: M2全自动干接点驱动测试, type: bitfield16}

  # cmd610 - 主机响应全自动工装控制指令
  610:
    - {len: 4, name: 事务号, type: uint32}
    - {len: 1, name: 结果, type: uint8, enum: workshop_result}
    - {len: 2, name: 拒绝原因, type: uint16, enum: workshop_refuse_reason}

  # cmd611 - 主机全自动工装模式下的实时回复数据
  611:
    - {len: 2, name: M2全自动工装执行阶段, type: uint16}
    - {len: 4, name: M2全自动工装结果, type: uint32}
    - {len: 1, name: 终端数量, type: uint8}
    - {len: 1, name: 模块数量, type: uint8}
    - {len: 2, name: 前置条件终端通讯状态, type: bitfield16}
    - {len: 2, name: 前置条件驱动板通讯状态, type: bitfield16}
    - {len: 4, name: 前置条件A模块通讯状态, type: bitfield32}
    - {len: 4, name: 前置条件B模块通讯状态, type: bitfield32}
    - {len: 8, name: A接触器驱动反馈测试正, type: bitfield64}
    - {len: 8, name: A接触器驱动反馈测试负, type: bitfield64}
    - {len: 8, name: B接触器驱动反馈测试正, type: bitfield64}
    - {len: 8, name: B接触器驱动反馈测试负, type: bitfield64}
    - {len: 8, name: 模块地址测试结果, type: bitfield64}
    - {len: 4, name: 主机终端线缆测试结果, type: bitfield32}
    - {len: 8, name: A面接触器驱动位置测试结果, type: bitfield64}
    - {len: 8, name: B面接触器驱动位置测试结果, type: bitfield64}
    - {len: 2, name: 干节点测试结果, type: bitfield16}
    - {len: 8, name: 模块输出线缆测试结果, type: bitfield64}
    - {len: 4, name: 已发送的数据帧, type: uint32}
    - {len: 4, name: CAN1已接收的数据帧, type: uint32}
    - {len: 4, name: CAN2已接收的数据帧, type: uint32}
    - {len: 4, name: CAN3已接收的数据帧, type: uint32}
    - {len: 4, name: CAN4已接收的数据帧, type: uint32}

  # cmd612 - 全自动工装模式下的实时状态数据回复
  612:
    - {len: 4, name: 预留, type: hex}

  # cmd613 - 终端全自动工装模式下的33008实时状态数据
  613:
    - {len: 4, name: 33008测试结果, type: uint32}
    - {len: 1, name: 车辆插头锁止试验绝缘状态下枪锁驱动, type: uint8}
    - {len: 1, name: 绝缘状态下枪锁反馈, type: uint8}
    - {len: 2, name: 预充电试验电池BCP电压, type: uint16, scale: 0.1}
    - {len: 2, name: 直流接触器闭合前枪口电压, type: uint16, scale: 0.1}
    - {len: 2, name: 直流接触器闭合前模块电压, type: uint16, scale: 0.1}
    - {len: 2, name: K1K2闭合时刻两端电压压差, type: uint16, scale: 0.1}
    - {len: 2, name: 输入电流过冲试验最大电流, type: uint16, scale: 0.1}
    - {len: 2, name: 输出设定误差试验系统电流, type: uint16, scale: 0.1}
    - {len: 2, name: 输出设定误差试验系统电压, type: uint16, scale: 0.1}
    - {len: 2, name: 输出设定误差试验电表电流, type: uint16, scale: 0.1}
    - {len: 2, name: 输出设定误差试验电表电压, type: uint16, scale: 0.1}
    - {len: 2, name: 充电控制状态试验插枪前枪锁CC1电压, type: uint16, scale: 0.1}
    - {len: 2, name: 充电控制状态试验插枪前未按下CC1电压, type: uint16, scale: 0.1}
    - {len: 2, name: 充电控制状态试验插枪后CC1电压, type: uint16, scale: 0.1}
    - {len: 1, name: 动力电源输入失电试验枪锁反馈, type: uint8}
    - {len: 2, name: 动力电源输入失电试验DC电压, type: uint16, scale: 0.1}