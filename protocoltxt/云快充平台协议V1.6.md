





    充电桩与云快充服务平台交互协议

















    江苏云快充新能源科技有限公司



















```text
+---------------+---------------+---------------+---------------------------------------------+
| 版本          | 版本日期      | 修改人        | 版本说明                                    |
+---------------+---------------+---------------+---------------------------------------------+
| V1.0          | 2018-02-27    | 岳龙          | 1. 创建初始版本                             |
+---------------+---------------+---------------+---------------------------------------------+
| V1.1          | 2019-08-20    | 张博          | 1. 刷卡增加失败原因提示                     |
+---------------+---------------+---------------+---------------------------------------------+
| V1.2          | 2020-02-25    | 岳龙          | 优化报文说明的示例                          |
|               |               |               | 增加12.3协议需知                            |
|               |               |               | 补充离线卡功能部分报文                      |
|               |               |               | 更新交易记录帧为0x39                        |
+---------------+---------------+---------------+---------------------------------------------+
| V1.3          | 2020-05-18    | 岳龙          | 1. 费率拆分服务费、电费                     |
+---------------+---------------+---------------+---------------------------------------------+
| V1.4          | 2020-09-14    | 岳龙          | 1. 修改实时数据(0x13)、交易记录（0x3F）中电 |
|               |               |               | 量相关字段，精度值改为4位小数               |
+---------------+---------------+---------------+---------------------------------------------+
| V1.5          | 2020-10-15    | 李杨敏        | 1. 修改交易记录为（0x3B），并修改电表起止值 |
|               |               |               | 字节长度                                    |
+---------------+---------------+---------------+---------------------------------------------+
| V1.6          | 2020-10-29    | 岳龙          | 增加双枪并充                                |
+---------------+---------------+---------------+---------------------------------------------+
```



    目录




<a id="sec-7b4cb824"></a>
# 总则
<a id="sec-31292dc4"></a>
## 协议概述
    本协议规定了充电桩与云快充平台之间数据交互的流程、格式和内容。协议整体依据国
    网104充电桩规约，新增数据部分协议参照GBT-27930对充电桩充电过程中与云快充电平
    台的交互数据进行了补充，本协议适用于交直流，交流在本协议中部分数据无需上送数
    据项在下面协议部分均有标注。

<a id="sec-445bb760"></a>
## 通信接口
    充电桩和充电运营管理系统之间的通信接口采用基于 TCP/IP Socket 的通信方式实现
    ，按照长连接工作模式。两个系统可部署在同一个或者不同的企业网络环境中，可以通
    过局域网或者互联网实现互相连接通信。

    充电桩通信联接方式支持有线网络接口、无线 GPRS 连接运营平台服务器或者多个充电
    桩经过集中器与运营平台连接。

    充电桩支持服务器的直接 IP 地址与网络域名解析,地址与连接端口均为可设置参数,测
    试服务器地址为121.199.192.223，端口号为8768。

<a id="sec-209ec684"></a>
## 接入流程
    桩企按照协议内容开发完成后，首先平台会分配测试桩的设备编号以及平台登陆账户，
    桩企可以登陆测试平台查看测试桩与平台的上行下数据帧以及上行数据解析内容，在数
    据帧解析通过后，平台会提供云快充app测试版本（只支持安卓手机）以及充电卡来对
    整个充电流程进行调试，最后在测试环境测试通过后，由平台提供正式环境的相关配置
    信息。

<a id="sec-0387a934"></a>
# 通信协议结构
    本协议的通信协议结构如图1所示。本协议采用的TCP/IP传输定义与标准定义一致。

```text
+---------------+---------------+---------------+
| 应用功能      | 初始化        | 用户进程      |
+---------------+---------------+---------------+
| 本协议中定义的 ASDU           | 应用层(第7层) |
+---------------+---------------+---------------+
| APCI（应用规约控制信息）      | 应用层(第7层) |
| 传输接口（用户到 TCP 的接口） |               |
+---------------+---------------+---------------+
| TCP/IP 协议子集               | 传输层(第4层) |
+---------------+---------------+---------------+
| TCP/IP 协议子集               | 网络层(第3层) |
+---------------+---------------+---------------+
| TCP/IP 协议子集               | 链路层(第2层) |
+---------------+---------------+---------------+
| TCP/IP 协议子集               | 物理层(第1层) |
+---------------+---------------+---------------+
| 注：第5，第6层未用            |               |
+---------------+---------------+---------------+
```



<a id="sec-35fa7543"></a>
# 应用层报文帧格式
<a id="sec-7f194051"></a>
## 应用层数据结构
```text
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 起始标志      | 数据长度      | 序列号域      | 加密标志      | 帧类型标志    | 消息体        | 帧校验域      |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 1字节         | 1字节         | 2字节         | 1字节         | 1字节         | N字节         | 2字节         |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
```

    数据结构定义说明:

    起始标识符代表一帧数据的开始，固定为0x68。

    数据域字节数，数据域长度不超过200字节。不加密时为原数据长度,加密时，为加密后
    数据长

    度。其值为“序列号域+加密标志+帧类型标志+消息体”字节数之和。

    序列号域即为数据包的发送顺序号，从 0 开始顺序增加，如是应答数据包，则与询问
    数据包序号保持一致，当桩与平台网络断开重新建立连接或者溢出后归0。

    加密标志只针对消息体（数据单元）。0x00:不加密，0x01:3DES

    帧类型标志定义了上下行数据帧。

    帧校验域：从序列号域到数据域的 CRC 校验，校验多项式为 0x180D,低字节在前，高
    字节在后，计算方式见附录。

<a id="sec-b1c22fc5"></a>
## 数据格式定义
    数据格式包括BCD码、BIN码、ASCII，BIN码均为低位在前高位在后。协议中小数值均乘
    倍率（保留小数点位数）上送平台（例如：电压为225.1，保留一位小数，上送到平台
    值为2251，即0x8CB）。CP56Time2a 格式如下：

```text
+---------------+---------------+------------------------------+
| Miliseconds(D7-D0)                                           |
+---------------+---------------+------------------------------+
| Miliseconds(D15-D8)                                          |
+---------------+---------------+------------------------------+
| IV(D7)        | RES1          | Minutes(D5-D0)               |
+---------------+---------------+------------------------------+
| SU(D7)        | RES2          | Hours(D4-D0)                 |
+---------------+---------------+------------------------------+
| DAY of WEEK                   | DAY of MONTH(D4-D0)          |
+---------------+---------------+------------------------------+
| RES3          | Month(D3-D0)                                 |
+---------------+---------------+------------------------------+
| RES4          | Years(D6-D0)                                 |
+---------------+---------------+------------------------------+
```



<a id="sec-49469dfe"></a>
## 名词解释
    充电卡：平台默认充电卡为M1卡（不带储值），读卡器读取到的卡号为“物理卡号”，
    卡号储存在第0扇区0块，卡面印刷的卡号为“逻辑卡号”，物理卡号用于充电桩与服务
    器数据交互，逻辑卡号用于显示在桩屏幕上便于用户核对卡信息。IC卡或者CPU卡均采
    用平台M1卡的鉴权模式，不使用数据储存与写入功能。

    交易流水号：交易流水号为一次充电操作过程的统一标记，从远程启动充电或者卡鉴权
    回复时产生到最后桩结束充电的交易记录均使用同一个流水号，由平台产生（离线模式
    由桩按此规则生成），生成规则为 格式桩号（7bytes）+枪号（1byte）+年月日时分秒
    （6bytes）+自增序号

    （2bytes）；示例：32010600019236012001061803423060。

    计损比例：计损比例定义在费率帧中，此项非零时，充电桩需要对上送平台充电量加上
    此比例，如<实时监测数据>中“计损电度”，则为“电度”基础上加上此比例得到的值
    。同理见<交易记录>中“计损尖电量”、“计损峰电量”、 “计损平电量”、 “计损
    谷电量”、 “计损总电量”；（目前平台不支持计损功能，计损比例置0）。

    桩编号：由平台生成提供给桩使用，不支持桩企自行生成的桩编号。示例
    :32010600019236

    枪号：由7个字节桩编号+1个字节的枪号生成。示例：
    3201060001923601/3201060001923602

<a id="sec-a881888d"></a>
# 帧类型定义一缆表
    充电桩定义的帧类型码为奇数，运营平台定义的帧类型码为偶数；帧类型码分段定义，
    已定义的帧类型码不可重定义为其他定义；

```text
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 帧类型码      | 帧类型码名称                 | 数据传送方向                 | 备注                                        |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x01          | 充电桩登录认证               | 充电桩->运营平台             | 充电桩每次复位或通信离线，都需重新登录,并成 |
|               |                              |                              | 功后才能进行后续交互                        |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x02          | 登录认证应答                 | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x03          | 充电桩心跳包                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x04          | 心跳包应答                   | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x05          | 计费模型验证请求             | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x06          | 计费模型验证请求应答         | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x09          | 充电桩计费模型请求           | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x0A          | 计费模型请求应答             | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
|               |                              |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x12          | 读取实时监测数据             | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x13          | 离线监测数据                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x15          | 充电握手                     | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x17          | 参数配置                     | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x19          | 充电结束                     | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x1B          | 错误报文                     | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x1D          | 充电阶段BMS中止              | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x21          | 充电阶段充电机中止           | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x23          | 充电过程 BMS 需求、充电机输  | 充电桩->运营平台             |                                             |
|               | 出                           |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x25          | 充电过程BMS信息              | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
|               |                              |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x31          | 充电桩主动申请启动充电       | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x32          | 运营平台确认启动充电         | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x33          | 远程启机命令回复             | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x34          | 运营平台远程控制启机         | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x35          | 远程停机命令回复             | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x36          | 运营平台远程停机             | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x3B          | 交易记录                     | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x40          | 交易记录确认                 | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x41          | 余额更新应答                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x42          | 远程账户余额更新             | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x43          | 卡数据同步应答               | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x44          | 离线卡数据同步               | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x45          | 离线卡数据清除应答           | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x46          | 离线卡数据清除               | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x47          | 离线卡数据查询应答           | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x48          | 离线卡数据查询               | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x51          | 充电桩工作参数设置应答       | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x52          | 充电桩工作参数设置           | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x55          | 对时设置应答                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x56          | 对时设置                     | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x57          | 计费模型应答                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x58          | 计费模型设置                 | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
|               |                              |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x61          | 地锁数据上送（充电桩上送）   | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x62          | 遥控地锁升锁与降锁命令       | 运营平台->充电桩             |                                             |
|               | （下行）                     |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x63          | 充电桩返回数据（上行）       | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
|               |                              |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x91          | 远程重启应答                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x92          | 远程重启                     | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x93          | 远程更新应答                 | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0x94          | 远程更新                     | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
|               |                              |                              |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0xA1          | 充电桩主动申请并充充电       | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0xA2          | 运营平台确认并充启动充电     | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0xA3          | 远程并充启机命令回复         | 运营平台->充电桩             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
| 0xA4          | 运营平台远程控制并充启机     | 充电桩->运营平台             |                                             |
+---------------+------------------------------+------------------------------+---------------------------------------------+
```



<a id="sec-b89194f2"></a>
# 通信协议流程
<a id="sec-77331758"></a>
## 上电流程
    充电桩在上电或者离线恢复后连接到云快充平台，首先上送充电桩登陆认证，平台对桩
    的信息进行校验，并回复登陆认证应答，如果不符合则会断开当前建立的连接，如果验
    证通过，则桩先检查是否有离线状态下本地储存的实时监测数据或者交易数据，如果有
    则先上送到平台进行处理，随后充电桩发起充电计费模型的请求，平台检测计费模型与
    当前运营费率是否一致，并回复计费模型请求应答，如果不一致，桩需要向平台请求新
    的计费模型。





<a id="sec-1798f26f"></a>
## app充电流程
    app充电流程与刷卡充电流程互通，即app充电可以用卡结束，app鉴权时会将用户绑定
    的卡信息下发到充电桩，用于卡结束验证，卡充电可以用app结束充电。






<a id="sec-c1f398df"></a>
## 刷卡充电



<a id="sec-01a3ca71"></a>
## 离线充电模式



<a id="sec-333f109a"></a>
# 注册心跳帧类型码数据定义
<a id="sec-95085545"></a>
## 充电桩登录认证
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x01                          | 传送间隔      | 通信中断后上电复位           |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩将桩设置的运营编码上传给运营平台，以实现运营平台将运营编码与充电桩建立 |
|               | 连接关系                                                                     |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）22（数据长度）0000（序列号域）00（加密标志）01（类型）         |
|               | 55031412782305 （桩编码）00（桩类型）02（充电枪数量）0F（通信协议版本：V1.5  |
|               | ）56342E312E353000（程序版本：v4.1.50）01（网络链接类型）                    |
|               | 01010101010101010101（sim卡）04（运营商）675A（帧校验域）                    |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编码        | BCD码         | 7             | 不足7位补0                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 桩类型        | BIN码         | 1             | 0表示直流桩，1表示交流桩     |
+---------------+---------------+---------------+---------------+------------------------------+
| 3             | 充电枪数量    | BIN码         | 1             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 4             | 通信协议版本  | BIN码         | 1             | 版本号乘10，v1.0表示0x0A     |
+---------------+---------------+---------------+---------------+------------------------------+
| 5             | 程序版本      | ASCII 码      | 8             | 不足8位补零                  |
+---------------+---------------+---------------+---------------+------------------------------+
| 6             | 网络链接类型  | BIN码         | 1             | 0x00  SIM卡                  |
|               |               |               |               | 0x01  LAN                    |
|               |               |               |               | 0x02  WAN                    |
|               |               |               |               | 0x03  其他                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 7             | Sim卡         | BCD码         | 10            | 不足10位补零，取不到置零     |
+---------------+---------------+---------------+---------------+------------------------------+
| 8             | 运营商        | BIN码         | 1             | 0x00移动                     |
|               |               |               |               | 0x02电信                     |
|               |               |               |               | 0x03 联通                    |
|               |               |               |               | 0x04其他                     |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-ba72962f"></a>
## 登录认证应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x02                          | 传送间隔      | 应答发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 回复电桩登陆结果                                                             |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0C（数据长度）0000（序列号域）00（加密标志）02（类型）55 03 14 |
|               |  12 78 23                                                                    |
|               | 05（桩编码）00（登陆结果：成功）DA 4C（帧校验域）                            |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编码        | BCD码         | 7             | 不足7位补0                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 登陆结果      | BIN码         | 1             | 0x00：登陆成功 0x01:登陆失败 |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-f6c78274"></a>
## 充电桩心跳包
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x03                          | 传送间隔      | 10秒周期上送                 |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 用于链路状态判断，3次未收到心跳包视为网络异常，需要重新登陆                  |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0001（序列号域）00（加密标志）03（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）0x01（枪号：1号枪）00（枪状态：正常）6890（帧校验域）              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编码        | BCD码         | 7             | 不足7位补0                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 枪号          | BCD码         | 1             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 3             | 枪状态        | BIN码         | 1             | 0x00：正常 0x01：故障        |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-35af5dfe"></a>
## 心跳包应答
```text
+---------------+---------------+---------------+---------------+---------------+
| 帧类型码      | 0x04                          | 传送间隔      | 应答发送      |
+---------------+---------------+---------------+---------------+---------------+
| 功能          | 用于链路状态判断                                              |
+---------------+---------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）0D（数据长度）3600（序列号域）00（加密标志）04  |
|               | （类型）55031412782305                                        |
|               | （桩编码）01(枪号) 00（心跳应答）65B2（帧校验域）             |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注          |
+---------------+---------------+---------------+---------------+---------------+
| 1             | 桩编码        | BCD码         | 7             | 不足7位补0    |
+---------------+---------------+---------------+---------------+---------------+
| 2             | 枪号          | BCD码         | 1             |               |
+---------------+---------------+---------------+---------------+---------------+
| 3             | 心跳应答      | BIN码         | 1             | 置0           |
+---------------+---------------+---------------+---------------+---------------+
```



<a id="sec-0efcda49"></a>
## 计费模型验证请求
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x05                          | 传送间隔      | 主动请求，直到成功           |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩在登陆成功后，都需要对当前计费模型校验，如计费模型与平台当前不一致，则 |
|               | 需要向平台请求新的计费模型                                                   |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0002（序列号域）00（加密标志）05（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）0001（计费模型编码）9C00（帧校验域）                               |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             | 不足7位补0                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 计费模型编号  | BCD码         | 2             | 首次连接到平台时置零         |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-7dbd65b5"></a>
## 计费模型验证请求应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x06                          | 传送间隔      | 应答发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 平台判断当前接收的计费模型是否为桩最新的计费模型，如果不一致需要向平台请求新 |
|               | 计费模型，在桩空闲期间下发费率, 其他期间无需下发                             |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68(起始标志) 0E(数据长度) CE 04(序列号域) 00( 加密标志) 06(帧类型标志) 55 03 |
|               |  14 12 78                                                                    |
|               | 23 05（桩编码） 00 00（计费模型编号） 00（验证结果） 8E 2F（帧校验域）       |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             | 不足7位补0                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 计费模型编号  | BCD码         | 2             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 3             | 验证结果      | BIN码         | 1             | 0x00桩计费模型与平台一致     |
|               |               |               |               | 0x01桩计费模型与平台不一致   |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-c16dd899"></a>
## 充电桩计费模型请求
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x09                          | 传送间隔      | 主动请求，直到成功           |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩计费模型与平台不一致时，都需要请求计费模型，如计费模型请求不成功，则禁 |
|               | 止充电                                                                       |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0B（数据长度）0200（序列号域）00（加密标志）09（类型）         |
|               | 55031412782305                                                               |
|               | （桩编码）DD25（帧校验域）                                                   |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             | 不足7位补0                   |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-8211a062"></a>
## 计费模型请求应答
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x0A                                         | 传送间隔      | 应答发送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | 用户充电费用计算，每半小时为一个费率段，共48段，每段对应尖峰平谷其中一个费率充电时桩屏幕按此费率分别显示已 |
|               | 充电费和服务费                                                                                             |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68(起始标志) 5E(数据长度) 02 00(序列号域) 00( 加密标志) 0A(帧类型标志) 55 03 14 12 78 23 05（桩编码） 01   |
|               | 00（计费模型编号） 40 0D 03 00（尖电费费率）9C 40 00 00（尖服务费费率） E0 93 04 00（峰电费费率）9C 40 00  |
|               | 00（峰服务费费率）80 1A 06 00（平电费费率）9C 40 00 00（平服务费费率）20 A1 07 00（谷电费费率）9C 40 00 00 |
|               | （谷服务费费率）                                                                                           |
|               | 00（计损比例） 00（时段费率号 48个）00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   |
|               | 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                                             |
|               | 00 00 00 5E 60（帧校验域）                                                                                 |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 计费模型编号                 | BCD码         | 2             | 固定值：01 00                               |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 尖费电费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | 尖服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 峰电费费率                   | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 峰服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 7             | 平电费费率                   | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 8             | 平服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 9             | 谷电费费率                   | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 10            | 谷服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 11            | 计损比例                     | BIN码         | 1             | 见名词解释                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 12            | 0：00～0：30时段费率号       | BIN码         | 1             | 0x00：尖费率 0x01：峰费率 0x02：平费率 0x03 |
|               |                              |               |               | ：谷费率                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 13            | 0：30～1：00时段费率号       | BIN码         | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| ……          | ……                         | ……          | ……          | ……                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 58            | 23：00～23：30时段费率号     | BIN码         | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 59            | 23：30～0：00时段费率号      | BIN码         | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-7e31a3f7"></a>
# 实时数据帧类型码数据定义
<a id="sec-7eb1834a"></a>
## 读取实时监测数据
```text
+---------------+---------------+---------------+---------------+---------------+
| 帧类型码      | 0x12                          | 传送间隔      | 主动请求      |
+---------------+---------------+---------------+---------------+---------------+
| 功能          | 运营平台根据需要主动发起读取实时数据的请求                    |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）0C（数据长度）0000（序列号域）00（加密标志）12  |
|               | （类型）32010200000001                                        |
|               | （桩编码）01（枪号：1枪）0069（帧校验域）                     |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注          |
+---------------+---------------+---------------+---------------+---------------+
| 1             | 桩编号        | BCD码         | 7             | 不足7位补0    |
+---------------+---------------+---------------+---------------+---------------+
| 2             | 枪号          | BCD码         | 1             |               |
+---------------+---------------+---------------+---------------+---------------+
```



<a id="sec-635c1315"></a>
## 上传实时监测数据


```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x13                          | 传送间隔      | 周期上送、变位上送、召唤                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 上送充电枪实时数据，周期上送时，待机5分钟、充电15秒                                         |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）40（数据长度）1A03（序列号域）00（加密标志）13（类型）                        |
|               | 00000000000000000000000000000000（交易流水号）55031412782305（桩编码）01（枪号：1 号枪）00  |
|               | （状态：离线）01（是否归位：已归位）01（是否插枪：是）0200（输出电压：0）0000 （输出电流：0 |
|               | ）00（枪线温度：10）0000000000000000（枪线编码）00（soc：0）00（电池组最高温度：0）00 00（  |
|               | 累计充电时间：0）00 00（剩余时间：0）00 00 00 00（充电度数：0） 00 00 00 00（计损充电度数： |
|               | 0）00 00 00 00（已充金额：0）0000（硬件故障：无）9DAC（帧校验域）                           |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|                                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            | 见名词解释                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 状态          | BIN码         | 1             | 0x00：离线                                  |
|               |               |               |               | 0x01：故障                                  |
|               |               |               |               | 0x02：空闲                                  |
|               |               |               |               | 0x03：充电                                  |
|               |               |               |               | 需做到变位上送                              |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 枪是否归位    | BIN码         | 1             | 0x00否 0x01是 0x02未知                      |
|               |               |               |               | （无法检测到枪是否插回枪座即未知）          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 是否插枪      | BIN码         | 1             | 0x00否 0x01是需做到变位上送                 |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7             | 输出电压      | BIN码         | 2             | 精确到小数点后一位；待机置零                |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 8             | 输出电流      | BIN码         | 2             | 精确到小数点后一位；待机置零                |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 9             | 枪线温度      | BIN码         | 1             | 整形，偏移量-50；待机置零                   |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 10            | 枪线编码      | BIN码         | 8             | 没有置零                                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 11            | SOC           | BIN码         | 1             | 待机置零；交流桩置零                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 12            | 电池组最高温  | BIN码         | 1             | 整形，偏移量-50 ºC；待机置零；交流桩置零   |
|               | 度            |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 13            | 累计充电时间  | BIN码         | 2             | 单位：min；待机置零                         |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 14            | 剩余时间      | BIN码         | 2             | 单位：min；待机置零、交流桩置零             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 15            | 充电度数      | BIN码         | 4             | 精确到小数点后四位；待机置零                |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 16            | 计损充电度数  | BIN码         | 4             | 精确到小数点后四位；待机置零未设置计损比例  |
|               |               |               |               | 时等于充电度数                              |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 17            | 已充金额      | BIN码         | 4             | 精确到小数点后四位；待机置零（电费+服务费） |
|               |               |               |               | *计损充电度数                               |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 18            | 硬件故障      | BIN码         | 2             | Bit位表示（0否1是），低位到高位顺序         |
|               |               |               |               | Bit1：急停按钮动作故障；                    |
|               |               |               |               | Bit2：无可用整流模块； Bit3：出风口温度过高 |
|               |               |               |               | ；                                          |
|               |               |               |               | Bit4：交流防雷故障；                        |
|               |               |               |               | Bit5：交直流模块 DC20 通信中断；            |
|               |               |               |               | Bit6：绝缘检测模块 FC08 通信中断；          |
|               |               |               |               | Bit7：电度表通信中断； Bit8：读卡器通信中断 |
|               |               |               |               | ；                                          |
|               |               |               |               | Bit9：RC10 通信中断；                       |
|               |               |               |               | Bit10：风扇调速板故障； Bit11：直流熔断器故 |
|               |               |               |               | 障； Bit12：高压接触器故障；                |
|               |               |               |               | Bit13：门打开；                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-03bdaa75"></a>
## 充电握手
```text
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 帧类型码      | 0x15                                                        | 传送间隔      | 主动上送                                    |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 功能          | GBT-27930充电桩与BMS充电握手阶段报文                                                                                      |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 样例报文      | 68（起始标志）4D（数据长度）0015（序列号域）00（加密标志）15（类型）                                                      |               |
|               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）                                           |               |
|               | 000000(BMS 通信协议版本号)00( BMS 电池类型) 0000 (BMS 整车动力蓄电池系统额定容量)                                         |               |
|               |                                                                                                                           |               |
|               |                                                                                                                           |               |
|               |                                                                                                                           |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
|               | 0000(BMS 整车动力蓄电池系统额定总电压) 00000000(BMS 电池生产厂商名称) 00000000(BMS 电池组序号) 00(BMS 电池组生产日期年    |               |
|               | )00(BMS 电池组生产日期月)00(BMS 电池组生产日期                                                                            |               |
|               | 日 )000000(BMS 电 池 组 充 电 次 数 )00(BMS 电 池 组 产 权 标 识 )00( 预 留 位 )                                          |               |
|               | 0000000000000000000000000000000000 (BMS车辆识别码) 0000000000000000(BMS 软件版本号)                                       |               |
|               | FED2（帧校验域）                                                                                                          |               |
|               |                                                                                                                           |               |
|               |                                                                                                                           |               |
|               |                                                                                                                           |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
|                                                                                                                                           |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 序号          | 参数名称                                    | 数据类型      | 长度(Byte)    | 备注                                        |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 1             | 交易流水号                                  | BCD码         | 16            | 见名词解释                                  |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 2             | 桩编号                                      | BCD码         | 7             | 不足7位补0                                  |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 3             | 枪号                                        | BCD码         | 1             |                                             |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 4             | BMS 通信协议版本号                          | BIN           | 3             | 当前版本为 V1.1，表示为：byte3， byte2—    |               |
|               |                                             |               |               | 0001H； byte1—01H                          |               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 5             | BMS电池类型                                 | BIN           | 1             | 电池类型,01H:铅酸电池;02H:氢电池;03H:磷酸铁锂电池;04H:锰酸  |
|               |                                             |               |               | 锂电池;05H:钴酸锂电池;06H: 三元材料电池;07H:聚合物锂离子    |
|               |                                             |               |               | 电池;08H:钛酸锂电池;FFH:其他;                               |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 6             | BMS 整车动力蓄电池系统额定容量              | BIN           | 2             | 0.1 Ah /位，0 Ah 偏移量                                     |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 7             | BMS 整车动力蓄电池系统额定总电压            | BIN           | 2             | 0.1V/位，0V 偏移量                                          |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 8             | BMS电池生产厂商名称                         | BIN           | 4             | 标准 ASCII 码                                               |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 9             | BMS电池组序号                               | BIN           | 4             | 预留，由厂商自行定义                                        |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 10            | BMS电池组生产日期年                         | BIN           | 1             | 1985 年偏移量，数据范围：1985～                             |
|               |                                             |               |               | 2235 年                                                     |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 11            | BMS电池组生产日期月                         | BIN           | 1             | 0 月偏移量，数据范围：1～12 月                              |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 12            | BMS电池组生产日期日                         | BIN           | 1             | 0 日偏移量，数据范围：1～31 日                              |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 13            | BMS电池组充电次数                           | BIN           | 3             | 1 次/位，0 次偏移量，以 BMS 统计为准                        |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 14            | BMS电池组产权标识                           | BIN           | 1             | （<0>：=租赁；<1>：=车自有）                                |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 15            | 预留位                                      | BIN           | 1             |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 16            | BMS车辆识别码                               | BIN           | 17            | VIN                                                         |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
| 17            | BMS 软件版本号                              | BIN           | 8             | Byte8、byte7、byte6—000001H～                              |
|               |                                             |               |               | FFFFFEH，预留，填 FFFFFFH； Byte5-byte2 作为 BMS 软件版本   |
|               |                                             |               |               | 编译时间信息标记，                                          |
|               |                                             |               |               | Byte5，byte4—0001H～FFFEH 表                               |
|               |                                             |               |               | 示“年”（例如 2015 年：填写                                |
|               |                                             |               |               | Byte5—DFH， byte4                                          |
|               |                                             |               |               | —07H）；                                                   |
|               |                                             |               |               | Byte3—01H～0CH 表示“月”（例如 11 月：填写 Byte3—0BH）； |
|               |                                             |               |               |  Byte2—01H～1FH 表示“日”（例                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
|               |                                             |               |               | 如 10 日：填写 Byte2—0AH）； Byte1—01H～FEH 表示版本流水  |
|               |                                             |               |               | 号（例如 16：填写 Byte1—10H）。                            |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
|               |                                             |               |               |                                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+---------------+
```




<a id="sec-b8a3cb93"></a>
## 参数配置
```text
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x17                                                        | 传送间隔      | 主动上送                                    |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | GBT-27930充电桩与BMS参数配置阶段报文                                                                                      |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）31（数据长度）0016（序列号域）00（加密标志）17（类型）                                                      |
|               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）0000(BMS 单体动力蓄电池最高允许充电电压    |
|               | )0000(BMS最高允许充电电流) 0000 (BMS动力蓄电池标称总能量) 0000(BMS最高允许充电总电压) 00(BMS最高允许温度) 0000(BMS整车动  |
|               | 力蓄电池荷电状态(soc)) 0000(BMS整车动力蓄电池当前电池电压)0000(电桩最高输出电压)0000(电桩最低输出电压) 0000(电桩最大输出  |
|               | 电流)0000(电桩最小输出电流) D18A（帧校验域）                                                                              |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                                           |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                                    | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                                  | BCD码         | 16            | 见名词解释                                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                                      | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                                        | BCD码         | 1             |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 4             | BMS 单体动力蓄电池最高允许充电电压          | BIN           | 2             | 0.01 V/位，0 V 偏移量； 数据范围：0~24 V    |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 5             | BMS最高允许充电电流                         | BIN           | 2             | 0.1 A/位，-400A 偏移量                      |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 6             | BMS动力蓄电池标称总能量                     | BIN           | 2             | 0.1 kWh/位，0 kWh 偏移量； 数据范围：0~1000 |
|               |                                             |               |               |  kWh                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 7             | BMS最高允许充电总电压                       | BIN           | 2             | 0.1 V/位，0 V 偏移量                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 8             | BMS最高允许温度                             | BIN           | 1             | 1ºC/位，-50 ºC 偏移量；数据范             |
|               |                                             |               |               | 围：-50 ºC ~+200 ºC                       |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 9             | BMS 整车动力蓄电池荷电状态                  | BIN           | 2             | 0.1%/位，0%偏移量；数据范围：               |
|               | (soc)                                       |               |               | 0~100%                                      |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 10            | BMS 整车动力蓄电池当前电池电压              | BIN           | 2             | 整车动力蓄电池总电压                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 11            | 电桩最高输出电压                            | BIN           | 2             | 0.1 V /位，0 V 偏移量                       |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 12            | 电桩最低输出电压                            | BIN           | 2             | 0.1 V /位，0 V 偏移量                       |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 13            | 电桩最大输出电流                            | BIN           | 2             | 0.1 A/位，-400 A 偏移量                     |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 14            | 电桩最小输出电流                            | BIN           | 2             | 0.1 A/位，-400 A 偏移量                     |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
```





<a id="sec-1383da0e"></a>
## 充电结束
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x19                                         | 传送间隔      | 主动上送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | GBT-27930充电桩与BMS充电结束阶段报文         |               |                                             |
|               |                                              |               |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）2B（数据长度）0016（序列号域）00（加密标志）19（类型）                                       |
|               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）00(BMS                      |
|               | 中止荷电状态 SOC)0000(BMS 动力蓄电池单体最低电压) 0000 (BMS 动力蓄电池单体最高电压) 00(BMS动力蓄电池最低温 |
|               | 度) 00(BMS动力蓄电池最高温度) 0000(电桩累计充电时间) 0000(电桩输出能量)00000000(电桩充电机编号) AE36（帧校 |
|               | 验域）                                                                                                     |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                   | BCD码         | 16            | 见名词解释                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                         | BCD码         | 1             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | BMS中止荷电状态 SOC          | BIN           | 1             | 1%/位，0%偏移量；数据范围：                 |
|               |                              |               |               | 0~100%                                      |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | BMS动力蓄电池单体最低电压    | BIN           | 2             | 0.01 V/位，0 V 偏移量；数据范               |
|               |                              |               |               | 围：0 ~24 V                                 |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | BMS动力蓄电池单体最高电压    | BIN           | 2             | 0.01 V/位，0 V 偏移量；数据范               |
|               |                              |               |               | 围：0 ~24 V                                 |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 7             | BMS动力蓄电池最低温度        | BIN           | 1             | 1ºC/位，-50 ºC 偏移量；数据范             |
|               |                              |               |               | 围：-50 ºC ~+200 ºC                       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 8             | BMS动力蓄电池最高温度        | BIN           | 1             | 1ºC/位，-50 ºC 偏移量；数据范             |
|               |                              |               |               | 围：-50 ºC ~+200 ºC                       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 9             | 电桩累计充电时间             | BIN           | 2             | 1 min/位，0 min 偏移量；数据范围：0~600 min |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 10            | 电桩输出能量                 | BIN           | 2             | 0.1 kWh/位，0 kWh 偏移量；数据范围：0~1000  |
|               |                              |               |               | kWh                                         |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 11            | 电桩充电机编号               | BIN           | 4             | 充 电 机编 号， 1/ 位， 1 偏移量 ，数 据范  |
|               |                              |               |               | 围 ： 0 ～                                  |
|               |                              |               |               | 0xFFFFFFFF                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```





<a id="sec-106a6cd6"></a>
## 错误报文
```text
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x1B                                                        | 传送间隔      | 主动上送                                    |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | GBT-27930充电桩与BMS充电错误报文                                                                                          |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）24（数据长度）0017（序列号域）00（加密标志）1B（类型）                                                      |
|               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）00(序号4-6) 00 (序号7-9) 00 (序号10-12)    |
|               | 00(13-14) 00(15-16) 00(17-19) 00(20-23)00 (24-25)                                                                         |
|               | A2F3（帧校验域）                                                                                                          |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                                           |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                                    | 数据类型      | 长度          | 备注                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                                  | BCD码         | 16 Byte       | 见名词解释                                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                                      | BCD码         | 7 Byte        | 不足7位补0                                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                                        | BCD码         | 1 Byte        |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 4             | 接收 SPN2560=0x00 的充电                    | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               | 机辨识报文超时                              |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 接收 SPN2560=0xAA 的充电                    | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               | 机辨识报文超时                              |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 预留位                                      | BIN           | 4位           | 0000                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 7             | 接收充电机的时间同步和充电机最大输出能力报  | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               | 文超时                                      |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 8             | 接收充电机完成充电准备报文超时              | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 9             | 预留位                                      | BIN           | 4位           | 0000                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 10            | 接收充电机充电状态报文超时                  | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 11            | 接收充电机中止充电报文超时                  | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 12            | 预留位                                      | BIN           | 4位           | 0000                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 13            | 接收充电机充电统计报文超时                  | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 14            | BMS其他                                     | BIN           | 6 位          |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 15            | 接收 BMS 和车辆的辨识报文超时               | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 16            | 预留位                                      | BIN           | 6位           |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 17            | 接收电池充电参数报文超时                    | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 18            | 接收 BMS 完成充电准备报文超时               | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 19            | 预留位                                      | BIN           | 4位           |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 20            | 接收电池充电总状态报文超时                  | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 21            | 接收电池充电要求报文超时                    | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 22            | 接收 BMS 中止充电报文超时                   | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 23            | 预留位                                      | BIN           | 2位           |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 24            | 接收 BMS 充电统计报文超时                   | BIN           | 2 位          | <00>：=正常；<01>：=超时； <10>：           |
|               |                                             |               |               | =不可信状态                                 |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 25            | 充电机其他                                  | BIN           | 6 位          |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-86b48180"></a>
## 充电阶段BMS中止
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x1D                                         | 传送间隔      | 主动上送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | GBT-27930充电桩与BMS充电阶段BMS中止报文                                                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）20（数据长度）0018（序列号域）00（加密标志）1D（类型）                                       |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）00(BMS 中止充电原因) 0000   |
|               | (BMS 中止充电故障原因) 00 (BMS 中止充电错误原因) 8445（帧校验域）                                          |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度Byte      | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                   | BCD码         | 16            | 见名词解释                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                         | BCD码         | 1             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | BMS 中止充电原因             | BIN           | 1             | 1-2位——所需求的 SOC 目标值                |
|               |                              |               |               | 3-4位——达到总电压的设定值                 |
|               |                              |               |               | 5-6位——达到单体电压设定值                 |
|               |                              |               |               | 7-8位——充电机主动中止                     |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | BMS 中止充电故障原因         | BIN           | 2             | 1-2位——绝缘故障                           |
|               |                              |               |               | 3-4位——输出连接器过温故障                 |
|               |                              |               |               | 5-6位——BMS 元件、输出连接器过温           |
|               |                              |               |               | 7-8位——充电连接器故障                     |
|               |                              |               |               | 9-10位——电池组温度过高故障                |
|               |                              |               |               | 11-12位——高压继电器故障                   |
|               |                              |               |               | 13位-14位——检测点 2 电压检测故障          |
|               |                              |               |               | 15-16位——其他故障                         |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | BMS 中止充电错误原因         | BIN           | 1             | 1-2位——电流过大                           |
|               |                              |               |               | 3-4位——电压异常                           |
|               |                              |               |               | 5-8位——预留位                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-6c27bbfe"></a>
## 充电阶段充电机中止
```text
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x21                                         | 传送间隔      | 主动上送                                                    |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | GBT-27930充电桩与BMS充电阶段充电机中止报文                                                                                 |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）20（数据长度）0018（序列号域）00（加密标志）21（类型）                                                       |
|               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）00(BMS 中止充电原因) 0000 (BMS 中止充电故障 |
|               | 原因) 00 (BMS 中止充电错误原因) 8445（帧校验域）                                                                           |
|               |                                                                                                                            |
|               |                                                                                                                            |
|               |                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
|                                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 字节长度Byte                  | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                   | BCD码         | 16                            | 见名词解释                                  |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                       | BCD码         | 7                             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                         | BCD码         | 1                             |                                             |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 充电机 中止充电原因          | BIN           | 1                             | 1-2位——达到充电机设定的条件中止           |
|               |                              |               |                               | 3-4位——人工中止                           |
|               |                              |               |                               | 5-6位——异常中止                           |
|               |                              |               |                               | 7-8位——BMS 主动中止                       |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 充电机 中止充电故障原因      | BIN           | 2                             | 1-2位——充电机过温故障                     |
|               |                              |               |                               | 3-4位——充电连接器故障 5-6 位——充电机内  |
|               |                              |               |                               | 部过温故障7-8 位——所需电量不能传送        |
|               |                              |               |                               | 9-10位——充电机急停故障                    |
|               |                              |               |                               | 11-12位——其他故障                         |
|               |                              |               |                               | 13-16位——预留位                           |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 充电机 中止充电错误原因      | BIN           | 1                             | 1-2位——电流不匹配                         |
|               |                              |               |                               | 3-4位——电压异常                           |
|               |                              |               |                               | 5-8位——预留位                             |
+---------------+------------------------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-c0648a26"></a>
## 充电过程BMS需求与充电机输出
```text
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码                      | 0x23                                                          | 传送间隔                      | 周期上送（15秒）                            |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能                          | GBT-27930充电桩与BMS充电过程BMS需求、充电机输出                                                                                             |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文                      | 68（起始标志）30（数据长度）0019（序列号域）00（加密标志）23（类型）                                                                        |
|                               | 3201020000000011151116155535026（交易流水号）32010200000001（桩编码）01（枪号）0000(BMS 电压需求) 0000 (BMS 电流需求) 00 (BMS 充电模式)     |
|                               | 0000（BMS 充电电压测量值）0000（BMS 充电电流测量值）0000 （BMS最高单体动力蓄电池电压及组号）00（BMS当前荷电状态 SOC（ %）） 0000（BMS估算剩 |
|                               | 余充电时间）0000（电桩电压输出值）0000（电桩电流输出值）0000（累计充电时间）1D57（帧校验域）                                                |
|                               |                                                                                                                                             |
|                               |                                                                                                                                             |
|                               |                                                                                                                                             |
|                               |                                                                                                                                             |
|                               |                                                                                                                                             |
|                               |                                                                                                                                             |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
|                                                                                                                                                                             |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号                          | 参数名称                      | 数据类型                      | 长度(Byte)                    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1                             | 交易流水号                    | BCD码                         | 16                            | 见名词解释                                  |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2                             | 桩编号                        | BCD码                         | 7                             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3                             | 枪号                          | BCD码                         | 1                             |                                             |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4                             | BMS电压需求                   | BIN                           | 2                             | 0.1 V/位，0 V 偏移量                        |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5                             | BMS电流需求                   | BIN                           | 2                             | 0.1 A/位，-400 A 偏移量                     |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6                             | BMS充电模式                   | BIN                           | 1                             | 0x01：恒压充电；0x02：恒流充电              |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7                             | BMS充电电压测量值             | BIN                           | 2                             | 0.1 V/位，0 V 偏移量                        |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 8                             | BMS充电电流测量值             | BIN                           | 2                             | 0.1 A/位，-400 A 偏移量                     |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 9                             | BMS 最高单体动力蓄电池电压及  | BIN                           | 2                             | 1-12 位：最高单体动力蓄电池电               |
|                               | 组号                          |                               |                               | 压，数据分辨率：0.01 V/位，0 V 偏移量；数据 |
|                               |                               |                               |                               | 范围：0~24 V；                              |
|                               |                               |                               |                               | 13-16 位：最高单体动力蓄电池电压所在组号，  |
|                               |                               |                               |                               | 数据分辨率：1/位，                          |
|                               |                               |                               |                               | 0 偏移量；数据范围：0~15                    |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 10                            | BMS当前荷电状态 SOC（ %）     | BIN                           | 1                             | 1%/位，0%偏移量；数据范围：                 |
|                               |                               |                               |                               | 0~100%                                      |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 11                            | BMS估算剩余充电时间           | BIN                           | 2                             | 1 min/位，0 min 偏移量；数据范围：0~600 min |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 12            | 电桩电压输出值                | BIN                           | 2                             | 0.1 V/位，0 V 偏移量                                        |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 13            | 电桩电流输出值                | BIN                           | 2                             | 0.1 A/位，-400 A 偏移量                                     |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
| 14            | 累计充电时间                  | BIN                           | 2                             | 1 min/位，0 min 偏移量；数据范围：0~600 min                 |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------------------------------------+
```

<a id="sec-202bc365"></a>
## 充电过程BMS信息
```text
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x25                                                        | 传送间隔      | 周期上送（15秒）                            |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | GBT-27930充电桩与BMS充电过程BMS信息                                                                                       |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）23（数据长度）0021（序列号域）00（加密标志）25（类型） 3201020000000011151116155535026（交易流水号）        |
|               | 32010200000001（桩编码）01（枪号）00(BMS                                                                                  |
|               | 最高单体动力蓄电池电压所在编号) 00 (BMS最高动力蓄电池温度) 00 (最高温度检测点编号)                                        |
|               | 00（最低动力蓄电池温度）00（最低动力蓄电池温度检测点编号）00（9-12）00（13-16）72B9                                       |
|               | （帧校验域）                                                                                                              |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
|               |                                                                                                                           |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                                           |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                                    | 数据类型      | 长度          | 备注                                        |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                                  | BCD码         | 16Byte        | 见名词解释                                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                                      | BCD码         | 7Byte         | 不足7位补0                                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                                        | BCD码         | 1Byte         |                                             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 4             | BMS最高单体动力蓄电池电压所在编号           | BIN           | 1Byte         | 1/位，1 偏移量；数据范围：1~256             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 5             | BMS最高动力蓄电池温度                       | BIN           | 1Byte         | 1ºC/位，-50 ºC 偏移量；数据范             |
|               |                                             |               |               | 围：-50 ºC ~+200 ºC                       |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 最高温度检测点编号                          | BIN           | 1Byte         | 1/位，1 偏移量；数据范围：1~128             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 7             | 最低动力蓄电池温度                          | BIN           | 1Byte         | 1ºC/位，-50 ºC 偏移量；数据范             |
|               |                                             |               |               | 围：-50 ºC ~+200 ºC                       |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 8             | 最低动力蓄电池温度检测点编号                | BIN           | 1Byte         | 1/位，1 偏移量；数据范围：1~128             |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 9             | BMS单体动力蓄电池电压过高                   | BIN           | 2位           | (<00>：=正常; <01>：=过高; <10>：           |
|               | /过低                                       |               |               | =过低)                                      |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 10            | BMS整车动力蓄电池荷电状态                   | BIN           | 2位           | (<00>：=正常; <01>：=过高; <10>：           |
|               | SOC 过高/过低                               |               |               | =过低)                                      |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 11            | BMS动力蓄电池充电过电流                     | BIN           | 2位           | (<00>：=正常; <01>：=过流; <10>：           |
|               |                                             |               |               | =不可信状态)                                |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 12            | BMS动力蓄电池温度过高                       | BIN           | 2位           | (<00>：=正常; <01>：=过流; <10>：           |
|               |                                             |               |               | =不可信状态)                                |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 13            | BMS动力蓄电池绝缘状态                       | BIN           | 2位           | (<00>：=正常; <01>：=过流; <10>：           |
|               |                                             |               |               | =不可信状态)                                |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 14            | BMS动力蓄电池组输出连接器连接状态           | BIN           | 2位           | (<00>：=正常; <01>：=过流; <10>：           |
|               |                                             |               |               | =不可信状态)                                |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 15            | 充电禁止                                    | BIN           | 2位           | (<00>：=禁止; <01>：=允许)                  |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
| 16            | 预留位                                      | BIN           | 2位           | 00                                          |
+---------------+---------------------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-864eb0ee"></a>
# 运营交互帧类型码数据定义
<a id="sec-5aafc933"></a>
## 充电桩主动申请启动充电
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x31                                         | 传送间隔      | 按需发送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | 用户通过帐号密码及刷卡在充电桩上操作请求充电                                                               |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）37（数据长度）0004（序列号域）00（加密标志）31（类型）32010200000001                         |
|               | （桩编码）01（枪号：1枪）01（启动方式：刷卡启动）00（是否需要密码：不需要）00000000D14B0A54                |
|               | （物理卡号：D14B0A54）00000000000000000000000000000000（输入密码）                                         |
|               | 0000000000000000000000000000000000（VIN码）F496                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 枪号                         | BCD码         | 1             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 启动方式                     | BIN码         | 1             | 0x01 表示通过刷卡启动充电                   |
|               |                              |               |               | 0x02 表求通过帐号启动充电（暂不支持）       |
|               |                              |               |               | 0x03 表示vin码启动充电                      |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | 是否需要密码                 | BIN码         | 1             | 0x00 不需要 0x01需要                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 账号或者物理卡号             | BIN码         | 8             | 不足8位补0，具体见示例                      |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 输入密码                     | BIN码         | 16            | 对用户输入的密码进行16 位MD5 加密，采用小写 |
|               |                              |               |               | 上传                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 7             | VIN码                        | ASCII码       | 17位          | 启动方式为vin码启动充电时上                 |
|               |                              |               |               | 送,其他方式置零( ASCII码)，                 |
|               |                              |               |               | VIN码需要反序上送                           |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-75a56be4"></a>
## 运营平台确认启动充电
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x32                          | 传送间隔      | 应答                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 启动充电鉴权结果                                                                            |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）2A（数据长度）00 04（系列号域）00（加密标志）32（标志）32 01 02 00 00         |
|               | 00 01 01 20 18 06 12 19 59 57 85（交易流水号） 32 01 02 00 00 00 01（桩编码） 01（枪号：1枪 |
|               | ） 00 00 00 00 00 00 00 00（逻辑卡号） 00 00 00 00（账户余额） 00（鉴权成功标志） 01（失败  |
|               | 原因）E8 29（帧校验域）                                                                     |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            | 见名词解释                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 逻辑卡号      | BCD码         | 8             | 显示在屏幕上，不足8位补零                   |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 账户余额      | BIN码         | 4             | 保留两位小数                                |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 鉴权成功标志  | BIN码         | 1             | 0x00 失败 0x01成功                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7             | 失败原因      | BCD码         | 1             | 0x01账户不存在                              |
|               |               |               |               | 0x02账户冻结                                |
|               |               |               |               | 0x03账户余额不足                            |
|               |               |               |               | 0x04该卡存在未结账记录                      |
|               |               |               |               | 0x05桩停用                                  |
|               |               |               |               | 0x06 该账户不能在此桩上充电                 |
|               |               |               |               | 0x07密码错误                                |
|               |               |               |               | 0x08 电站电容不足                           |
|               |               |               |               | 0x09 系统中vin码不存在 0x0A 该桩存在未结账  |
|               |               |               |               | 记录                                        |
|               |               |               |               | 0x0B 该桩不支持刷卡                         |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-468dafd7"></a>
## 运营平台远程控制启机
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x34                          | 传送间隔      | 按需发送                                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 当用户通过远程启动充电时，发送本命令                                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）30（数据长度）007C（序列号域）00（加密标志）34（类型）                        |
|               | 55031412782305012018061914444680（交易流水号）55031412782305（桩编码）01（枪号：1 枪）      |
|               | 0000001000000573（逻辑卡号：1000000573）00000000D14B0A54（物理卡号：D14B0A54）              |
|               | A0860100（账户余额：1000.00）4622                                                           |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            | 见名词解释                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 逻辑卡号      | BCD码         | 8             | 显示在屏幕上，不足补零,逻辑卡号为卡面印刷卡 |
|               |               |               |               | 号                                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 物理卡号      | BIN码         | 8             | 不足补零，桩与平台交互需使用的物理卡号      |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 账户余额      | BIN码         | 4             | 保留到小数点两位                            |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-8622b874"></a>
## 远程启动充电命令回复
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x33                          | 传送间隔      | 应答                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 远程启动充电命令回复                                                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）1E（数据长度）0002（序列号域）00（加密标志）33（类型）                        |
|               | 32010200000000111511161555350260（交易流水号）32010200000001（桩编码）01（枪号：1           |
|               | 枪）01（启动结果：成功）00（失败原因：无）0FE2（帧校验域）                                  |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|                                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 启动结果      | BCD码         | 1             | 0x00失败 0x01成功                           |
|               |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 失败原因      | BIN码         | 1             | 0x00无                                      |
|               |               |               |               | 0x01设备编号不匹配                          |
|               |               |               |               | 0x02枪已在充电                              |
|               |               |               |               | 0x03设备故障                                |
|               |               |               |               | 0x04设备离线                                |
|               |               |               |               | 0x05未插枪                                  |
|               |               |               |               | 桩在收到启充命令后,检测到未插枪则发送0x33报 |
|               |               |               |               | 文回复充电失                                |
|               |               |               |               | 败。若在60秒（以收到0x34时间开始计算）内检  |
|               |               |               |               | 测到枪重新连接，则补送0x33成功报文;超时或者 |
|               |               |               |               | 离线等其他异常，桩不启充、不补发0x33报文    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-5acfe103"></a>
## 运营平台远程停机
```text
+---------------+---------------+---------------+---------------+---------------+
| 帧类型码      | 0x36                          | 传送间隔      | 按需发送      |
+---------------+---------------+---------------+---------------+---------------+
| 功能          | 当用户通过远程停止充电时，发送本命令，如 APP 停止充电         |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）0C（数据长度）0003（序列号域）00（加密标志）36  |
|               | （类型）32010200000001                                        |
|               | （桩编码）01（枪号：1枪）C1A9（帧校验域）                     |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注          |
+---------------+---------------+---------------+---------------+---------------+
| 1             | 桩编号        | BCD码         | 7             | 不足7位补0    |
+---------------+---------------+---------------+---------------+---------------+
| 2             | 枪号          | BCD码         | 1             |               |
+---------------+---------------+---------------+---------------+---------------+
```




<a id="sec-b9a53438"></a>
## 远程停机命令回复



<a id="sec-7d44b779"></a>
## 交易记录
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x3B                                         | 传送间隔      | 主动上送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | 充电桩在网络正常情况下，主运发送结算账单，直到运营平台响应成账单上传成功（若未收到 0x40回复间隔30s再重试一 |
|               | 次，最多重试3次），收到账单结算成功，本账单在充电桩本地删除。每次接收到启机命令并已执行启机过程，无论启机  |
|               | 成功与否，都需在订单结束充电后生成账单上传                                                                 |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）A2（数据长度）8001（序列号域）00（加密标志）3B（类型）                                       |
|               | 55031412782305012018061910262392（交易流水号）55031412782305（桩编码）01（枪号：1 枪）98B70E11100314（开始 |
|               | 时间：2020-03-16 17:14:47）98B70E11100314（结束时间：2020-03-16 17:14:47）D0FB0100（尖单价:1.30000）       |
|               | 00000000（尖电量：0）00000000（计损尖电量：0） 00000000（尖金额：0）D0FB0100（峰单价: 1.30000）00000000（  |
|               | 峰电量：0）00000000（计损峰电量：0）00000000（峰金额：0）D0FB0100（平单价: 1.30000）00000000（平电量：0）  |
|               | 00000000                                                                                                   |
|               | （计损平电量：0）00000000（平金额：0）D0FB0100（谷单价: 1.30000）00000000（谷电量：                        |
|               | 0）00000000（计损谷电量：0）00000000（谷金额：0）0000000000（电表总起值：0）0000000000                     |
|               | （电表总止值：0）00000000（总电量：0）00000000（计损总电量：0）00000000（消费金额：                        |
|               | 0）0000000000000000000000000000000000（VIN码）02（交易标识：app启动）98B70E11100314                        |
|               | （交易时间：2020-03-16 17:14:47）00（停止原因：无）00000000D14B0A54（物理卡号：D14B0A54）                  |
|               | 388C（帧校验域）                                                                                           |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号                   | BCD码         | 16            | 见名词解释                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号                         | BCD码         | 1             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | 开始时间                     | BIN           | 7             | CP56Time2a格式                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 结束时间                     | BIN           | 7             | CP56Time2a格式                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 尖单价                       | BIN           | 4             | 精确到小数点后五位（尖电费+尖服务费，见费率 |
|               |                              |               |               | 帧）                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 7             | 尖电量                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 8             | 计损尖电量                   | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 9             | 尖金额                       | BIN           | 4             | 精确到小数点后四位                          |
|               |                              |               |               |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 10            | 峰单价                       | BIN           | 4             | 精确到小数点后五位（峰电费+峰服务费）       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 11            | 峰电量                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 12            | 计损峰电量                   | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 13            | 峰金额                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 14            | 平单价                       | BIN           | 4             | 精确到小数点后五位（平电费+平服务费）       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 15            | 平电量                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 16            | 计损平电量                   | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 17            | 平金额                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 18            | 谷单价                       | BIN           | 4             | 精确到小数点后五位（谷电费+谷服务费）       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 19            | 谷电量                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 20            | 计损谷电量                   | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 21            | 谷金额                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 22            | 电表总起值                   | BIN           | 5             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 23            | 电表总止值                   | BIN           | 5             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 24            | 总电量                       | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 25            | 计损总电量                   | BIN           | 4             | 精确到小数点后四位                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 26            | 消费金额                     | BIN           | 4             | 精确到小数点后四位，包含电费、服务费        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 27            | 电动汽车唯一标识             | ASCII         | 17            | VIN码，此处VIN码和充电时VIN 码不同，正序直  |
|               |                              |               |               | 接上传，无需补0 和反序                      |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 28            | 交易标识                     | BIN           | 1             | 0x01：app启动                               |
|               |                              |               |               | 0x02：卡启动                                |
|               |                              |               |               | 0x04：离线卡启动                            |
|               |                              |               |               | 0x05: vin码启动充电                         |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 29            | 交易日期、时间               | BIN           | 7             | CP56Time2a格式                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 30            | 停止原因                     | BIN           | 1             | 见附录11.1                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 31            | 物理卡号                     | BIN码         | 8             | 不足8位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-3e36c690"></a>
## 交易记录确认
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x40 	应答发送                                                               |
|               | 运营平台接收到结算账单上传后，都需回复此确认信息。若桩未收到回复帧，则 5 分  |
|               | 钟后继续上送一次交易记录，此情况下无论平台是否成功回复都停止上送。这一帧仅是 |
|               | 报文交互使用，意指平台成功接收到交易记录报文，并不代表交易订单成功结算       |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 0x40 	应答发送                                                               |
|               | 运营平台接收到结算账单上传后，都需回复此确认信息。若桩未收到回复帧，则 5 分  |
|               | 钟后继续上送一次交易记录，此情况下无论平台是否成功回复都停止上送。这一帧仅是 |
|               | 报文交互使用，意指平台成功接收到交易记录报文，并不代表交易订单成功结算       |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）15（数据长度）0002（序列号域）00（加密标志）40（类型）         |
|               | 55031412782305012018061910262392（交易流水号）00（确认结果）48B1（帧校验域） |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 交易流水号    | BCD码         | 16            |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 确认结果      | BIN码         | 1             | 0x00上传成功 0x01非法账单    |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-dd3898bf"></a>
## 远程账户余额更新
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x42                          | 传送间隔      | 按需发送                                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 平台在用户完成充值后会将用户更新的余额下发到充电桩，桩接收到此数据帧需要对当前充电用户的信  |
|               | 息进行校验并更新余额信息                                                                    |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）18（数据长度）0006（序列号域）00（加密标志）42（类型）32010200000001          |
|               | （桩编码）01（枪号）00000000D14B0A54（物理卡号：D14B0A54）                                  |
|               | 00000000（修改后账户金额：0）72EA（帧校验域）                                               |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 物理卡号      | BIN码         | 8             | 不足8位补零                                 |
|               |               |               |               | 如果不为零，需要校验本次充电是否为此卡充电  |
|               |               |               |               | 如果为零，则不校验，直接更新桩当前充电用户  |
|               |               |               |               | 余额                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 修改后账户金  | BIN码         | 4             | 保留两位小数                                |
|               | 额            |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-fee87559"></a>
## 余额更新应答
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x41                          | 传送间隔      | 应答回复                                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 平台在用户完成充值后会将用户更新的余额下发到充电桩，桩接收到此数据帧需要对当前充电用户的信  |
|               | 息进行校验并更新余额信息                                                                    |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）13（数据长度）0006（序列号域）00（加密标志）41（类型）32010200000001          |
|               | （桩编码）00000000D14B0A54（物理卡号：D14B0A54）0x01 (修改结果) 4AC4（帧校验域）            |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 物理卡号      | BIN码         | 8             | 不足8位补零，非必填；有物理卡号时桩需要较验 |
|               |               |               |               | 当前充电是否这此卡充电，没有物理卡号则直接  |
|               |               |               |               | 更新当前充电用户余额                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 修改结果      | BIN码         | 1             | 0x00-修改成功                               |
|               |               |               |               | 0x01-设备编号错误                           |
|               |               |               |               | 0x02-卡号错误                               |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-59e0334c"></a>
## 离线卡数据同步
```text
+---------------+---------------+---------------+---------------+---------------+
| 帧类型码      | 0x44                          | 传送间隔      | 按需下发      |
+---------------+---------------+---------------+---------------+---------------+
| 功能          | 离线卡适用于桩离线充电模式，平台在充电桩在线时会下发此数据帧  |
|               | 到充电桩，充电桩接收到后储存离线卡信息到桩本地（如果已存在离  |
|               | 线卡则用最新的数据覆盖本地数据，不存在则插入），若用户刷卡充  |
|               | 电时桩处理离线模式，则刷鉴权走桩本地进行判断。                |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）2C（数据长度）0007（序列号域）00（加密标志）44  |
|               | （类型）32010200000001                                        |
|               | （桩编码）0x01(下发卡个数) 0000000010000001（逻辑卡号）       |
|               | 00000000D14B0A54（物理卡号：                                  |
|               | D14B0A54）F264（帧校验域）                                    |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注          |
+---------------+---------------+---------------+---------------+---------------+
| 1             | 桩编号        | BCD码         | 7             |               |
+---------------+---------------+---------------+---------------+---------------+
| 2             | 下发卡个数    | BIN码         | 1             | 最大 15 个    |
+---------------+---------------+---------------+---------------+---------------+
| 3             | 第1个卡逻辑卡 | BCD码         | 8             | 离线卡逻辑卡  |
|               | 号            |               |               | 号            |
+---------------+---------------+---------------+---------------+---------------+
| ........      | ........      | ........      | ........      |               |
+---------------+---------------+---------------+---------------+---------------+
| N+2           | 第N个卡物理卡 | BIN码         | 8             | 离线卡物理卡  |
|               | 号            |               |               | 号            |
+---------------+---------------+---------------+---------------+---------------+
```



<a id="sec-81c354f0"></a>
## 离线卡数据同步应答
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x43                          | 传送间隔      | 应答                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 离线卡数据同步应答                                                                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0007（序列号域）00（加密标志）43（类型）32010200000001          |
|               | （桩编码）01(保存结果) 00（失败原因）6890（帧校验域）                                       |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 保存结果      | BIN码         | 1             | 0x00失败 0x01成功                           |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 失败原因      | BIN码         | 1             | 0x01 卡号格式错误 0x02 储存空间不足         |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-c1bee808"></a>
## 离线卡数据清除
```text
+---------------+------------------------------+---------------+---------------+---------------+
| 帧类型码      | 0x46 	按需下发                                                               |
|               | 离线卡清除是平台主动下发的操作，平台在充电桩在线时会下发此数据帧到充电桩，充 |
|               | 电桩接收到离线卡数据清除报文后清除到桩本地对应的离线卡数据                   |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 功能          | 0x46 	按需下发                                                               |
|               | 离线卡清除是平台主动下发的操作，平台在充电桩在线时会下发此数据帧到充电桩，充 |
|               | 电桩接收到离线卡数据清除报文后清除到桩本地对应的离线卡数据                   |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）2C（数据长度）0007（序列号域）00（加密标志）46（类型）         |
|               | 32010200000001 （桩编码）0x01(清除离线卡的个数) 00000000D14B0A54（物理卡号： |
|               | D14B0A54）F264（帧校验域）                                                   |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注          |
+---------------+------------------------------+---------------+---------------+---------------+
| 1             | 桩编号                       | BCD码         | 7             |               |
+---------------+------------------------------+---------------+---------------+---------------+
| 2             | 清除离线卡的个数             | BIN码         | 1             | 最大24个      |
+---------------+------------------------------+---------------+---------------+---------------+
| 3             | 第1个卡物理卡号              | BIN码         | 8             | 离线卡物理卡  |
|               |                              |               |               | 号            |
+---------------+------------------------------+---------------+---------------+---------------+
| ........      | ........                     | ........      | ........      |               |
+---------------+------------------------------+---------------+---------------+---------------+
| N+2           | 第N个卡物理卡号              | BIN码         | 8             | 离线卡物理卡  |
|               |                              |               |               | 号            |
+---------------+------------------------------+---------------+---------------+---------------+
```



<a id="sec-4f1e99ba"></a>
## 离线卡数据清除应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x45                          | 传送间隔      | 应答                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 离线卡数据清除应答                                                           |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0007（序列号域）00（加密标志）45（类型）         |
|               | 32010200000001 （桩编码）00000000D14B0A54（物理卡号：D14B0A54）00（失败原因  |
|               | ）00000000E14C0A54（物理卡号：540A4CE1）00（失败原因）6890（帧校验域）       |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 第1个卡物理卡 | BIN码         | 8             | 离线卡物理卡号               |
|               | 号            |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 3             | 清除标记      | BIN 码        | 1             | 0x00清除失败 0x01清除成功    |
+---------------+---------------+---------------+---------------+------------------------------+
| 4             | 失败原因      | BCD码         | 1             | 0x01卡号格式错误             |
|               |               |               |               | 0x02 清除成功                |
+---------------+---------------+---------------+---------------+------------------------------+
| ........      | ........      | ........      | ........      |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| N+1           | 第N个卡物理卡 | BIN码         | 8             | 离线卡物理卡号               |
|               | 号            |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| N+2           | 清除标记      | BIN 码        | 1             | 0x00清除失败 0x01清除成功    |
+---------------+---------------+---------------+---------------+------------------------------+
| N+3           | 失败原因      | BCD码         | 1             | 0x00清除成功                 |
|               |               |               |               | 0x01卡号格式错误             |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-a049ced3"></a>
## 离线卡数据查询
```text
+---------------+------------------------------+---------------+---------------+---------------+
| 帧类型码      | 0x48                                         | 传送间隔      | 按需下发      |
+---------------+------------------------------+---------------+---------------+---------------+
| 功能          | 离线卡数据查询由平台主动向桩发起的查询请求，平台在充电桩在线时会按需下发此数 |
|               | 据帧到充电桩，桩接收到该报文后进行查询桩本地是否存在对应的离线卡             |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）2C（数据长度）0007（序列号域）00（加密标志）48（类型）         |
|               | 32010200000001                                                               |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
|               | （桩编码）0x01(查询的离线卡个数) 00000000D14B0A54（物理卡号：D14B0A54）F264  |
|               | （帧校验域）                                                                 |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注          |
+---------------+------------------------------+---------------+---------------+---------------+
| 1             | 桩编号                       | BCD码         | 7             |               |
+---------------+------------------------------+---------------+---------------+---------------+
| 2             | 查询的离线卡个数             | BIN码         | 1             | 最大26个      |
+---------------+------------------------------+---------------+---------------+---------------+
| 3             | 第1个卡物理卡号              | BIN码         | 8             | 离线卡物理卡  |
|               |                              |               |               | 号            |
+---------------+------------------------------+---------------+---------------+---------------+
| ........      | ........                     | ........      | ........      |               |
+---------------+------------------------------+---------------+---------------+---------------+
| N+2           | 第N个卡物理卡号              | BIN码         | 8             | 离线卡物理卡  |
|               |                              |               |               | 号            |
+---------------+------------------------------+---------------+---------------+---------------+
```



<a id="sec-15b0091d"></a>
## 离线卡数据查询应答
```text
+---------------+------------------------------+---------------+---------------+---------------+
| 帧类型码      | 0x47                                         | 传送间隔      | 应答          |
+---------------+------------------------------+---------------+---------------+---------------+
| 功能          | 离线卡数据查询应答                                                           |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）0D（数据长度）0007（序列号域）00（加密标志）47（类型）         |
|               | 32010200000001（桩编码）00000000D14B0A54（物理卡号：D14B0A54）01(查询结果)   |
|               | 00000000E14C0A54（物理卡号：                                                 |
|               | 540A4CE1）00（查询结果）6890（帧校验域）                                     |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+------------------------------+---------------+---------------+---------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注          |
+---------------+------------------------------+---------------+---------------+---------------+
| 1             | 桩编号                       | BCD码         | 7             |               |
+---------------+------------------------------+---------------+---------------+---------------+
| 2             | 第1个卡物理卡号              | BIN码         | 8             | 离线卡物理卡  |
|               |                              |               |               | 号            |
+---------------+------------------------------+---------------+---------------+---------------+
| 3             | 查询结果                     | BIN码         | 1             | 0x00不存在    |
|               |                              |               |               | 0x01存在      |
+---------------+------------------------------+---------------+---------------+---------------+
| ........      | ........                     | ........      | ........      |               |
+---------------+------------------------------+---------------+---------------+---------------+
| N+1           | 第N+1个卡物理卡号            | BIN码         | 8             | 离线卡物理卡  |
|               |                              |               |               | 号            |
+---------------+------------------------------+---------------+---------------+---------------+
| N+2           | 查询结果                     | BIN码         | 1             | 0x00不存在    |
|               |                              |               |               | 0x01存在      |
+---------------+------------------------------+---------------+---------------+---------------+
```



<a id="sec-9c1d8781"></a>
# 运营平台设置帧类型码数据定义
<a id="sec-c2c01a59"></a>
## 充电桩工作参数设置
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x52                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 远程设置充电桩是否停用；设置充电桩允许输出功率，以实现电网功率的调节         |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0008（序列号域）00（加密标志）52（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）0x01(是否允许工作) 0x00（充电桩最大允许输出功率）6890（帧校验域）  |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 是否允许工作  | BIN码         | 1             | 0x00表示允许正常工作         |
|               |               |               |               | 0x01表示停止使用，锁定充电桩 |
+---------------+---------------+---------------+---------------+------------------------------+
```


```text
+---------------+------------------------------+---------------+---------------+------------------------------+
| 3             | 充电桩最大允许输出功率       | BIN码         | 1             | 1BIN 表示 1%，最大 100%，最  |
|               |                              |               |               | 小                           |
|               |                              |               |               | 30%                          |
+---------------+------------------------------+---------------+---------------+------------------------------+
```



<a id="sec-a0940d73"></a>
## 充电桩工作参数设置应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x51                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩接收到运营平台充电桩工作参数设置时，响应本数据                         |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0C（数据长度）0008（序列号域）00（加密标志）51（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）0x01(设置结果) C1A9（帧校验域）                                    |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 设置结果      | BIN码         | 1             | 0x00失败 0x01成功            |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-3edbd8b3"></a>
## 对时设置
```text
+---------------+---------------+---------------+---------------+---------------+
| 帧类型码      | 0x56                          | 传送间隔      | 周期发送（1天 |
|               |                               |               | ）            |
+---------------+---------------+---------------+---------------+---------------+
| 功能          | 运营平台同步充电桩时钟，以保证充电桩与运营平台的时钟一致      |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）12（数据长度）00DF（序列号域）00（加密标志）56  |
|               | （类型）55031412782305                                        |
|               | （桩编码）98B70E11100314（当前时间：2020-03-16 17:14:47）8A13 |
|               | （帧校验域）                                                  |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注          |
+---------------+---------------+---------------+---------------+---------------+
| 1             | 桩编号        | BCD码         | 7             |               |
+---------------+---------------+---------------+---------------+---------------+
| 2             | 当前时间      | BIN码         | 7             | CP56Time2a格  |
|               |               |               |               | 式            |
+---------------+---------------+---------------+---------------+---------------+
```



<a id="sec-0b5bb3ef"></a>
## 对时设置应答
```text
+---------------+---------------+---------------+---------------+---------------+
| 帧类型码      | 0x55                          | 传送间隔      | 应答          |
+---------------+---------------+---------------+---------------+---------------+
| 功能          | 充电桩接收到运营平台同步充电桩时钟时应答                      |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 样例报文      | 68（起始标志）12（数据长度）A101（序列号域）00（加密标志）55  |
|               | （类型）55031412782305                                        |
|               | （桩编码）98B70E11100314（当前时间：2020-03-16 17:14:47）0E9B |
|               | （帧校验域）                                                  |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
|               |                                                               |
+---------------+---------------+---------------+---------------+---------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注          |
+---------------+---------------+---------------+---------------+---------------+
| 1             | 桩编号        | BCD码         | 7             |               |
+---------------+---------------+---------------+---------------+---------------+
| 2             | 当前时间      | BIN码         | 7             | CP56Time2a格  |
|               |               |               |               | 式            |
+---------------+---------------+---------------+---------------+---------------+
```



<a id="sec-c4e621e1"></a>
## 计费模型设置
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 桢类型码      | 0x58                                         | 传送间隔      | 按需发送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | 用户充电费用计算，每半小时为一个费率段，共 48 段，每段对应尖峰平谷其中一个费率充电时桩屏幕按此费率分别显示 |
|               | 已充电费和服务费                                                                                           |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）5E（数据长度）0025（序列号域）00（加密标志）58（类型）55031412782305 （桩编码）0100(计费模型 |
|               | 编码）40 0D 03 00（尖电费费率,2元/度）9C 40 00 00（尖服务费费率,0.4元/度） E0 93 04 00（峰电费费率,2元/度  |
|               | ）9C 40 00 00（峰服务费费率,0.4元/ 度）80 1A 06 00（平电费费率,4元/度）9C 40 00 00（平服务费费率,0.4元/度  |
|               | ）20 A1 07 00                                                                                              |
|               | （谷电费费率,5元/度）9C 40 00 00（谷服务费费率,0.4元/度）00(计损比例) 00(0：00～0：                        |
|               | 30时段费率号) 00(0：30～1：00时段费率                                                                      |
|               | 号)0000000000000000000000000000000000000000000000000000000000000000000000000000000 00000000000005E60       |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 计费模型编码                 | BCD码         | 2             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 尖费电费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | 尖服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 峰电费费率                   | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 峰服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 7             | 平电费费率                   | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 8             | 平服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 9             | 谷电费费率                   | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 10            | 谷服务费费率                 | BIN码         | 4             | 精确到五位小数                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 11            | 计损比例                     | BIN码         | 1             | 见名词解释                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 12            | 0：00～0：30时段费率号       | BIN码         | 1             | 0：尖费率 1：峰费率 2：平费率 3：谷费率     |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 13            | 0：30～1：00时段费率号       | BIN码         | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| ……          | ……                         | ……          | ……          | ……                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 58            | 23：00～23：30时段费率号     | BIN码         | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 59            | 23：30～0：00时段费率号      | BIN码         | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```

<a id="sec-e52e62f4"></a>
## 计费模型应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 桢类型码      | 0x57                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩接收到运营平台计费模型时，响应本数据                                   |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0C（数据长度）0009（序列号域）00（加密标志）57（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）01（设置结果）C1A9（桢校验域）                                     |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD 码        | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 设置结果      | BIN码         | 1             | 0x00 失败 0x01 成功          |
+---------------+---------------+---------------+---------------+------------------------------+
```





<a id="sec-b16fdc14"></a>
# 车位锁通信协议定义
    地锁状态变化需要传输给平台，若地锁出现故障，则传输故障码至平台，若检测出现故
    障则，默认地锁为降下状态；若为升降出现故障，则保持现有状态

<a id="sec-1a65e941"></a>
## 地锁数据上送
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x61                          | 传送间隔      | 按需上送                                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 地锁状态/报警信息变化时，桩立刻上送变位/报警信息；地锁状态不变化时，每隔 5 分钟周期性上送地 |
|               | 锁状态。若无报警信息，不上送。                                                              |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）14（数据长度）0001（序列号域）00（加密标志）61（类型）32010200000001 （桩编码 |
|               | ）0x01（枪号：1号枪）00（车位状态：无车辆）00（地锁电量状态：0）00（报警状态）00000000（预  |
|               | 留位）6890（帧校验域）                                                                      |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号        | BCD码         | 7             | 充电桩资产编号，系统参数的编号              |
|               |               |               |               | (终端机器编码)                              |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 枪号          | BIN码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 车位锁状态    | BIN码         | 1             | 0x00：未到位状态                            |
|               |               |               |               | 0x55：升锁到位状态 0xFF：降锁到位状态       |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 车位状态      | BIN码         | 1             | 0x00：无车辆                                |
|               |               |               |               | 0xFF：停放车辆                              |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 地锁电量状态  | BIN码         | 1             |                                             |
|               |               |               |               | 百分比值0~100                               |
|               |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 报警状态      | BIN码         | 1             | 0x00：正常无报警                            |
|               |               |               |               | 0xFF：待机状态摇臂破坏                      |
|               |               |               |               | 0x55：摇臂升降异常(未到位)                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7             | 预留位        | BIN码         | 4             | 全部置0                                     |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```





<a id="sec-585d33e0"></a>
## 遥控地锁升锁与降锁命令
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x62                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 服务器下发命令给地锁，地锁执行动作                                           |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0001（序列号域）00（加密标志）62（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）0x01（枪号：1号枪）55（升/降地锁）00000000（预留位）6890（帧校验域 |
|               | ）                                                                           |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             | 充电桩资产编号，系统参数的编 |
|               |               |               |               | 号                           |
|               |               |               |               | (终端机器编码)               |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 枪号          | BIN码         | 1             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 3             | 升/降地锁     | BCD码         | 1             | 升锁0X55，降锁0XFF           |
+---------------+---------------+---------------+---------------+------------------------------+
| 4             | 预留位        | BIN码         | 4             | 全部置0（可用于多枪）        |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-e01de362"></a>
## 充电桩返回数据(上行)
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0x63                                         | 传送间隔      | 按需发送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | 地锁收到遥控地锁升锁与降锁命令指令，响应本数据                                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）0D（数据长度）0001（序列号域）00（加密标志）63（类型）32010200000001                         |
|               | （桩编码）0x01（枪号：1号枪）00（地锁控制返回标志）00000000（预留位）6890（帧校验域）                      |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号                       | BCD码         | 7             | 充电桩资产编号，系统参数的编号              |
|               |                              |               |               | (终端机器编码)                              |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 枪号                         | BIN码         | 1             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 地锁控制返回标志             | BIN码         | 1             | 布尔型（1，鉴权成功；0，鉴权失败）          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 预留位                       | BIN码         | 4             | 全部置0（可用于多枪）                       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-68e56b55"></a>
# 电桩远程维护帧类型码数据定义
<a id="sec-336c7a51"></a>
## 远程重启
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x92                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 重启充电桩，应对部分问题，如卡死                                             |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0C（数据长度）0011（序列号域）00（加密标志）92（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）01（执行控制）C1A9（帧校验域）                                     |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |               |               |                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 执行控制      | BIN码         | 1             | 0x01：立即执行 0x02：空闲执  |
|               |               |               |               | 行                           |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-324479d1"></a>
## 远程重启应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x91                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩接收到运营平台远程重启指令时，响应本数据                               |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0C（数据长度）0011（序列号域）00（加密标志）91（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）01（设置结果）C1A9（帧校验域）                                     |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 设置结果      | BIN码         | 1             | 0x00失败 0x01成功            |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-504d6ce1"></a>
## 远程更新
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x94                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 对桩进行软件升级，平台升级模式为 ftp 文件升级，由桩企提供升级需要的更新文件  |
|               | （特定文件名，由桩企定义），平台在数据帧中提供访问更新文件相关服务器地址及下 |
|               | 载路径信息，桩下载完更新程序后对文件进行较验，并对桩进行升级。               |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）62（数据长度）0026（序列号域）00（加密标志）94（类型）         |
|               | 55031412782305                                                               |
|               | （桩编码）01（桩型号）0F00(桩功率) 3131342E35352E3131342E3137340000(升级服务 |
|               | 器地址) 1500(升级服务器端口) 73720000000000000000000000000000(用户名         |
|               | )73723132330000000000000000000000(密码)                                      |
|               | 41432D374B572F32303138303133310000000000000000000000000000000000(文件路径    |
|               | )02(执行控制) 3C(下载超时时间)7A2C                                           |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|                                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 桩型号        | BIN码         | 1             | 0x01：直流                   |
|               |               |               |               | 0x02：交流                   |
+---------------+---------------+---------------+---------------+------------------------------+
| 3             | 桩功率        | BIN码         | 2             | 不足2位补零                  |
+---------------+---------------+---------------+---------------+------------------------------+
| 4             | 升级服务器地  | ASCII码       | 16            | 不足16位补零                 |
|               | 址            |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 5             | 升级服务器端  | BIN码         | 2             | 不足2位补零                  |
|               | 口            |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 6             | 用户名        | ASCII码       | 16            | 不足16位补零                 |
+---------------+---------------+---------------+---------------+------------------------------+
| 7             | 密码          | ASCII码       | 16            | 不足16位补零                 |
+---------------+---------------+---------------+---------------+------------------------------+
| 8             | 文件路径      | ASCII码       | 32            | 不足32位补零，文件路径名由平 |
+---------------+---------------+---------------+---------------+------------------------------+
|               |               |               |               | 台定义                       |
+---------------+---------------+---------------+---------------+------------------------------+
| 9             | 执行控制      | BIN码         | 1             | 0x01：立即执行 0x02：空闲执  |
|               |               |               |               | 行                           |
+---------------+---------------+---------------+---------------+------------------------------+
| 10            | 下载超时时间  | BIN码         | 1             | 单位：min                    |
+---------------+---------------+---------------+---------------+------------------------------+
```



<a id="sec-d3aa5b1b"></a>
## 远程更新应答
```text
+---------------+---------------+---------------+---------------+------------------------------+
| 帧类型码      | 0x93                          | 传送间隔      | 按需发送                     |
+---------------+---------------+---------------+---------------+------------------------------+
| 功能          | 充电桩执行过运营平台远程更新指令，响应本数据                                 |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 样例报文      | 68（起始标志）0C（数据长度）0012（序列号域）00（加密标志）93（类型）         |
|               | 32010200000001                                                               |
|               | （桩编码）01（升级状态）C1A9（帧校验域）                                     |
|               |                                                                              |
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
|               |                                                                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                         |
+---------------+---------------+---------------+---------------+------------------------------+
| 1             | 桩编号        | BCD码         | 7             |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 2             | 升级状态      | BIN码         | 1             | 0x00-成功                    |
|               |               |               |               | 0x01-编号错误                |
|               |               |               |               | 0x02-程序与桩型号不符        |
|               |               |               |               | 0x03-下载更新文件超时        |
+---------------+---------------+---------------+---------------+------------------------------+
```





<a id="sec-26a47f73"></a>
# 并充模式帧类型码数据定义
<a id="sec-6edcc8d6"></a>
## 充电桩主动申请并充充电
```text
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0xA1                                         | 传送间隔      | 按需发送                                    |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 功能          | 用户通过帐号密码及刷卡在充电桩上操作请求充电，多枪并充时每个枪都需要分别上送此帧。                         |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）3E（数据长度）0004（序列号域）00（加密标志）A1（类型）32010200000001                         |
|               | （桩编码）01（枪号：1枪）01（启动方式：刷卡启动）00（是否需要密码：不需要）00000000D14B0A54                |
|               | （物理卡号：D14B0A54）00000000000000000000000000000000（输入密码）                                         |
|               | 0000000000000000000000000000000000（VIN码）00(主枪)201029112801(并充序号)F496                              |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
|               |                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|                                                                                                                            |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称                     | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 1             | 桩编号                       | BCD码         | 7             | 不足7位补0                                  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 2             | 枪号                         | BCD码         | 1             |                                             |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 3             | 启动方式                     | BIN码         | 1             | 0x01 表示通过刷卡启动充电                   |
|               |                              |               |               | 0x02 表求通过帐号启动充电（暂不支持）       |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
|               |                              |               |               | 0x03 表示vin码启动充电                      |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 4             | 是否需要密码                 | BIN码         | 1             | 0x00 不需要 0x01需要                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 5             | 账号或者物理卡号             | BIN码         | 8             | 不足8位补0，具体见示例                      |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 6             | 输入密码                     | BIN码         | 16            | 对用户输入的密码进行16 位MD5 加密，采用小写 |
|               |                              |               |               | 上传                                        |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 7             | VIN码                        | ASCII码       | 17位          | 启动方式为vin码启动充电时上                 |
|               |                              |               |               | 送,其他方式置零( ASCII码)，                 |
|               |                              |               |               | VIN码需要反序上送                           |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 8             | 主辅枪标记                   | BIN码         | 1             | 0x00 主枪 0x01辅枪                          |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
| 9             | 并充序号                     | BCD码         | 6             | 由桩生成，生成规则：年月日时分秒，多个枪并  |
|               |                              |               |               | 充时上送并充序号一致，标志为同一次并充操作  |
+---------------+------------------------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-dc5fd61d"></a>
## 运营平台确认并充启动充电
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0xA2                          | 传送间隔      | 应答                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 启动充电鉴权结果，桩需要接收到所有平台并充枪的确认结果，若都鉴权成功则启动并充，否则有一个  |
|               | 枪鉴权失败则不启动并充。后续充电实时数据，交易都按对应枪及流水号上送。                      |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）30（数据长度）00 04（系列号域）00（加密标志）32（标志）32 01 02 00 00         |
|               | 00 01 01 20 18 06 12 19 59 57 85（交易流水号） 32 01 02 00 00 00 01（桩编码） 01（枪号：1枪 |
|               | ） 00 00 00 00 00 00 00 00（逻辑卡号） 00 00 00 00（账户余额） 00（鉴权成功                 |
|               | 标志） 01（失败原因）201029112801(并充序号)E8 29（帧校验域）                                |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|                                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            | 见名词解释                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 逻辑卡号      | BCD码         | 8             | 显示在屏幕上，不足8位补零                   |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 账户余额      | BIN码         | 4             | 保留两位小数                                |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 鉴权成功标志  | BIN码         | 1             | 0x00 失败 0x01成功                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7             | 失败原因      | BCD码         | 1             | 0x01账户不存在                              |
|               |               |               |               | 0x02账户冻结                                |
|               |               |               |               | 0x03账户余额不足                            |
|               |               |               |               | 0x04该卡存在未结账记录                      |
|               |               |               |               | 0x05桩停用                                  |
|               |               |               |               | 0x06 该账户不能在此桩上充电                 |
|               |               |               |               | 0x07密码错误                                |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |               |               |               | 0x08 电站电容不足                           |
|               |               |               |               | 0x09 系统中vin码不存在 0x0A 该桩存在未结账  |
|               |               |               |               | 记录                                        |
|               |               |               |               | 0x0B 该桩不支持刷卡                         |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 9             | 并充序号      | BCD码         | 6             | 0xA1上送并充序号                            |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-76710741"></a>
## 运营平台远程控制并充启机
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0xA4                          | 传送间隔      | 按需发送                                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 当用户通过远程启动充电并且为并充模式时，发送本命令                                          |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）36（数据长度）007C（序列号域）00（加密标志）A4（类型）                        |
|               | 55031412782305012018061914444680（交易流水号）55031412782305（桩编码）01（枪号：1 枪）      |
|               | 0000001000000573（逻辑卡号：1000000573）00000000D14B0A54（物理卡号：D14B0A54）              |
|               | A0860100（账户余额：1000.00）201029112801(并充序号)4622                                     |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|                                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            | 见名词解释                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 逻辑卡号      | BCD码         | 8             | 显示在屏幕上，不足补零,逻辑卡号为卡面印刷卡 |
|               |               |               |               | 号                                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 物理卡号      | BIN码         | 8             | 不足补零，桩与平台交互需使用的物理卡号      |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 账户余额      | BIN码         | 4             | 保留到小数点两位                            |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7             | 并充序号      | BCD码         | 6             | 平台生成，生成规则：年月日时分秒，多个枪并  |
|               |               |               |               | 充时上送并充序号一致，标志为同一次并充操作  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-e588b1e5"></a>
## 远程并充启机命令回复
```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 帧类型码      | 0xA3                          | 传送间隔      | 应答                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 功能          | 远程启动充电命令回复，并充多枪指令回复应一致。后续充电实时数据，交易都按对应枪及流水号上送  |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 样例报文      | 68（起始标志）25（数据长度）0002（序列号域）00（加密标志）A3（类型）                        |
|               | 32010200000000111511161555350260（交易流水号）32010200000001（桩编码）01（枪号：1 枪）01（  |
|               | 启动结果：成功）00（失败原因：无）00（主辅枪标记）201029112801(并充序号)0FE2                |
|               | （帧校验域）                                                                                |
|               |                                                                                             |
|               |                                                                                             |
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
|               |                                                                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 参数名称      | 数据类型      | 长度(Byte)    | 备注                                        |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 1             | 交易流水号    | BCD码         | 16            |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 2             | 桩编号        | BCD码         | 7             | 不足7位补0                                  |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 3             | 枪号          | BCD码         | 1             |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 4             | 启动结果      | BCD码         | 1             | 0x00失败 0x01成功                           |
|               |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 5             | 失败原因      | BIN码         | 1             | 0x00无                                      |
|               |               |               |               | 0x01设备编号不匹配                          |
|               |               |               |               | 0x02枪已在充电                              |
|               |               |               |               | 0x03设备故障                                |
|               |               |               |               | 0x04设备离线                                |
|               |               |               |               | 0x05未插枪                                  |
|               |               |               |               | 桩在收到启充命令后,检测到未插枪则发送0x33报 |
|               |               |               |               | 文回复充电失                                |
|               |               |               |               | 败。若在60秒（以收到0x34时间开始计算）内检  |
|               |               |               |               | 测到枪重新连接，则补送0x33成功报文;超时或者 |
|               |               |               |               | 离线等其他异常，桩不启充、不补发0x33报文    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 6             | 主辅枪标记    | BIN码         | 1             | 0x00 主枪 0x01辅枪                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 7             | 并充序号      | BCD码         | 6             | 0xA4下发的并充序号                          |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



<a id="sec-f8519014"></a>
# 附录
<a id="sec-baf38792"></a>
## 充电停止原因代码表
```text
+---------------+---------------+---------------------------------------------+
| 类别          | 代码          | 具体原因                                    |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x40          | 结束充电，APP远程停止                       |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x41          | 结束充电，SOC达到100%                       |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x42          | 结束充电，充电电量满足设定条件              |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x43          | 结束充电，充电金额满足设定条件              |
|               |               |                                             |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x44          | 结束充电，充电时间满足设定条件              |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x45          | 结束充电，手动停止充电                      |
+---------------+---------------+---------------------------------------------+
| 充电完成      | 0x46~0x49     | 其他方式（预留）                            |
+---------------+---------------+---------------------------------------------+
| 充电启动失败  | 0x4A          | 充电启动失败，充电桩控制系统故障(需要重启或 |
|               |               | 自动恢复)                                   |
+---------------+---------------+---------------------------------------------+
| 充电启动失败  | 0x4B          | 充电启动失败，控制导引断开                  |
+---------------+---------------+---------------------------------------------+
| 充电启动失败  | 0x4C          | 充电启动失败，断路器跳位                    |
+---------------+---------------+---------------------------------------------+
```


```text
+---------------+---------------+---------------------------------------------+
|               | 0x4D          | 充电启动失败，电表通信中断                  |
+---------------+---------------+---------------------------------------------+
|               | 0x4E          | 充电启动失败，余额不足                      |
+---------------+---------------+---------------------------------------------+
|               | 0x4F          | 充电启动失败，充电模块故障                  |
+---------------+---------------+---------------------------------------------+
|               | 0x50          | 充电启动失败，急停开入                      |
+---------------+---------------+---------------------------------------------+
|               | 0x51          | 充电启动失败，防雷器异常                    |
+---------------+---------------+---------------------------------------------+
|               | 0x52          | 充电启动失败，BMS未就绪                     |
+---------------+---------------+---------------------------------------------+
|               | 0x53          | 充电启动失败，温度异常                      |
+---------------+---------------+---------------------------------------------+
|               | 0x54          | 充电启动失败，电池反接故障                  |
+---------------+---------------+---------------------------------------------+
|               | 0x55          | 充电启动失败，电子锁异常                    |
+---------------+---------------+---------------------------------------------+
|               | 0x56          | 充电启动失败，合闸失败                      |
+---------------+---------------+---------------------------------------------+
|               | 0x57          | 充电启动失败，绝缘异常                      |
+---------------+---------------+---------------------------------------------+
|               | 0x58          | 预留                                        |
+---------------+---------------+---------------------------------------------+
|               | 0x59          | 充电启动失败，接收BMS握手报文BHM超时        |
+---------------+---------------+---------------------------------------------+
|               | 0x5A          | 充电启动失败，接收BMS和车辆的辨识报文超时   |
|               |               | BRM                                         |
+---------------+---------------+---------------------------------------------+
|               | 0x5B          | 充电启动失败，接收电池充电参数报文超时BCP   |
+---------------+---------------+---------------------------------------------+
|               | 0x5C          | 充电启动失败，接收BMS完成充电准备报文超时   |
|               |               | BRO AA                                      |
+---------------+---------------+---------------------------------------------+
|               | 0x5D          | 充电启动失败，接收电池充电总状态报文超时BCS |
+---------------+---------------+---------------------------------------------+
|               | 0x5E          | 充电启动失败，接收电池充电要求报文超时BCL   |
+---------------+---------------+---------------------------------------------+
|               | 0x5F          | 充电启动失败，接收电池状态信息报文超时BSM   |
+---------------+---------------+---------------------------------------------+
|               | 0x60          | 充电启动失败，GB2015电池在BHM阶段有电压不允 |
|               |               | 许充电                                      |
+---------------+---------------+---------------------------------------------+
|               | 0x61          | 充电启动失败，GB2015辨识阶段在BRO_AA时候电  |
|               |               | 池实际电压与BCP报文电池电压差距大于5%       |
+---------------+---------------+---------------------------------------------+
|               | 0x62          | 充电启动失败，B2015 充电机在预充电阶段从    |
|               |               | BRO_AA 变成                                 |
|               |               | BRO_00状态                                  |
+---------------+---------------+---------------------------------------------+
|               | 0x63          | 充电启动失败，接收主机配置报文超时          |
+---------------+---------------+---------------------------------------------+
|               | 0x64          | 充电启动失败，充电机未准备就绪,我们没有回   |
|               |               | CRO AA，对应老国标                          |
+---------------+---------------+---------------------------------------------+
|               | 0x65~0x69     | （其他原因）预留                            |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x6A          | 充电异常中止，系统闭锁                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x6B          | 充电异常中止，导引断开                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x6C          | 充电异常中止，断路器跳位                    |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x6D          | 充电异常中止，电表通信中断                  |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x6E          | 充电异常中止，余额不足                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x6F          | 充电异常中止，交流保护动作                  |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x70          | 充电异常中止，直流保护动作                  |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x71          | 充电异常中止，充电模块故障                  |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x72          | 充电异常中止，急停开入                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x73          | 充电异常中止，防雷器异常                    |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x74          | 充电异常中止，温度异常                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x75          | 充电异常中止，输出异常                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x76          | 充电异常中止，充电无流                      |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x77          | 充电异常中止，电子锁异常                    |
+---------------+---------------+---------------------------------------------+
| 充电异常中止  | 0x78          | 预留                                        |
+---------------+---------------+---------------------------------------------+
|               | 0x79          | 充电异常中止，总充电电压异常                |
+---------------+---------------+---------------------------------------------+
|               | 0x7A          | 充电异常中止，总充电电流异常                |
+---------------+---------------+---------------------------------------------+
|               | 0x7B          | 充电异常中止，单体充电电压异常              |
+---------------+---------------+---------------------------------------------+
|               | 0x7C          | 充电异常中止，电池组过温                    |
+---------------+---------------+---------------------------------------------+
|               | 0x7D          | 充电异常中止，最高单体充电电压异常          |
+---------------+---------------+---------------------------------------------+
|               | 0x7E          | 充电异常中止，最高电池组过温                |
+---------------+---------------+---------------------------------------------+
|               | 0x7F          | 充电异常中止，BMV单体充电电压异常           |
+---------------+---------------+---------------------------------------------+
|               | 0x80          | 充电异常中止，BMT电池组过温                 |
+---------------+---------------+---------------------------------------------+
|               | 0x81          | 充电异常中止，电池状态异常停止充电          |
+---------------+---------------+---------------------------------------------+
|               | 0x82          | 充电异常中止，车辆发报文禁止充电            |
+---------------+---------------+---------------------------------------------+
|               | 0x83          | 充电异常中止，充电桩断电                    |
+---------------+---------------+---------------------------------------------+
|               | 0x84          | 充电异常中止，接收电池充电总状态报文超时    |
+---------------+---------------+---------------------------------------------+
|               | 0x85          | 充电异常中止，接收电池充电要求报文超时      |
+---------------+---------------+---------------------------------------------+
|               | 0x86          | 充电异常中止，接收电池状态信息报文超时      |
+---------------+---------------+---------------------------------------------+
|               | 0x87          | 充电异常中止，接收BMS中止充电报文超时       |
+---------------+---------------+---------------------------------------------+
|               | 0x88          | 充电异常中止，接收BMS充电统计报文超时       |
+---------------+---------------+---------------------------------------------+
|               | 0x89          | 充电异常中止，接收对侧CCS报文超时           |
+---------------+---------------+---------------------------------------------+
|               | 0x8A~0x8F     | （其他原因）预留                            |
+---------------+---------------+---------------------------------------------+
| 未知原因停止  | 0x90          | 未知原因停止                                |
+---------------+---------------+---------------------------------------------+
```



<a id="sec-41346516"></a>
## CRC16 校验的计算方法
    CRC（Cyclical Redundancy Check）由两字节组成，生成函数如下：

    1、CRC计算函数

    WORD ModbusCRC(BYTE * pData, BYTE len)

    {

    BYTE byCRCHi = 0xff;

    BYTE byCRCLo = 0xff;

    BYTE byIdx; WORD crc; while(len--) {

    byIdx = byCRCHi ^* pData++; byCRCHi = byCRCLo ^ gabyCRCHi[byIdx]; byCRCLo =
    gabyCRCLo[byIdx];

    } crc = byCRCHi; crc <<= 8; crc += byCRCLo; return crc;

    }



    CRC 码表高字节



    BYTE gabyCRCHi[] =

    {

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,

    0x00,0xc1,0x81,0x40,0x00,0xc1,0x81,0x40,0x01,0xc0,
    0x80,0x41,0x01,0xc0,0x80,0x41,0x00,0xc1,0x81,0x40,

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x00,0xc1,

    0x81,0x40,0x01,0xc0,0x80,0x41,0x01,0xc0,0x80,0x41,

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x00,0xc1,

    0x81,0x40,0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40,0x00,0xc1,0x81,0x40,

    0x01,0xc0,0x80,0x41,0x01,0xc0,0x80,0x41,0x00,0xc1,

    0x81,0x40,0x01,0xc0,0x80,0x41,0x00,0xc1,0x81,0x40,

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40,0x00,0xc1,0x81,0x40,

    0x01,0xc0,0x80,0x41,0x00,0xc1,0x81,0x40,0x01,0xc0,

    0x80,0x41,0x01,0xc0,0x80,0x41,0x00,0xc1,0x81,0x40,

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,

    0x00,0xc1,0x81,0x40,0x00,0xc1,0x81,0x40,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,

    0x01,0xc0,0x80,0x41,0x00,0xc1,0x81,0x40,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40,0x00,0xc1,0x81,0x40,

    0x01,0xc0,0x80,0x41,0x01,0xc0,0x80,0x41,0x00,0xc1,

    0x81,0x40,0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,

    0x00,0xc1,0x81,0x40,0x01,0xc0,0x80,0x41,0x01,0xc0,

    0x80,0x41,0x00,0xc1,0x81,0x40



    };



    CRC 码表低字节



    BYTE gabyCRCLo[] =

    {

    0x00,0xc0,0xc1,0x01,0xc3,0x03,0x02,0xc2,0xc6,0x06,

    0x07,0xc7,0x05,0xc5,0xc4,0x04,0xcc,0x0c,0x0d,0xcd,

    0x0f,0xcf,0xce,0x0e,0x0a,0xca,0xcb,0x0b,0xc9,0x09,

    0x08,0xc8,0xd8,0x18,0x19,0xd9,0x1b,0xdb,0xda,0x1a,

    0x1e,0xde,0xdf,0x1f,0xdd,0x1d,0x1c,0xdc,0x14,0xd4,

    0xd5,0x15,0xd7,0x17,0x16,0xd6,0xd2,0x12,0x13,0xd3,

    0x11,0xd1,0xd0,0x10,0xf0,0x30,0x31,0xf1,0x33,0xf3,

    0xf2,0x32,0x36,0xf6,0xf7,0x37,0xf5,0x35,0x34,0xf4,

    0x3c,0xfc,0xfd,0x3d,0xff,0x3f,0x3e,0xfe,0xfa,0x3a,

    0x3b,0xfb,0x39,0xf9,0xf8,0x38,0x28,0xe8,0xe9,0x29,

    0xeb,0x2b,0x2a,0xea,0xee,0x2e,0x2f,0xef,0x2d,0xed,

    0xec,0x2c,0xe4,0x24,0x25,0xe5,0x27,0xe7,0xe6,0x26,

    0x22,0xe2,0xe3,0x23,0xe1,0x21,0x20,0xe0,0xa0,0x60,

    0x61,0xa1,0x63,0xa3,0xa2,0x62,0x66,0xa6,0xa7,0x67,

    0xa5,0x65,0x64,0xa4,0x6c,0xac,0xad,0x6d,0xaf,0x6f,

    0x6e,0xae,0xaa,0x6a,0x6b,0xab,0x69,0xa9,0xa8,0x68,

    0x78,0xb8,0xb9,0x79,0xbb,0x7b,0x7a,0xba,0xbe,0x7e,

    0x7f,0xbf,0x7d,0xbd,0xbc,0x7c,0xb4,0x74,0x75,0xb5,

    0x77,0xb7,0xb6,0x76,0x72,0xb2,0xb3,0x73,0xb1,0x71,

    0x70,0xb0,0x50,0x90,0x91,0x51,0x93,0x53,0x52,0x92,

    0x96,0x56,0x57,0x97,0x55,0x95,0x94,0x54,0x9c,0x5c,

    0x5d,0x9d,0x5f,0x9f,0x9e,0x5e,0x5a,0x9a,0x9b,0x5b,

    0x99,0x59,0x58,0x98,0x88,0x48,0x49,0x89,0x4b,0x8b,

    0x8a,0x4a,0x4e,0x8e,0x8f,0x4f,0x8d,0x4d,0x4c,0x8c,

    0x44,0x84,0x85,0x45,0x87,0x47,0x46,0x86,0x82,0x42,

    0x43,0x83,0x41,0x81,0x80,0x40 };

<a id="sec-4ff224ca"></a>
## 协议需知
```text
+---------------+---------------------------------------------+---------------------------------------------+
| 序号          | 注意事项                                    | 如不满足要求的影响                          |
+---------------+---------------------------------------------+---------------------------------------------+
| 1             | 平台发起充电指令后，电桩需要在 90 秒内回复  | 平台会关闭此订单，如电桩继续充电则后续电量  |
|               | 平台成功并上送实时数据，且实时数据中桩的状  | 则无法计入此订单                            |
|               | 态必须是充电中。                            |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2             | 平台下发了充电指令，如果没收到电桩的回复或  | 平台会关闭此订单，如电桩继续充电则后续电量  |
|               | 者电桩回复启动失败，平台会认为此次启动失败  | 则无法计入此订单                            |
|               | ，电桩不得启动充电。                        |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3             | 在电桩启动或者充电中，平台下发了停充指令，  | 平台会关闭此订单，如电桩继续充电则后续电量  |
|               | 桩必须要停止充电。                          | 则无法计入此订单                            |
+---------------+---------------------------------------------+---------------------------------------------+
| 4             | 电桩在充电中则不得上送空闲状态，若实时数据  | 订单无法正常结算，并导致互联互通推  送的订  |
|               | 中有两帧为空闲，平台会把此单列为异常订单。  | 单费用明细丢失                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 5             | 在充电中如果可以拔枪，电桩需要立即上送交易  | 若其它用户插枪将直接充电，费用会算入第一个  |
|               | 记录，结束此单充电。                        | 用户的账上                                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 6             | 同一笔订单，鉴权后回复的流水号、实时数据中  | 平台订单无法结算或按错误的交易流水号进行结  |
|               | 的流水号、交易记录中的流水号必须保持一致。  | 算                                          |
+---------------+---------------------------------------------+---------------------------------------------+
| 7             | 在充电结束后的 30 秒内，电桩需要上送交易记  | 订单无法正常结算，并导致互联互通推送的订单  |
|               | 录到平台，如未上送，此单会进入异常订单。    | 费用明细丢失                                |
+---------------+---------------------------------------------+---------------------------------------------+
| 8             | 电桩上送的交易记录里的分时电量必须和平台的  | 订单计费错误，少扣费。                      |
|               | 计费模型一致。                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
```



