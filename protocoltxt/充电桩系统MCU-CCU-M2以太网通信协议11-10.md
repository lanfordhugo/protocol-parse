    充电桩系统内部模块通信协议V0.73













    版本记录

```text
+---------------+---------------------------------------------+---------------+---------------+
| 版本          | 更改说明                                    | 修改时间      | 修改人        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.1          | 新拟制                                      | 2023-11-20    | 胡帆          |
+---------------+---------------------------------------------+---------------+---------------+
| V0.2          | 1、帧头添加枪号，删除了报文中定义的枪号字段 | 2024-01-23    | 胡帆          |
+---------------+---------------------------------------------+---------------+---------------+
| V0.2.1        | 1、限制充电电量和限制充电功率修改倍率       | 2024-01-27    | 莫岚枫        |
|               | 2、Cmd5添加启动方式字段                     |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.2.2        | 1、调整cmd 枪状态上报字段定义               | 2024-03-20    | 莫岚枫        |
|               | 2、Cmd202增加枪实际输出电流字段，模块分配数 |               |               |
|               | 量字段                                      |               |               |
|               | 3、cmd111增加主机当前输出功率字段，增加2个  |               |               |
|               | 进风口，2个出风口温度字段                   |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.3          | 删除202报文                                 | 2024-3-26     | 胡帆          |
|               | 2、cmd201增加一些字段,合并到201             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.4          | 更新升级导日志和升级相关协议定义            | 2024-3-28     | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.5          | 增加5.3节，充电堆主机信息                   | 2024-5-15     | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.55         | 增加推送停止充电异常日志功能                | 2024-5-27     | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.56         | 1、共享模块协议cmd113定义                   | 2024-8-8      | 莫岚枫        |
|               | 2、共享模块状态cmd115描述优化               |               |               |
|               | 3、Cmd112模块状态报文增加模块温度定义       |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.57         | 1、cmd113,cmd115等协议定义不考虑之前兼容修  | 2024-8-9      | 莫岚枫        |
|               | 改                                          |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.61         | 1、增加液冷主机额外状态信息上报内容cmd121   | 2024-9-13     | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.62         | 1，增加终端自动化测试项目                   | 2024-9-26     | 冯沼棠        |
|               | 修改CMD605 增加cmd613                       |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.63         | 1，液冷2枪的电压采样                        | 2024-10-12    | 冯沼棠        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.64         | 1.Cmd611 前置条件2-驱动板通讯状态改为2字节  | 2024-10-28    | 冯沼棠        |
|               | 2.cmd605 测试结束枚举增加100，为了方便后续  |               |               |
|               | 扩展。                                      |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.65         | 增加cmd29-cmd36报文，应对有屏终端新功能     | 2024-11-09    | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.66         | 1.增加cmd37,MCU通知CCU鉴权结果              | 2024-11-18    | 莫岚枫        |
|               | 2.增加控制命令需要，通知CCU启动鉴权流程     |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.67         | 1.CCU增加液冷泵测试项目                     | 2024-11-20    | 冯沼棠        |
|               | 2.M2增加通信质量测试和模块输出线缆测试      |               |               |
|               | 3.611 测试结束枚举增加到100                 |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.68         | 1.启动充电增加停止密码下发字段              | 2024-11-27    | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.69         | 1、cmd201 增加并充相关字段                  | 2024-12-31    | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.70         | a. 液冷M2广播U2板接触器状态(cmd=120);       | 2024-03-24    | 刘龙          |
|               | b.M2广播液冷水泵及系统风扇信息(cmd=121);    |               |               |
|               | c. 主机半自动化工装控制指令（CMD=607）;     |               |               |
|               | d. 主机全自动工装模式下的实时回复数据       |               |               |
|               | (CMD=611);                                  |               |               |
|               | e. 主机状态2                                |               |               |
|               |                                             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.70         | cmd71 增加充电卡相关参数                    | 2024-05-20    | 刘昱          |
+---------------+---------------------------------------------+---------------+---------------+
| V0.71         | 增加对于终端外地tcu机型充电流程的明确，涉及 |               |               |
|               | 修改cmd35                                   |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.72         | cmd111 增加维护模式状态位广播               |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.73         | 增加6.光储充报文定义                        | 2025-06-24    | 覃思维        |
|               | 在1.1.设备类型及IP地址定义中，增加UDP广播地 |               |               |
|               | 址                                          |               |               |
|               | 在1.2.报文格式中，增加设备类型7和8;设备地址 |               |               |
|               | 中,增加0x31:GATEWAY地址                     |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V0.74         | 增加客户设备组网ip分配规范                  | 2025-08-14    | 莫岚枫        |
+---------------+---------------------------------------------+---------------+---------------+
| V0.75         | Cmd111 增加模块利用率，功率利用率，功率满足 | 2025-08-27    | 冯沼棠        |
|               | 率，                                        |               |               |
+---------------+---------------------------------------------+---------------+---------------+
```




    目录

    充电桩系统内部模块通信协议V0.73	I

    1. 网络拓扑	1

    1.1. 设备类型及IP地址定义	1

    1.2. 报文格式	2

    1.3. 数据格式	4

    1.4. 通信报文及周期：	4

    1.5. 组网路由拓扑：	5

    2. 通信协议--充电管理数据(TCP)	5

    2.1. MCU-CCU:充电管理数据(TCP)	5

    2.1.1. 注册帧（cmd=1）	5

    2.1.2. 注册回复帧（cmd=2）	6

    2.1.3. CCU状态信息（cmd=3）	7

    2.1.4. 服务器心跳包（cmd=4）	8

    2.1.5. 启动充电（cmd=5）	8

    2.1.6. 启动充电回复(cmd=6)：	9

    2.1.7. 停止充电（cmd=7）	10

    2.1.8. 停止充电回复(cmd=8)：	10

    2.1.9. 充电启动结果（cmd=9）	10

    2.1.10. 启动充电结果应答（cmd=10）	13

    2.1.11. 充电中BMS报文（cmd=11）	13

    2.1.12. 预留cmd12	13

    2.1.13. 充电结束报文（cmd=13）	13

    2.1.14. 充电结束报文应答(cmd=14)	15

    2.1.15. CCU主动推送充电结束异常日志（cmd=15）	15

    2.1.16. 应答CCU主动推送充电结束异常日志（cmd=16）	16

    2.1. MCU-CCU参数设置(TCP)	16

    2.1.1. 整形参数设置(CMD=21)	16

    2.1.2. 整形参数设置应答(CMD=22)	16

    2.1.3. 整形参数表查询(CMD=23)	17

    2.1.4. 整形参数表查询应答(CMD=24)	17

    2.1.5. CCU主动推送参数信息(CMD=25)	17

    2.1.6. MCU应答CCU推送参数信息(CMD=26)	17

    2.1.7. MCU主动推送参数信息(CMD=27)	18

    2.1.8. CCU应答MCU推送参数信息(CMD=28)	18

    2.1.9. 字符参数设置(CMD=29)	18

    2.1.10. 字符参数设置应答(CMD=30)	19

    2.1.11. MCU下发计费模型(CMD=31)	19

    2.1.12. CCU费率模型应答(CMD=32)	20

    2.1.13. MCU下发结算信息(CMD=33)	20

    2.1.14. CCU应答结算信息(CMD=34)	20

    2.1.15. CCU请求主动充电(CMD=35)	21

    2.1.16. MCU应答主动请求充电(CMD=36)	22

    2.1.17. CCU主动上传VIN充电失败信息(CMD=37)	22

    5. M2-MCU:点对点数据(UDP=5XX)	23

    2.1.18. M2注册帧（cmd=51）	23

    2.1.19. 注册回复帧（cmd=52）	24

    2.1.20. 参数请求同步（cmd=53）	24

    2.1.21. 参数请求同步应答（cmd=54）	25

    2.1.22. MCU-M2整形参数设置(CMD=55)	25

    2.1.23. M2-MCU整形参数设置应答(CMD=56)	25

    2.1.24. MCU请求获取模块详细状态(cmd=57)	26

    2.1.25. M2应答模块详细状态信息(cmd=58)	26

    2.2. 公共UDP报文(点对点)	27

    2.2.1. 控制命令（cmd=71）	27

    2.2.2. 控制命名应答(cmd=72)	27

    3. CCU-M2-MCU:广播数据(UDP)	28

    3.1. MCU-S-V8广播数据	28

    3.1.1. mcu广播自己的状态信息或者设置通用参数（cmd=100）	28

    3.2. M2-S-V8广播数据	29

    3.2.1. M2广播当前状态数据（cmd=111）	29

    3.2.2. M2广播当前所有模块的状态信息数据（cmd=112）	31

    3.2.3. M2广播C3板接触器共享模块状态(cmd=113)	33

    3.2.4. M2广播M1板状态继电器共享模块状态(cmd=)(接触器机型目前无须关注)	34

    3.2.5. M2广播模块版本信息(cmd=114)	35

    3.2.6. M2广播接触器共享模块状态信息(cmd=115)	36

    3.2.7. 液冷M2广播U2板接触器状态(cmd=120)	36

    3.2.8. M2广播液冷水泵及系统风扇信息(cmd=121)	38

    3.3. CCU-S-V8广播数据-核心功能(CMD=20X)	39

    3.3.1. CCU-V8当前充电枪的实时状态(CMD=201)	39

    3.3.2. CCU-V8当前充电枪的液冷实时状态(CMD=202)	41

    3.3.3. CCU-V8状态需求短报文(CMD=203)	42

    3.4. CCU-C-V8广播数据(CMD=22X)	43

    3.4.1. CCU广播当前所有模块的状态信息数据（221）	43

    3.4.2. CCU广播模块版本信息(cmd=222)	45

    3.5. CCU-S-V8广播数据-附加功能(CMD=3XX)	45

    3.5.1. CCU-V8 主机允许进入并枪的辅枪信息(CMD=301)	45

    3.5.2. CCU-MCU 并枪的副枪信息(CMD=302)	46

    3.5.3. CCU-V8 并充订单信息（CCU-MCU-点对点）(CMD=303)	47

    4. 充电桩维护报文	50

    4.1. CCU(M2) --- MCU:日志上传	50

    4.1.1. 日志文件请求指令下发（cmd=401）	50

    4.1.2. 日志文件请求指令回复（cmd=402）	51

    4.1.3. 日志文件上传状态（cmd=403）	51

    4.2. CCU(M2)--- MCU:在线升级	52

    4.2.1. 在线升级指令下发（cmd=411）	54

    4.2.2. 在线升级指令应答(cmd=412)	55

    4.2.3. 在线升级状态上报(cmd=413)	56

    4.2.4. 在线升级复位指令下发(cmd=415)	57

    4.2.5. 在线升级复位指令回复(cmd=416)	57

    4.3. CCU(M2) - OTHER:日志打印或者其他TCP服务(telnet暂时不做)	57

    4.4. CCU(M2)--- MCU:隐私点对点数据(UDP)（暂时不做）	58

    5. MCU-CCU,MCU-M2工装调试数据(CMD=6XX，点对点UDP)	58

    5.1. MCU-CCU,MCU-M2工装调试数据(CMD=60x-63x)	58

    5.1.1. 终端启动或者退出工装流程(CMD=601)	58

    5.1.2. 设备响应工装控制指令（cmd=602）	59

    5.1.3. 终端半自动化工装控制指令(CMD=603)	59

    5.1.4. 终端全自动工装模式下的实时状态数据(CMD=605)	61

    5.1.5. 终端全自动工装模式下的实时状态数据回复(CMD=606)	63

    5.1.6. 主机半自动化工装控制指令（CMD=607）	63

    5.1.7. 主机半自动化工装控制指令应答（CMD=608）	64

    5.1.8. 主机全自动化工装控制指令（CMD=609）	65

    5.1.9. 主机响应全自动工装控制指令（cmd=610）	65

    5.1.10. 主机全自动工装模式下的实时回复数据(CMD=611)	66

    5.1.11. 全自动工装模式下的实时状态数据回复(CMD=612)	68

    5.1.12. 终端全自动工装模式下的33008实时状态数据(CMD=613)	68

    6. 光储充报文	70

    6.1. GateWay-MCU-M2:广播数据（UDP）	70

    6.1.1. GateWay广播储能电池状态信息（cmd=701）	70

    6.1.2. GateWay广播储能单体信息（cmd=702）	74

    6.1.3. GateWay广播储能单体电压信息（cmd=703）	75

    6.1.4. GateWay广播储能单体温度信息（cmd=704）	75

    6.1.5. GateWay广播储能极柱详细信息（cmd=705）	76

    6.1.6. GateWay广播储能柜空调累计信息（cmd=706）	77

    6.1.7. GateWay广播储能累计信息（cmd=707）	77

    6.2. M2-MCU:广播数据（UDP）	78

    6.2.1. M2广播光伏状态信息（cmd=801）	78

    6.2.2. M2广播光伏单通道详细信息(cmd=802)	79

    6.2.3. M2广播光伏累计信息（cmd=803）	79

    6.2.4. M2广播系统功率路由状态(cmd=804)	79

    6.2.5. M2广播电网时段调度策略(cmd=805)	81

    6.3. M2-MCU-GATEWAY:点对点数据（UDP）	83

    6.3.1. MCU应答请求(cmd=901)	83

    6.3.2. M2/GATEWAY请求MCU下发指令(902)	83

    6.3.3. MCU请求数据同步指令(cmd=903)	83

    6.3.4. M2/GATEWAY应答MCU数据同步请求(cmd=904)	83

    6.3.5. MCU-M2,MCU下发电网时段调度策略(cmd=905)	83

    6.3.6. M2-MCU,M2应答电网时段调度策略(cmd=906)	85

    6.3.7. MCU-M2,MCU下发光储充工作模式设置(cmd=907)	85

    6.3.8. M2-MCU,M2应答光储充放工作模式设置(cmd=908)	87

    6.3.9. MCU应答gateway注册请求(cmd=909)	87

    6.3.10. GateWay版本注册帧（cmd=910）	88

    附录1：主机状态	88




<a id="sec-fb75ba7f"></a>
# 网络拓扑
<a id="sec-1303700f"></a>
## 设备类型及IP地址定义
```text
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| 设备类型                     | 设备名称/服务作用            | 设备IP地址                                  | 服务器监听端  | 作用                         |
|                              |                              |                                             | 口            |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| SMCU-V8                      | 主机MCU                      | 192.168.101.100                             | Tcp=10000     | 主机MCU对CCU的TCP服务        |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| SMCU-V8                      | 主机MCU                      | 192.168.101.100                             | Tcp=10300     | 主机MCU对屏幕进程服务        |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| CMCU-V8                      | 终端MCU(有屏）               | 192.168.101.101~192.168.101.128             | Tcp=10001     |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
|                              |                              |                                             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| M2-V8                        | 功率控制板M2                 | 192.168.101.200                             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| CCU-V8                       | 终端双枪CCU                  | 192.168.101.201~192.168.101.228             | tcp=5000      |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
|                              |                              |                                             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| SECC-PLC                     | 欧标SECC                     | 192.168.151.201~192.168.101.178             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
|                              |                              |                                             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| 其他需要组网设备             | 例如客户监控网关             | 192.168.101.10-192.168.101.19               | 任意          |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
|                              |                              |                                             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
|                              |                              |                                             |               |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
| FTP-S                        | MCU的FTP服务器               | 192.168.101.100                             | 21            |                              |
+------------------------------+------------------------------+---------------------------------------------+---------------+------------------------------+
```


    UDP广播地址为：192.168.101.255

```text
+---------------+------------------------------+------------------------------+---------------+
| UDP发送方     | 接收方                       | 主要报文类型                 | 端口          |
+---------------+------------------------------+------------------------------+---------------+
| MCU           | M2、CCU                      | MCU心跳和时间                | 11000         |
+---------------+------------------------------+------------------------------+---------------+
| CCU           | 全网广播 M2、MCU接收         | 需求电压电流、状态           | 11000         |
+---------------+------------------------------+------------------------------+---------------+
| M2            | MCU                          | 模块分配信息                 | 11000         |
+---------------+------------------------------+------------------------------+---------------+
| GateWay       | MCU、M2                      | 光储充数据                   | 12000         |
+---------------+------------------------------+------------------------------+---------------+
| M2            | MCU、GateWay                 | 光储充数据                   | 12000         |
+---------------+------------------------------+------------------------------+---------------+
```



<a id="sec-453f47c2"></a>
## 报文格式
    本通信协议中使用到得报文格式，见表所示。

```text
+---------------+---------------+------------------------------+---------------------------------------------+
| 字节名称      | 字段长度      | 字段内容                     | 备注                                        |
+---------------+---------------+------------------------------+---------------------------------------------+
| 起始域        | 2 (字节)      | 0xAA0xF5                     | 固定为 0xAA0xF5                             |
+---------------+---------------+------------------------------+---------------------------------------------+
| 长度域        | 2 (字节)      | 0～0x8000                    | 起始域到校验和域整个报文长度                |
+---------------+---------------+------------------------------+---------------------------------------------+
| 命令代CMD     | 2 (字节)      | 消息类型                     | 即消息类型，代表不同功能要求                |
+---------------+---------------+------------------------------+---------------------------------------------+
| 报文序号      | 2）（字节）   | 0~0xFFFF                     | 不停累加                                    |
+---------------+---------------+------------------------------+---------------------------------------------+
| 设备类型      | 1 (字节)      | 1-MCU-S-V8                   | 表示当前报文发出的设备类型                  |
|               |               | 2-M2-V8                      |                                             |
|               |               | 3-CCU-V8                     |                                             |
|               |               | 4-MCU-C-V8                   |                                             |
|               |               | 5-单枪液冷CCU-V8             |                                             |
|               |               | 6-双枪液冷CCU-V8             |                                             |
|               |               | 7-GateWay-MCU(EMS)-M2        |                                             |
|               |               | 8-M2-MCU(EMS)                |                                             |
|               |               | 9-SECC-PLC                   |                                             |
+---------------+---------------+------------------------------+---------------------------------------------+
| 设备地址      | 1 (字节)      | 1～0xff                      | 1-14:CCU地址/SECC地址                       |
|               |               |                              | 0x21:M2地址                                 |
|               |               |                              | 0x31:GATEWAY地址                            |
|               |               |                              | MCU发送的报文是目标地址                     |
+---------------+---------------+------------------------------+---------------------------------------------+
| 枪号          | 1(字节)       | 终端枪号                     | 1-A枪   2-B枪                               |
|               |               |                              | 0xFF:表示所有终端                           |
|               |               |                              | 无须区分枪号的设备总是填充0                 |
|               |               |                              | MCU发送的报文是目标枪号                     |
+---------------+---------------+------------------------------+---------------------------------------------+
| 数据域        | N (字节)      | 业务数据                     |                                             |
+---------------+---------------+------------------------------+---------------------------------------------+
| 校验和域      | 2 (字节)      | 后16位                       | 按两个字节按小端格式累计计算和校验值，奇数  |
|               |               |                              | 长度最后一个字节补0，并取校验和的低16位，计 |
|               |               |                              | 算范围包含从命令代码和数据域                |
+---------------+---------------+------------------------------+---------------------------------------------+
```


    备注:

    液冷双枪终端需要占用2个通道地址，如5号终端CCU（地址5）双液冷，因为液冷需要
    A/B面共接一个通道上，所以一个双液冷的终端需要主机上的4个枪通道。其CCU地址6需
    要空置出来不能使用,MCU和M2板都需要做下特殊处理。

    液冷CCU-5（终端）-1（枪）接：主机5A\5B枪

    液冷CCU-5（终端）-2（枪）接：主机6A\6B枪



<a id="sec-44f68d95"></a>
## 数据格式
    通信协议中数据格式定义如表2_1所示。

```text
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 数据类型      | 比例因子      | 范围(实际量程)                              | 偏移量        | 字节数        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 容量/电量     | 1AH/bit       | 0 - 65535                                   | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电压          | 0.1V/bit      | 0 - 10000                                   | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电流          | 0.1A/bit      | -32768 – 32768(-3276.8 – 3276.8)          | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 单体电池电压  | 0.01V/bit     | 0 - 4095（ 0 - 40.95 )                      | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电池SOC       | 1%/bit        | 0 - 100（ 0 - 100%)                         | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 温度          | 1℃/bit       | 偏移量-50，-50 - 200                        | 0             | 1BYTE         |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 箱号（组号)   | 1/bit         | 0 - 255                                     | 0             | 1BYTE         |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 箱内位置      | 1/bit         | 0 - 255                                     | 0             | 1BYTE         |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电度数        | 0.001kWh/bit  | 0 - 65535*65535                             | 0             | 4BYTE         |
|               |               |                                             |               |               |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 功率          | 0.1KW/bit     | 0 - 65535 (0 - 6000)                        | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 金额          | 0.0001元/bit  | 0 - 65535*65535                             | 0             | 4 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 费率          | 0.0001元/度   | 0 - 65535*65535                             | 0             | 4 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
```

    表2_ 1 通信协议中的数据格式


<a id="sec-fcfef4a3"></a>
## 通信报文及周期：
    规定主动发起的报文号为奇数，应答的报文号为偶数

```text
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 发送方        | 接收方        | 消息名称      | 消息命令      | 传输协议      | 发送周期      | 发送和停止说  |
|               |               |               |               |               |               | 明            |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 1             | TCP           | /             |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 2             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 3             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 4             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 5             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 7             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 8             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 9             |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 10            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 11            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 12            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 13            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 14            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 21            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 22            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 23            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 24            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
|               |               |               | 25            |               |               |               |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
```

<a id="sec-0a7d4720"></a>
## 组网路由拓扑：

<a id="sec-8a16c3f5"></a>
# 通信协议--充电管理数据(TCP)
<a id="sec-c1c4ee6e"></a>
## MCU-CCU:充电管理数据(TCP)
<a id="cmd-001"></a>
### 注册帧(cmd=1) [cmd=001]
    CCU上电，建立网络连接后，立刻发送注册帧到服务器。

    CCU收到服务器应答后，需要更新所有接收到的参数信息，并写flash保存。

    服务器收到注册帧后，填充所有参数信息，并立即回复。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 硬件类型      | 1             | 01：CCU                      |
|               |               |               | 02：M2板                     |
|               |               |               | 03：超充驱动板CCU            |
+---------------+---------------+---------------+------------------------------+
| 2             | 拨码地址号    | 1             | 有效范围1-32                 |
+---------------+---------------+---------------+------------------------------+
| 3             | 充电枪路数    | 1             | 默认：2                      |
+---------------+---------------+---------------+------------------------------+
| 4             | 项目号        | 2             | 0x000028AA代表项目类型10410  |
+---------------+---------------+---------------+------------------------------+
| 5             | 软件版本号    | 2             | 0x000028AA代表版本号V 104.10 |
+---------------+---------------+---------------+------------------------------+
| 6             | 需要更新参数  | 1             | 0:  需要（默认需要更新一次） |
|               | 表            |               | 1:  不需要                   |
+---------------+---------------+---------------+------------------------------+
| 7             | 软件编译时间  | 32            | ASCII字符串                  |
+---------------+---------------+---------------+------------------------------+
| 9             | 硬件版本      | 2             | 0x000028AA代表版本号V 104.10 |
+---------------+---------------+---------------+------------------------------+
| 10            | 协议版本号    | 2             | 0x0044 代表v0.68             |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-002"></a>
### 注册回复帧(cmd=2) [cmd=002]
```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 登录结果      | 1             | 0：正常使用                  |
|               |               |               | 1：禁止使用                  |
+---------------+---------------+---------------+------------------------------+
| 2             | 登录失败原因  | 1             | 1：版本号过低                |
|               |               |               | 2：系统故障                  |
|               |               |               | 3：其他故障                  |
+---------------+---------------+---------------+------------------------------+
| 3             | MCU软件项目号 | 2             | 0x000028AA代表版本号V 104.10 |
+---------------+---------------+---------------+------------------------------+
| 4             | MCU软件版本号 | 2             | 0x000028AA代表项目类型10410  |
+---------------+---------------+---------------+------------------------------+
| 5             | 终端类型      | 1             | 1：单枪250A                  |
|               |               |               | 2：双枪250A                  |
|               |               |               | 3：单枪400A                  |
|               |               |               | 4：双枪400A                  |
|               |               |               | 5：液冷单枪                  |
|               |               |               | 6：液冷双枪                  |
|               |               |               | 7：单枪一体机                |
|               |               |               | 8：双枪一体机                |
+---------------+---------------+---------------+------------------------------+
| 6             | 终端桩编码    | 32            | 编号                         |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-003"></a>
### CCU状态信息(cmd=3) [cmd=003]
    1、充电桩按枪规定周期发送此信息上报充电桩当前工作状态信息。

    2、变化立刻发送，状态改变定义为，插枪、工作状态、终端系统状态、枪相关状态改
    变，此时需要发送一次报文更新数据。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 本终端枪数                   | 1             | 1-单枪 2-双枪                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 车连接状态                   | 1             | 0-断开 / 1-连接                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | CC1电压                      | 2             | 0.1V/Bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 枪工作状态                   | 1             | 0-空闲中                                    |
|               |                              |               | 1-正准备开始充电                            |
|               |                              |               | 2-充电进行中                                |
|               |                              |               | 3-充电结束（未拔枪保持）                    |
|               |                              |               | 4-启动失败（未进入充电中，未拔枪保持）      |
|               |                              |               | 5-预约状态                                  |
|               |                              |               | 6-系统故障(不能给汽车充电)                  |
|               |                              |               | 7-暂停服务                                  |
|               |                              |               | MCU未关注此状态                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 当前枪最高告警编码           | 4             | 此字段作废未使用                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 终端系统状态                 | 2             | Bit1-门禁状态 0-关闭 1-打开                 |
|               |                              |               | Bit2-急停状态 0-正常 1-按下                 |
|               |                              |               | Bit3-中间接触器状态  0-断开，1-闭合         |
|               |                              |               | Bit4-风扇状态  0-待机，1-工作               |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 枪状态                       | 2             | Bit1-枪锁状态 0-解锁 1-上锁                 |
|               |                              |               | Bit2-枪归位   0-归位 1-未归位               |
|               |                              |               | Bit3-直流接触器状态(正) 0-断开，1-闭合      |
|               |                              |               | Bit4 直流接触器状态(负) 0-断开，1-闭合      |
|               |                              |               | Bit5-BMS辅电开关状态  0-未供电，1-已供电    |
|               |                              |               | Bit6-辅源类型  0-12V，1-24V                 |
|               |                              |               | Bit7-绝缘状态   0-空闲，1-检测中            |
|               |                              |               | Bit8-充放电模式    0-充电 1-放电            |
|               |                              |               |                                             |
|               |                              |               | Bit9-工装检测状态  0-未检测  1-检测中       |
|               |                              |               | Bit10 熔断器状态(预留)                      |
|               |                              |               | Bit11 自动启动中 0-未启动 1-启动中          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 出风口温度                   | 1             | 偏移量-50，-50 - 200℃                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 环境温度                     | 1             | 偏移量-50，-50 - 200℃                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 枪正极温度                   | 1             | 偏移量-50，-50 - 200℃                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 枪负极温度                   | 1             | 偏移量-50，-50 - 200℃                      |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-004"></a>
### 服务器心跳包(cmd=4) [cmd=004]
    1、

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 当前时间                     | 4             | UNIT                         |
+---------------+------------------------------+---------------+------------------------------+
| 2             | MCU 1枪告警状态              | 8             | MCU告警表状态，参考附录      |
+---------------+------------------------------+---------------+------------------------------+
| 3             | MCU 2枪告警状态              | 8             | MCU告警表状态，参考附录      |
+---------------+------------------------------+---------------+------------------------------+
| 4             | MCU对枪的禁用状态            | 4             | Bit0-bit27 有效              |
|               |                              |               | 0-正常状态                   |
|               |                              |               | 1-禁用状态                   |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="cmd-005"></a>
### 启动充电(cmd=5) [cmd=005]
    1、MCU向CCU发送开始充电控制命令

    2、当MCU下发VIN核对时，CCU需要再BRO阶段校验车辆VIN码，如果不匹配，需要停机。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 命令序号                     | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |                              |               | 命令共用序号，重发保持不变                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 启动方式                     | 1             | 正常启动                                    |
|               |                              |               | VIN方式启动                                 |
|               |                              |               | 启动放电                                    |
|               |                              |               | 刷卡启动                                    |
|               |                              |               | 4-管理员界面启动                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 限制SOC                      | 1             | 表示不限制                                  |
|               |                              |               | 范围1-100/大于100-不限制                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 限制充电电量                 | 2             | 表示不限制                                  |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 限功率大小                   | 2             | 0：不限制                                   |
|               | （订单结束后失效）           |               | 0.1kw/bit                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | BMS辅源电压                  | 1             | 0x12：0-12V；                               |
|               | （订单结束后失效）           |               | 0x24：24V。仅当前充电有效，当前充电完成恢复 |
|               |                              |               | 为充电机系统设置值                          |
|               |                              |               | 其他值---按桩上设置的默认辅助电源处理       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 订单流水号                   | 32            | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | VIN核对                      | 1             | 无效                                        |
|               |                              |               | 需要核对                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 车辆VIN码                    | 17            | CCU用于在BRO阶段校验车辆VIN码的字符（用于即 |
|               |                              |               | 插即冲）                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 停止充电密码                 | 16            | 停止充电密码-ASCII                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 并充组网状态                 | 1             | 0-标准模式各枪独立工作                      |
|               |                              |               | 1-单终端/机柜并充组网                       |
|               |                              |               | 2-多终端/机柜并充组网                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 组网枪数量                   | 1             | 1-255                                       |
|               |                              |               | 单充发0                                     |
|               |                              |               | 并充发送组网副枪数量                        |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-006"></a>
### 启动充电回复(cmd=6)： [cmd=006]
    CCU应答MCU下发的充电桩启动充电控制报文应答。

    当命令执行结果为成功时，忽略执行失败原因。

    当命令执行结果为失败时，未定义的失败原因也是表示失败。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与命令5发送一样表示对该命令序号的应答   |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 命令执行结果  | 1             | 0：表示成功                                 |
|               |               |               | 其他表示失败，失败时再看字段3               |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 执行失败原因  | 2             | 失败的原因待补充                            |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-007"></a>
### 停止充电(cmd=7) [cmd=007]
    充电桩下发停止充电指令

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号                                |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 停止原因      | 2             | 见附录                                      |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-008"></a>
### 停止充电回复(cmd=8)： [cmd=008]
    充电桩对后台下发的充电桩开启充电控制报文应答

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与命令7发送一样表示对该命令序号的应答   |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 命令执行结果  | 1             | 0：表示成功                                 |
|               |               |               | 其他表示失败                                |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 执行失败原因  | 1             | 失败的原因待补充                            |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-009"></a>
### 充电启动结果(cmd=9) [cmd=009]
    CCU在完成充电启动后，向MCU发送启动充电完成状态信息

    MCU接收到cmd10后，不再发送cmd9,如果CCU没有应答cmd10，需要按指定周期重复发送
    10次，重发的cmd9命令序号维持不变。

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1             | 命令序号                                    | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |                                             |               | 命令共用序号，重发保持不变                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2             | 启动结果                                    | 2             | 启动成功                                    |
|               |                                             |               | 启动失败，失败原因见附录1充电结束原因列表   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3             | BMS协议类型                                 | 2             | 协议类型                                    |
|               |                                             |               | 0x2011-2011旧国标                           |
|               |                                             |               | 0x2015-2015国标                             |
|               |                                             |               | 0x2023-2023国标                             |
|               |                                             |               | 0x2016-2015+国标                            |
|               |                                             |               | 0x1000-广州团标                             |
|               |                                             |               | 0x1001-特来电大电流                         |
|               |                                             |               | 0x1002-宇通协议                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4             | 充电桩与 BMS 通信协议版本号                 | 3             | 遵循 27930  最新协议标准                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5             | BMS 与充电桩通信协议版本号                  | 3             | 遵循 27930  最新协议标准                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6             | 充电机最高输出电压                          | 2             | 控制板配置参数                              |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7             | 充电机最低输出电压                          | 2             | 控制板配置参数                              |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8             | 充电机最大输出电流                          | 2             | 控制板配置参数                              |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9             | BHM-绝缘电压                                | 2             | 0.1V/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 10            | BRM-电池类型                                | 1             | 电池类型：                                  |
|               |                                             |               | 0x01-铅酸电池，                             |
|               |                                             |               | 0x02-镍氢电池,                              |
|               |                                             |               | 0x03-磷酸铁锂电池,                          |
|               |                                             |               | 0x04-锰酸锂电池,                            |
|               |                                             |               | 0x05-钴酸锂电池,                            |
|               |                                             |               | 0x06-三元次料电池,                          |
|               |                                             |               | 0x07-聚合物锂离子电池,                      |
|               |                                             |               | 0x08-钛酸锂电池,                            |
|               |                                             |               | 0xff-其他电池                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 11            | BRM-整车动力蓄电池系统额定容量/Ah           | 2             | 精度：0.1Ah/bit                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 12            | BRM-整车动力蓄电池系统额定总电压/V          | 2             | 精度：0.1V/bit                              |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 13            | BRM-电池生产厂商                            | 4             | 电池厂商名称，标准ASCII                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 14            | BRM-电池组序号                              | 4             | 电池厂商自定义                              |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 15            | BRM-电池组生厂日期：年                      | 2             | 如0x07 0xdf表示2015                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 16            | BRM-电池组生厂日期：月                      | 1             | 如0x01表示1月                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 17            | BRM-电池组生厂日期：日                      | 1             | 如0x01表示1号                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 18*           | BRM-电池组充电次数                          | 4             | 以BMS统计为准                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 19*           | BRM-电池组产权标识                          | 1             | 遵循 27930  最新协议标准                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 20*           | 预留                                        | 1             | 同27930保持一致                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 21*           | BRM-车辆识别码vin                           | 17            | 不限定ASCII,支持车车辆自定义上传，透传      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 22*           | BRM-BMS软件版本号                           | 8             | Byte1表示版本流水号：0x01~0xfe；            |
|               |                                             |               | byte2表示日：0x01表示1日；                  |
|               |                                             |               | byte3：0x01表示1月；                        |
|               |                                             |               | byte4和byte5表示年:0x07 0xdf表示2015年；    |
|               |                                             |               | Byte6和byte7、byte8预留，填0xffffff         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 23            | BCP-单体动力蓄电池最高允许充电电压          | 2             | 根据分辨率：0.1A位，数据范围：0-24V         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 24*           | BCP-最高允许充电电流                        | 2             | 分辨率：0.1A/位                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 25*           | BCP-动力蓄电池标称总能量                    | 2             | 分辨率：0.1kw.h，范围0-1000kw.h             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 26*           | BCP-最高允许充电总电压                      | 2             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 27*           | BCP-最高允许温度                            | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 28*           | BCP-整车动力蓄电池荷电状态                  | 2             | 分辨率：0.1，0-100 %                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 29*           | BCP-整车动力蓄电池当前电池电压              | 2             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 30*           | BRO-BMS是否充电准备好                       | 1             | 0x00-表示未做好充电准备，0xaa表示BMS完成充  |
|               |                                             |               | 电准备，0xff表示无效                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 31*           | 绝缘电压异常时模块电压值                    | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 32            | 主枪绝缘设置电压                            | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 33            | 主枪绝缘正电阻(无符号)                      | 2             | 1Ω/bit                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 34            | 主枪绝缘负电阻(无符号)                      | 2             | 1Ω/bit                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 35            | 主枪第一次绝缘正电压                        | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 36            | 主枪第一次绝缘负电压                        | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 37            | 主枪第二次绝缘正电压                        | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 38            | 主枪第二次绝缘负电压                        | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 39            | 主枪预启动枪头电压                          | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 40            | 主枪预启动模块电压                          | 2             | 0.1v/bit                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 41            | BCP异常电压1                                | 2             | 0.1v/bit                                    |
|               |                                             |               | 产生BCP电压异常的前一时刻前2秒枪电压  (控制 |
|               |                                             |               | 板采集)                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 42            | BCP异常电压2                                | 2             | 产生BCP电压异常的前一时刻枪电压  (控制板采  |
|               |                                             |               | 集)                                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
|               |                                             |               |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-010"></a>
### 启动充电结果应答(cmd=10) [cmd=010]
    回复CCU主动上送的启动充电完成报文。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与cmd9发送一样，表示对该命令序号的应答  |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 确认结果      | 1             | 0--成功  1--失败                            |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-011"></a>
### 充电中BMS报文(cmd=11) [cmd=011]
    CCU需要按指定周期发送BMS报文，字段剩余字节填充0xFF

    本地启动，不要发送这个一帧报文。

    刚启动周期1s，持续30s，稳定充电后周期10s,处于停止阶段周期1s直到停止充电后停
    止发送。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | BCS报文       | 16            | 遵循 27930  最新协议标准     |
+---------------+---------------+---------------+------------------------------+
| 2             | BSM报文       | 8             | 遵循 27930  最新协议标准     |
+---------------+---------------+---------------+------------------------------+
```

<a id="sec-48c9c5a7"></a>
### 预留cmd12
<a id="cmd-013"></a>
### 充电结束报文(cmd=13) [cmd=013]
    CCU在充电结束时，主动上传充电结束报文给主机MCU。

    MCU回复cmd13后，CCU不再发送cmd14。

    如果MCU没有回复，需要周期1s重复发送20次，重发的cmd14命令序号维持不变。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 停止充电原因  | 2             | 参见附录1                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 充电电量      | 4             | 0.001kWh/bit                                |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 开始电表电量  | 4             | 0.001kWh/bit 只是主枪的                     |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 结束电表电量  | 4             | 0.001kWh/bit 只是主枪的                     |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 开始SOC       | 1             | 0-100                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 结束SOC       | 1             | 0-100                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 8             | 停止参数1     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 9             | 停止参数2     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 10            | 停止参数3     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 11            | 停止参数4     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 12            | 停止参数5     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 13            | 停止参数6     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 14            | 停止参数7     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 15            | 停止参数8     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 16            | BST报文       | 8             | 遵循 27930  最新协议标准                    |
+---------------+---------------+---------------+---------------------------------------------+
| 17            | BSD报文       | 8             | 遵循 27930  最新协议标准                    |
+---------------+---------------+---------------+---------------------------------------------+
| 18            | BEM报文       | 8             | 遵循 27930  最新协议标准                    |
+---------------+---------------+---------------+---------------------------------------------+
| 19            | 充放电标志    | 1 Byte        | 0-充电                                      |
|               |               |               | 1-放电                                      |
+---------------+---------------+---------------+---------------------------------------------+
| 20            | 瑞银电表标志  | 1 Byte        | BIT0 0:没有电表表号、加密数据字段           |
|               |               |               | BIT0 1:有电表表号、加密数据字段             |
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 21            | 加密数据      | 34 Byte       | 瑞银电表加密数据                            |
+---------------+---------------+---------------+---------------------------------------------+
| 22            | 电表表号      | 6 Byte        | 瑞银电表表号BCD码                           |
+---------------+---------------+---------------+---------------------------------------------+
| 23            | 电表协议版本  | 2 Byte        | 瑞银电表通讯协议版本号(HEX)                 |
+---------------+---------------+---------------+---------------------------------------------+
| 24            | 加密方式      | 1 Byte        | 瑞银电表当前加密方式(工厂模式下配置，抄读无 |
|               |               |               | 任何限制)                                   |
|               |               |               | 00:软件AES128 加密                          |
|               |               |               | 01:RJMU 国密SM1(暂不支持)                   |
|               |               |               | 02:RJMU 国密SM4(暂不支持)                   |
|               |               |               | 03:国网ESAM 加密                            |
|               |               |               | 04:ECC256 签名算法                          |
|               |               |               | 05:其他                                     |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-014"></a>
### 充电结束报文应答(cmd=14) [cmd=014]
    报文功能：回复CCU主动上送的停止充电完成报文

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与命令13发送一样，表示对该命令序号的应  |
|               |               |               | 答                                          |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 确认结果      | 1             | 0--成功  1--失败                            |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-015"></a>
### CCU主动推送充电结束异常日志(cmd=15) [cmd=015]
    CCU在充电结束之后，如果判断是异常停机，主动发送本报文到MCU,MCU需要打开文件，
    并持续写入文件中，直到接收完所有数据。

    写入的文件名需要包含流水号，终端号，枪号，类型等信息。

    CCU推送日志，总是先推送日志类型0，在推送日志类型更改的类型，直到推送完所有类
    型。

    MCU需要接收完所有日志类型后才能继续下一步对日志的处理，如果在某种类型接收包
    数量不完整，或者类型数量不足，目前定义超时时间为10s,当推送过程开始后，10s内
    没有推送完数据，MCU停止数据接收过程，进行下一步处理。

    CCU推送完一包后，需要等待应答才能推送下一包，如果应答失败，需要重复推送当前
    包，最多重发3次，停止推送流程。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节）  | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 订单流水号    | 32            | ASCII字符     |
+---------------+---------------+---------------+---------------+
| 2             | 日志类型      | 1             | BMS头尾日志   |
|               |               |               | 异常日志      |
|               |               |               | CC1电压数据   |
+---------------+---------------+---------------+---------------+
| 3             | 总包数量      | 4             | 日志一共有几  |
|               |               |               | 包            |
+---------------+---------------+---------------+---------------+
| 4             | 包序列号      | 4             | 第几包，从1开 |
|               |               |               | 始            |
+---------------+---------------+---------------+---------------+
| 5             | 数据域        | 1024          | 总是发满      |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-016"></a>
### 应答CCU主动推送充电结束异常日志(cmd=16) [cmd=016]
    MCU接收到报文后，需要立刻写入文件中，写入成功后及时应答结果。

    该cmd不保存报文。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 订单流水号    | 32            | ASCII字符                    |
+---------------+---------------+---------------+------------------------------+
| 2             | 日志类型      | 1             | BMS头尾日志                  |
|               |               |               | 异常日志                     |
|               |               |               | CC1电压数据                  |
+---------------+---------------+---------------+------------------------------+
| 3             | 总包数量      | 4             | 日志一共有几包               |
+---------------+---------------+---------------+------------------------------+
| 4             | 包序列号      | 4             | 第几包，从1开始              |
+---------------+---------------+---------------+------------------------------+
| 5             | 处理结果      | 1             | 成功                         |
|               |               |               | 失败重发(未实现)             |
|               |               |               | 停止发送流程                 |
+---------------+---------------+---------------+------------------------------+
```


<a id="sec-cb9207fd"></a>
## MCU-CCU参数设置(TCP)
<a id="cmd-021"></a>
### 整形参数设置(cmd=21) [cmd=021]
    该指令用于MCU设置和更新单个CCU参数值。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 参数地址      | 2             | 参见附录文件参数表                          |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 参数值        | 4             | 设置参数的实际值                            |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-022"></a>
### 整形参数设置应答(cmd=22) [cmd=022]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 参数地址      | 2             | 参见附录文件参数表                          |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 参数值        | 4             | 更新后的参数值                              |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 参数设置结果  | 2             | 0-成功                                      |
|               |               |               | 其他-其他具体的设置失败原因                 |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-023"></a>
### 整形参数表查询(cmd=23) [cmd=023]
    查询设备所有参数表信息，本报文无实际内容如下表所示。

    收到签到后，发送应答后应该立刻发送整形参数查询报文，查询所有整形参数信息。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 参数开始地址  | 4             | 参数起始地址  |
+---------------+---------------+---------------+---------------+
| 2             | 参数个数      | 4             | 1-256         |
+---------------+---------------+---------------+---------------+
```

<a id="cmd-024"></a>
### 整形参数表查询应答(cmd=24) [cmd=024]
    如果查询个数，大于参数最大索引值，按实际查询到的个数发送

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 参数开始地址  | 4             | 参数起始地址                 |
+---------------+---------------+---------------+------------------------------+
| 2             | 参数个数(n)   | 4             | 1-256                        |
+---------------+---------------+---------------+------------------------------+
| 3             | 整数参数内容  | n*4           | 参数具体内容，见附录文档     |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-025"></a>
### CCU主动推送参数信息(cmd=25) [cmd=025]
    CCU上电后，立即发送签到，在接收到签到应答指令后，立刻发送CMD25指令，把CCU本
    地保存的参数，和CCU内存临时默认参数同步到MCU

    CCU需要持续周期发送CMD=25直到MCU应答。

    凡是参数有变化，ccu需要主动推送本报文，同步CCU参数到MCU上

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 参数开始地址  | 4             | 参数起始地址                 |
+---------------+---------------+---------------+------------------------------+
| 2             | 参数个数(n)   | 4             | 1-256                        |
+---------------+---------------+---------------+------------------------------+
| 3             | 整数参数内容  | n*4           | 参数具体内容，见附录文档     |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-026"></a>
### MCU应答CCU推送参数信息(cmd=26) [cmd=026]
    MCU接收到CCU同步参数信息cmd=25,需要立刻应答cmd=26反馈设置结果。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 参数开始地址  | 4             | 参数起始地址                 |
+---------------+---------------+---------------+------------------------------+
| 2             | 参数个数      | 4             | 1-256                        |
+---------------+---------------+---------------+------------------------------+
| 3             | 参数设置结果  | 2             | 成功 1-失败                  |
|               |               |               | 针对所有设置的参数           |
+---------------+---------------+---------------+------------------------------+
```


<a id="cmd-027"></a>
### MCU主动推送参数信息(cmd=27) [cmd=027]
    MCU在接收到CCU签到指令后，回复签到的同时，发送参数同步指令给CCU。

    MCU需要签到后首次参数更新到了CCU,如果CCU回复结果为失败或者未回复。则对应充电
    单元不能允许充电。

    签到流程结束后，MCU可按需发送此报文更新CCU参数。

    CCU如果一段时间没有接收CMD=27,需要主动断开socket，触发CMD=27报文发送，并且拒
    绝MCU发起的启动充电流程。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 参数开始地址  | 4             | 参数起始地址                 |
+---------------+---------------+---------------+------------------------------+
| 2             | 参数个数(n)   | 4             | 1-256                        |
+---------------+---------------+---------------+------------------------------+
| 3             | 整数参数内容  | n*4           | 参数具体内容，见附录文档     |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-028"></a>
### CCU应答MCU推送参数信息(cmd=28) [cmd=028]
    CCU接收到MCU同步参数信息cmd=27,需要立刻应答cmd=28反馈设置结果。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 参数开始地址  | 4             | 参数起始地址                 |
+---------------+---------------+---------------+------------------------------+
| 2             | 参数个数      | 4             | 1-256                        |
+---------------+---------------+---------------+------------------------------+
| 3             | 参数设置结果  | 2             | 0成功 1-失败                 |
|               |               |               | 针对所有设置的参数           |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-029"></a>
### 字符参数设置(cmd=29) [cmd=029]
    该指令用于MCU设置和更新单个ccu字符参数。

    该报文正对终端发送，不同枪的二维码索引不同。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 参数地址      | 2             | 参见附录文件参数表                          |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 参数长度      | 4             | 1.对于字符编码数据为字符长度+1              |
|               |               |               | 2.对于bin数据为实际有效长度                 |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 参数值        | n             | 参数n=参数长度                              |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-030"></a>
### 字符参数设置应答(cmd=30) [cmd=030]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 参数地址      | 2             | 参见附录文件参数表                          |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 参数设置结果  | 2             | 0-成功                                      |
|               |               |               | 0x01. 长度不对                              |
|               |               |               | 0x02. 没有该参数                            |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-031"></a>
### MCU下发计费模型(cmd=31) [cmd=031]
    MCU在回复签到的信息的同时，下发一次计费模型。

    MCU在本地计费模型变更的时候下发更新计费模型。

    MCU会对每个枪独立发送，考虑2个枪的费率模型不一样的情况。

    当前费率模型时段数量为24，报文为定长度报文

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 有效时段数量  | 1             | 目前为最大24，需要考虑扩展                  |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 开始时间1     | 2             | 0-1440，单位分钟                            |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 结束时间1     | 2             | 0-1440，单位分钟                            |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 电费1         | 4             | 0.00001/bit,电网价格倍率                    |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 服务费1       | 4             | 0.00001/bit                                 |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 尖峰平谷标志  | 1             | 1-255                                       |
|               | 段1           |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 8             | ...           |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 9             | 开始时间n     | 2             | 0-1440，单位分钟                            |
+---------------+---------------+---------------+---------------------------------------------+
| 10            | 结束时间n     | 2             | 0-1440，单位分钟                            |
+---------------+---------------+---------------+---------------------------------------------+
| 11            | 电费n         | 2             | 0.00001/bit                                 |
+---------------+---------------+---------------+---------------------------------------------+
| 12            | 服务费n       | 2             | 0.00001/bit                                 |
+---------------+---------------+---------------+---------------------------------------------+
| 13            | 尖峰平谷标志  | 1             |                                             |
|               | 段n           |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-032"></a>
### CCU费率模型应答(cmd=32) [cmd=032]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-033"></a>
### MCU下发结算信息(cmd=33) [cmd=033]
    该报文对每把枪独立发送。

    为了保持界面显示和上送平台数据一致，将CCU界面需要显示的数据全部下发。

    对于mcu下发的停止充电原因ccu没有定义描述的按原始code显示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 停止充电原因  | 2             | 参见附录1                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 开始充电电量  | 4             | 0.001kWh/bit                                |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 充电电量      | 4             | 0.001kWh/bit                                |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 开始SOC       | 1             | 0-100                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 结束SOC       | 1             | 0-100                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 开始充电时间  | 4             | Unix时间戳                                  |
+---------------+---------------+---------------+---------------------------------------------+
| 8             | 充电时长      | 4             | 单位s                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 9             | 电费          | 4             | 0.0001元/bit                                |
+---------------+---------------+---------------+---------------------------------------------+
| 10            | 服务费        | 4             | 0.0001元/bit                                |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-034"></a>
### CCU应答结算信息(cmd=34) [cmd=034]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-035"></a>
### CCU请求主动充电(cmd=35) [cmd=035]
    基本流程

    ·  CCU发送cmd35请求鉴权 -> MCU转发平台鉴权 -> MCU返回cmd36结果 -> 成功则
    MCU发送cmd5启动

    启动类型

    ·  刷卡启动: CCU收到刷卡需求后发送type=1的cmd35,鉴权成功后MCU通过cmd5启动并
    更新充电参数

    ·  VIN码启动: 如果是VIN启动，CCU需要先在cmd3中更新枪状态的自动启动中标志位
    ，通知MCU。CCU获取VIN后发送type=2的cmd35,鉴权成功后MCU通过cmd5启动并更新充电
    参数。

    ·  管理员界面启动:如果是管理员界面启动，CCU应该上报充电分钟，MCU接收到直接
    通过cmd启动。并且在设定停止。

    终端TCU启动：类似本地开机，直接鉴权通过。CCU需要在终端TCU鉴权通过之后上报请
    求启动充电，MCU会下发开机命令，该流程适用扫码，vin,刷卡流程。


    异常处理

    ·  鉴权结果: MCU通过cmd36通知结果,结果不成功则CCU退出流程

    ·  超时处理: CCU发送cmd35后30s内未收到cmd5或cmd36则退出流程


```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 启动类型      | 1             | 1-刷卡启动                                  |
|               |               |               | 2-VIN启动                                   |
|               |               |               | 3-管理员界面启动                            |
|               |               |               | 4-终端TCU启动                               |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 充电卡卡号    | 32            | ASCII编码，刷卡有效                         |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 充电卡随机数  | 48            | ASCII编码，刷卡有效                         |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 物理卡号      | 8             | ASCII编码，刷卡有效                         |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | VIN码         | 18            | ASCII编码，VIN启动                          |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 充电时长      | 4             | 秒，管理员界面启动有效                      |
+---------------+---------------+---------------+---------------------------------------------+
```



<a id="cmd-036"></a>
### MCU应答主动请求充电(cmd=36) [cmd=036]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 启动类型      | 1             | 1-刷卡启动                                  |
|               |               |               | 2-VIN启动                                   |
|               |               |               | 3-管理员界面启动                            |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 鉴权结果      | 1             | 0-成功                                      |
|               |               |               | 1-账户认证失败                              |
|               |               |               | 2-账户余额不足                              |
|               |               |               | 3-账户被锁定                                |
|               |               |               | 4-未知用户/账户不存在                       |
|               |               |               | 5-账户挂失/销户                             |
|               |               |               | 6-密码错误                                  |
|               |               |               | 7-后台响应超时                              |
|               |               |               | 8-存在未结账记录                            |
|               |               |               | 9-桩不支持刷卡                              |
|               |               |               | 10-桩不支持vin充电                          |
|               |               |               | 11-平台应答桩停用                           |
|               |               |               | 12-其它原因                                 |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 余额          | 4             | 单位，分，1234=12.34元                      |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-037"></a>
### CCU主动上传VIN充电失败信息(cmd=37) [cmd=037]
    1.基本流程

    ·  MCU点击界面VIN启动充电 -> MCU下发71启动VIN充电 -> CCU回复72启动指令响
    应成功 -> CCU启动失败（BMS通信异常或模块控制异常）-> 上传37告知MCU启动失败原
    因->MCU停止等待，结束VIN充电流程

    2.暂时限定此命令只使用一体机，MCU界面VIN启动失败场景，如用其他场景请重新评估

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 停止充电原因  | 2             | 参见附录1                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 充电电量      | 4             | 0.001kWh/bit                                |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 开始电表电量  | 4             | 0.001kWh/bit 只是主枪的                     |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 结束电表电量  | 4             | 0.001kWh/bit 只是主枪的                     |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 停止参数1     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 停止参数2     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 8             | 停止参数3     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 9             | 停止参数4     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 10            | 停止参数5     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 11            | 停止参数6     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 12            | 停止参数7     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
| 13            | 停止参数8     | 2             | 由控制板自定义                              |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="sec-8229015d"></a>
# M2-MCU:点对点数据(UDP=5XX)
<a id="cmd-051"></a>
### M2注册帧(cmd=51) [cmd=051]
    M2上电发送签到到MCU，如果MCU没有回复，持续周期发送。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 硬件类型                     | 1             | 01：CCU                      |
|               |                              |               | 02：M2板                     |
|               |                              |               | 03：超充驱动板CCU            |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 拨码地址号                   | 1             | 有效范围1                    |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 项目号                       | 2             | 0x000028AA代表项目类型10410  |
+---------------+------------------------------+---------------+------------------------------+
| 5             | M2软件版本号                 | 2             | 0x000028AA代表版本号V 104.10 |
+---------------+------------------------------+---------------+------------------------------+
| 6             | M2软件编译时间               | 32            | ASCII字符串                  |
+---------------+------------------------------+---------------+------------------------------+
| 7             | C2软件版本号                 | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 9             | C3软件版本号-1号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 10            | C3软件版本号-2号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 11            | C3软件版本号-3号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 12            | C3软件版本号-4号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 13            | C3软件版本号-5号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 14            | C3软件版本号-6号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 15            | C3软件版本号-7号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 16            | C3软件版本号-8号             | 2             | 格式同上                     |
+---------------+------------------------------+---------------+------------------------------+
| 17            | 主机类型                     | 2             | 0xA501 -普通主机-8共享模块   |
|               |                              |               | 0xA502-液冷主机              |
+---------------+------------------------------+---------------+------------------------------+
| 18            | 时间                         | 4             | 从2023年到当前的秒数         |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="cmd-052"></a>
### 注册回复帧(cmd=52) [cmd=052]
    MCU收到注册帧之后，需要立刻应答M2板。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 登录结果      | 1             | 0：正常使用                  |
|               |               |               | 1：禁止使用                  |
+---------------+---------------+---------------+------------------------------+
| 2             | 登录失败原因  | 1             | 1：版本号过低                |
|               |               |               | 2：系统故障                  |
|               |               |               | 3：其他故障                  |
+---------------+---------------+---------------+------------------------------+
| 3             | MCU软件项目号 | 2             | 0x000028AA代表版本号V 104.10 |
+---------------+---------------+---------------+------------------------------+
| 4             | MCU软件版本号 | 2             | 0x000028AA代表项目类型10410  |
+---------------+---------------+---------------+------------------------------+
```


<a id="cmd-053"></a>
### 参数请求同步(cmd=53) [cmd=053]
    MCU收到签到后，发送应答后，应该立刻发送整形参数查询报文，查询所有整形参数信
    息。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 参数开始地址  | 4             | 参数起始地址  |
+---------------+---------------+---------------+---------------+
| 2             | 参数个数      | 4             | 1-256         |
+---------------+---------------+---------------+---------------+
```

<a id="cmd-054"></a>
### 参数请求同步应答(cmd=54) [cmd=054]
    M2收到参数同步报文后，需要立刻发送应答，将本地参数发送给MCU。

    如果查询个数，大于本地参数最大索引值，按实际查询到的个数发送。

    如果是连续的地址中有无效的参数，也需要发送0填充。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 参数开始地址  | 4             | 参数起始地址                 |
+---------------+---------------+---------------+------------------------------+
| 2             | 参数个数(n)   | 4             | 1-256                        |
+---------------+---------------+---------------+------------------------------+
| 3             | 整数参数内容  | n*4           | 参数具体内容，见附录文档     |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-055"></a>
### MCU-M2整形参数设置(cmd=55) [cmd=055]
    该指令用于MCU设置和更新单个M2参数值。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 参数地址      | 2             | 参见附录文件参数表                          |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 参数值        | 4             | 设置参数的实际值                            |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-056"></a>
### M2-MCU整形参数设置应答(cmd=56) [cmd=056]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 参数地址      | 2             | 参见附录文件参数表                          |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 参数值        | 4             | 更新后的参数值                              |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 参数设置结果  | 2             | 成功                                        |
|               |               |               | 参数超过可设置范围                          |
|               |               |               | 当前状态不允许更改                          |
|               |               |               | 其他错误                                    |
|               |               |               | 其他-其他具体的设置失败原因                 |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-057"></a>
### MCU请求获取模块详细状态(cmd=57) [cmd=057]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-058"></a>
### M2应答模块详细状态信息(cmd=58) [cmd=058]
```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1             | 响应命令序号                                | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2             | 有效模块数量                                | 1             | 1-40                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3             | 模块1 PFC-MOS温度1                          | 1             | 偏移50度，0代表-50度，255代码205度          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4             | 模块1 PFC-MOS温度2                          | 1             | 同上                                        |
|               |                                             |               |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5             | 模块1 PFC-MOS温度3                          | 1             | 同上                                        |
|               |                                             |               |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6             | 模块1 防反二极管温度                        | 1             | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7             | 模块1 整流二极管温度                        | 1             | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8             | 模块1 谐振电感温度                          | 1             | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9             | 模块1 变压器温度                            | 1             | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 10            | 模块1 LLC-MOS温度                           | 1             | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 11            | 模块1 环境温度或者液冷模块进水口温度        | 1             | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 12            | 模块1 风扇转速                              | 1             | 0-100                                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 13            | ……                                        | ……          | ……                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 14            | 模块40 ……                                 |               | 同上                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```


<a id="sec-fd2ce1aa"></a>
## 公共UDP报文(点对点)
<a id="cmd-071"></a>
### 控制命令(cmd=71) [cmd=071]
    该报文依据索引实际功能，可能发送给M2或者终端ccu。接受到的设备按实际自己是否
    能够处理，来执行处理动作。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号，重发保持不变                  |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 控制命令索引  | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 控制值        | 4             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-072"></a>
### 控制命名应答(cmd=72) [cmd=072]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 响应命令序号  | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 控制命令索引  | 2             | 参见控制命令号表                            |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 处理结果      | 2             | 0-成功                                      |
|               |               |               | 其他，具体失败原因，ccu可以自己按实际情况发 |
|               |               |               | 送                                          |
+---------------+---------------+---------------+---------------------------------------------+
```


    控制命令号表

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 接收对象      | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | M2重启                       | M2            | 1-立刻重启                   |
|               |                              |               | 2-空闲重启                   |
+---------------+------------------------------+---------------+------------------------------+
| 2             | CCU重启                      | M2            | 1-立刻重启                   |
|               |                              |               | 2-空闲重启                   |
+---------------+------------------------------+---------------+------------------------------+
| 3             | C2重启                       | M2            | 1-立刻重启                   |
|               |                              |               | 2-空闲重启                   |
+---------------+------------------------------+---------------+------------------------------+
| 4             | C3重启                       | M2            | 1-立刻重启                   |
|               |                              |               | 2-空闲重启                   |
+---------------+------------------------------+---------------+------------------------------+
| 5             | D1板重启                     | 终端          | 1-立刻重启                   |
|               |                              |               | 2-空闲重启                   |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 电子锁上锁                   | 终端          | 枪号值                       |
+---------------+------------------------------+---------------+------------------------------+
| 7             | 电子锁解锁                   | 终端          | 枪号值                       |
+---------------+------------------------------+---------------+------------------------------+
| 8             | 请求CCU启动启动鉴权流程      | 枪            | 1-刷卡启动                   |
|               |                              |               | 2-VIN启动                    |
|               |                              |               | 流程中重发继续原来流程执行   |
|               |                              |               | 3-刷卡停止                   |
|               |                              |               | 4-退出刷卡                   |
+---------------+------------------------------+---------------+------------------------------+
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
```


<a id="sec-9a1499e4"></a>
# CCU-M2-MCU:广播数据(UDP)
<a id="sec-e8af88a2"></a>
## MCU-S-V8广播数据
<a id="cmd-100"></a>
### mcu广播自己的状态信息或者设置通用参数(cmd=100) [cmd=100]
    向整个周期网络广播当前设备信息。

    如果是有屏终端，那么CCU收到的是终端MCU的广播。

    如果是无屏幕终端，CCU接收的是主柜MCU的广播，自行根据设备类型区分即可。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 总枪数                       | 1             | 1-32                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 时间                         | 4             | 从2023年到当前的秒数                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 时间ms                       | 2             | 当前系统时间ms                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | MCU告警信息                  | 4             | 参见附录文件                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 运营后台连接情况             | 4             | 每个位表示一个终端连接情况收，0-离线  1-在  |
|               |                              |               | 线                                          |
|               |                              |               | Bit1-1号终端-bit32-32号终端                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 是否需要M2签到               | 1             | 0-否  1-是                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | MCU掉电紧急停机              | 1             | 0-否  0xAA-是                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 组网带宽                     | 4             | 按bit生效                                   |
|               |                              |               | 0-100M                                      |
|               |                              |               | 1-10M                                       |
|               |                              |               |                                             |
|               |                              |               | Bit0:M2                                     |
|               |                              |               | bit1-bit14：终端                            |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="sec-85b3213a"></a>
## M2-S-V8广播数据
<a id="cmd-111"></a>
### M2广播当前状态数据(cmd=111) [cmd=111]
    向整个网络周期广播当前设备信息。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 主机工作状态                 | 1             | 0x01-主机待机                               |
|               |                              |               | 0x02-主机充电                               |
|               |                              |               | 0x03-主机故障                               |
|               |                              |               | 0x04-主机禁用                               |
|               |                              |               | 0x05-主机升级                               |
|               |                              |               | 0x06-半自动工装                             |
|               |                              |               | 0x07-全自动工装                             |
|               |                              |               | 0xff-主机状态未知                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 主机状态1                    | 4             | 见附录1                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 主机状态2                    | 4             | 见附录1                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 主机状态3                    | 4             | 见附录1                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 主机状态4                    | 4             | 见附录1                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | A相电压                      | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | B相电压                      | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | C相电压                      | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | A相电流                      | 2             | 0.1A/bit,预留                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | B相电流                      | 2             | 0.1A/bit,预留                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | C相电流                      | 2             | 0.1A/bit,预留                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 电网频率                     | 1             | Hz                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 交流电表值                   | 4             | 0.001kWh/bit,预留                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 模块环境温度最高值           | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 模块环境温度最低值           | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机当前总需求功率           | 4             | 0.1kW/bit                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机当前输出功率             | 4             | 0.1kW/bit                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机进风口温度A              | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机进风口温度B              | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机出风口1温度A             | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机出风口1温度B             | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机系统告警1                | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机系统告警2                | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机系统告警3                | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机系统告警4                | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪1运行状态                  | 1             | Bit 0 :空闲 0-充电中1                       |
|               |                              |               | Bit 1:绝缘状态                              |
|               |                              |               | Bit 3 是否有分配功率(模块)                  |
|               |                              |               | Bit 4 是否禁用该充电枪                      |
|               |                              |               | Bit 5:中间接触器闭合                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪1输出电压                  | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪1输出电流                  | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪1当前实际占用模块个数      | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪1满足负载率最少模块个数    | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪1满足最大功率最少模块个数  | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪2运行状态                  | 1             | Bit 0 :空闲 0-充电中1                       |
|               |                              |               | Bit 1:绝缘状态                              |
|               |                              |               | Bit 3 是否有分配功率(模块)                  |
|               |                              |               | Bit 4 是否禁用该充电枪                      |
|               |                              |               | Bit 5:中间接触器闭合                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪2输出电压                  | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪2输出电流                  | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪2当前实际占用模块个数      | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪2满足负载率最少模块个数    | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪2 满足最大功率最少模块个数 | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪28运行状态                 | 1             | Bit 0 :空闲 0-充电中1                       |
|               |                              |               | Bit 1:绝缘状态                              |
|               |                              |               | Bit 3 是否有分配功率(模块)                  |
|               |                              |               | Bit 4 是否禁用该充电枪                      |
|               |                              |               | Bit 5:中间接触器闭合                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪28输出电压                 | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪28输出电流                 | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪28当前实际占用模块个数     | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪28满足负载率最少模块个数   | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 枪28满足最大功率最少模块个数 | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机出风口2温度A             | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机出风口2温度B             | 1             | -50的偏移量，0表示50，250表示200            |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 维护模式状态位               | 4             | 按bit生效,bit=1有效，需断开该终端所有直连模 |
|               |                              |               | 块接触器                                    |
|               |                              |               | bit0-bit13：终端1-14                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机模块利用率               | 1             | 当前使用模块数量 / 模块数量，分辨率1%       |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机功率利用率               | 1             | 当前输出功率 / 堆功率，分辨率1%             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 主机功率满足率               | 1             | 当前输出功率 / min(需求功率，堆功率)，分辨  |
|               |                              |               | 率1%                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-112"></a>
### M2广播当前所有模块的状态信息数据(cmd=112) [cmd=112]
    M2向整个网络周期广播当前设备信息。

    最大36个模块

    周期2s

    （连续上传40个模块的数据，显示36个，19，20不显示）

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 模块数量                     | 1             | 充电堆模块实际数量                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 模块1电压                    | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 模块1电流                    | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 模块1当前设置分组号          | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 模块1的父节点                | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 模块1的子节点1               | 1             | 如果节点有效，填充模块号                    |
|               |                              |               | 节点无效填充0                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 模块1的子节点2               | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 模块1的子节点3               | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 模块1的子节点4               | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 模块1的子节点5               | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 模块1故障码                  | 1             | 参见附录文档模块告警定义                    |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 模块1状态码                  | 2             | 定义标志 ：0/1                              |
|               |                              |               | Bit0:  离线/在线                            |
|               |                              |               | Bit1:  正常/故障                            |
|               |                              |               | Bit2:  未就绪/就绪                          |
|               |                              |               | Bit3:  低压档/高压档                        |
|               |                              |               |                                             |
|               |                              |               | Bit4:  关机/开机                            |
|               |                              |               | Bit5:  EPO未触发/EPO触发                    |
|               |                              |               | Bit6:  下电/上电                            |
|               |                              |               | Bit7:  正常/空槽                            |
|               |                              |               |                                             |
|               |                              |               | Bit8： 正常/损坏(不调用)                    |
|               |                              |               | Bit9： 正常/禁用(不通高压)                  |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 模块2***                     | x             | 同模块1几个字段相同                         |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | ...                          |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 模块40***                    | x             | 同模块1几个字段相同                         |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 模块1删除原因                | 1             | Bit0:  主机共享模块接触器粘连               |
|               |                              |               | Bit1:  主机判定中间接触器粘连               |
|               |                              |               | Bit2:  终端判定中间接触器DC+粘连            |
|               |                              |               | Bit3:  终端判定中间接触器DC-粘连            |
|               |                              |               | Bit4:  终端通讯故障                         |
|               |                              |               | Bit5:  终端门禁故障                         |
|               |                              |               | Bit6:  终端急停故障                         |
|               |                              |               | Bit7:  预留                                 |
|               |                              |               | (0正常 1故障)                               |
|               |                              |               | Bit0显示优先级最高                          |
|               |                              |               | Bit6显示优先级最低                          |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | ...                          |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 模块40删除原因               |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-113"></a>
### M2广播C3板接触器共享模块状态(cmd=113) [cmd=113]
    接触器方案的共享模块机型才需要发送这一帧,MCU使用签到类型信息区分

    （1-18号接触器是下层  19-38是上层接触器）

    2.这里反馈的状态是正负极接触器一起的状态。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 共享模块上层接触器个数       | 1             | 整数，最大18                 |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 共享模块下层接触器个数       | 1             | 整数，最大18                 |
+---------------+------------------------------+---------------+------------------------------+
|               | 1组接触器(A面)               | 2             | 定义标志 ：0/1               |
|               | 1组接触器是正极+负极         |               | Bit0:  0不存在/1存在         |
|               |                              |               | Bit1:  1控制闭合/0断开       |
|               |                              |               | Bit2:  正极接触器反馈        |
|               |                              |               | Bit3:  负极接触器反馈        |
|               |                              |               | Bit2:  1拒动/0正常           |
|               |                              |               | Bit3:  1粘连/0正常           |
|               |                              |               | Bit4:  1禁用/0正常           |
|               |                              |               | Bit5-8:  故障次数            |
|               |                              |               | Bit9-15:  预留               |
+---------------+------------------------------+---------------+------------------------------+
|               | ...                          | 2*34          |                              |
+---------------+------------------------------+---------------+------------------------------+
|               | 36组接触器(A面)              | 2             |                              |
+---------------+------------------------------+---------------+------------------------------+
|               | 37组接触器(B面)              | 2             | 定义标志 ：0/1               |
|               |                              |               | Bit0:  0不存在/1存在         |
|               |                              |               | Bit1:  1控制闭合/0断开       |
|               |                              |               | Bit2:  1拒动/0正常           |
|               |                              |               | Bit3:  1粘连/0正常           |
|               |                              |               | Bit4:  1禁用/0正常           |
|               |                              |               | Bit5-8:  故障次数            |
|               |                              |               | Bit9-15:  预留               |
+---------------+------------------------------+---------------+------------------------------+
|               | ...                          | 2*34          | ...                          |
+---------------+------------------------------+---------------+------------------------------+
|               | 72组接触器(B面)              | 2             |                              |
+---------------+------------------------------+---------------+------------------------------+
```


<a id="sec-d0db7e9c"></a>
### M2广播M1板状态继电器共享模块状态(cmd=)(接触器机型目前无须关注)
    共享模块机型才需要发送这一帧,MCU使用项目类型来区分，本报文项目类型在40---49
    之间生效

    周期发送

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 共享模块1号板控制信号        | 2             | Bit1-Bit14按bit表示14个继电器的控制状态     |
|               |                              |               | 断开  1-闭合                                |
|               |                              |               | M1板控制/反馈/粘连信号                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 共享模块1号板反馈信号        | 2             | Bit1-Bit14按bit表示该板14个继电器的反馈状态 |
|               |                              |               | 断开  1-闭合                                |
|               |                              |               | M1板控制/反馈/粘连信号                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 共享模块1号板粘连            | 2             | 14个继电器，详情同上                        |
|               |                              |               | 共享模块1号板粘连状态 Bit1-Bit14按bit表示该 |
|               |                              |               | 板14个继电器的粘连状态 0-不粘连  1-粘连     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 共享模块1号板拒动            | 2             | Bit1-Bit14按bit表示该板14个继电器的拒动状态 |
|               |                              |               |  0-不拒动  1-拒动                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 共享模块2号板控制信号        | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 共享模块2号板反馈信号        | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 共享模块2号板粘连            | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 共享模块2号板拒动            | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | ...                          |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 共享模块20号板控制信号       | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 共享模块20号板反馈信号       | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 共享模块20号板粘连           | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 共享模块20号板拒动           | 2             | 14个继电器，详情同上                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 桥接板控制信号1              | 1             | Bit1-Bit7按bit表示A面7个接触器控制信号，一  |
|               |                              |               | 个信号控制4个继电器                         |
|               |                              |               | 0-断开  1-闭合                              |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 桥接板反馈信号1              | 4             | Bit1-Bit28按bit表示A面28接触器反馈信号      |
|               |                              |               | 0-断开  1-闭合                              |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 桥接板控制信号2              | 1             | Bit1-Bit7按bit表示A面7个接触器控制信号，一  |
|               |                              |               | 个信号控制4个继电器                         |
|               |                              |               | 0-断开  1-闭合                              |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 桥接板反馈信号2              | 4             | Bit1-Bit28按bit表示A面7个接触器反馈信号     |
|               |                              |               | 0-断开  1-闭合                              |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-114"></a>
### M2广播模块版本信息(cmd=114) [cmd=114]
    m2上电后需要及时获取一次所有模块版本信息，并在M2给MCU签到后广播此报文10次，
    周期1s。

    每次充电模块有上电动作广播2次该报文。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 模块1-AC版本  | 2             | 0x 28AA代表版本104.10        |
+---------------+---------------+---------------+------------------------------+
| 2             | 模块1-DC版本  | 2             | 0x 28AA代表版本104.10        |
+---------------+---------------+---------------+------------------------------+
| 3             | ……          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 4             | ……          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 5             | 模块40-AC版本 | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 6             | 模块40-DC版本 | 2             |                              |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-115"></a>
### M2广播接触器共享模块状态信息(cmd=115) [cmd=115]
```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 共享模块上层接触器个数       | 1             | 整数，最大18                 |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 共享模块下层接触器个数       | 1             | 整数，最大18                 |
+---------------+------------------------------+---------------+------------------------------+
| 9             | A面控制信号up                | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 10            | A面控制信号down              | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 11            | A面反馈信号up+               | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 12            | A面反馈信号down+             | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 13            | A面反馈信号up-               | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 14            | A面反馈信号down-             | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 15            | B面控制信号up                | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 16            | B面控制信号dwon              | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 17            | B面反馈信号up+               | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 18            | B面反馈信号down+             | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 19            | B面反馈信号up-               | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
| 20            | B面反馈信号down-             | 4             | 按bit定义，0-断开，1-闭合    |
+---------------+------------------------------+---------------+------------------------------+
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="cmd-120"></a>
### 液冷M2广播U2板接触器状态(cmd=120) [cmd=120]
    液冷机型专用

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 1U2           | 4             | Bit0-Bit20：                 |
|               |               |               | 0-反馈断开                   |
|               |               |               | 1-反馈闭合                   |
|               |               |               | Bit21:  该U2板通信超时       |
|               |               |               | Bit22:  该U2板地址重复       |
|               |               |               | Bit23-Bit31: 预留            |
+---------------+---------------+---------------+------------------------------+
| 2             | 2U2           | 4             | 同上                         |
+---------------+---------------+---------------+------------------------------+
| 3             | 3U2           | 4             | 同上                         |
+---------------+---------------+---------------+------------------------------+
| 4             | 4U2           | 4             | 同上                         |
+---------------+---------------+---------------+------------------------------+
| 7             | A+ 接触器数量 | 1             | 1-20                         |
+---------------+---------------+---------------+------------------------------+
| 9             | A- 接触器数量 | 1             | 1-20                         |
+---------------+---------------+---------------+------------------------------+
| 11            | B+ 接触器数量 | 1             | 1-20                         |
+---------------+---------------+---------------+------------------------------+
| 13            | B- 接触器数量 | 1             | 1-20                         |
+---------------+---------------+---------------+------------------------------+
|               | 1号接触器(A正 | 2             | 定义标志 ：0/1               |
|               | )             |               | Bit0:  0不存在/1存在         |
|               |               |               | Bit1:  1控制闭合/0断开       |
|               |               |               | Bit2:  1拒动/0正常           |
|               |               |               | Bit3:  1粘连/0正常           |
|               |               |               | Bit4:  1禁用/0正常           |
|               |               |               | Bit5-8:  故障次数            |
|               |               |               | Bit9-15:  预留               |
+---------------+---------------+---------------+------------------------------+
|               | ...           |               |                              |
+---------------+---------------+---------------+------------------------------+
|               | 20号接触器(A  |               |                              |
|               | 正)           |               |                              |
+---------------+---------------+---------------+------------------------------+
|               | 1号接触器(A负 |               | 定义标志 ：0/1               |
|               | )             |               | Bit0:  0不存在/1存在         |
|               |               |               | Bit1:  1控制闭合/0断开       |
|               |               |               | Bit2:  1拒动/0正常           |
|               |               |               | Bit3:  1粘连/0正常           |
|               |               |               | Bit4:  1禁用/0正常           |
|               |               |               | Bit5-8:  故障次数            |
|               |               |               | Bit9-15:  预留               |
+---------------+---------------+---------------+------------------------------+
|               | ...           |               | ...                          |
+---------------+---------------+---------------+------------------------------+
|               | 20号接触器(A  |               |                              |
|               | 负)           |               |                              |
+---------------+---------------+---------------+------------------------------+
|               | 1号接触器(B正 |               | ...                          |
|               | )             |               |                              |
+---------------+---------------+---------------+------------------------------+
|               | ...           |               | ...                          |
+---------------+---------------+---------------+------------------------------+
|               | 20号接触器(B  |               |                              |
|               | 正)           |               |                              |
+---------------+---------------+---------------+------------------------------+
|               | 1号接触器(B负 |               | ...                          |
|               | )             |               |                              |
+---------------+---------------+---------------+------------------------------+
|               | ...           |               | ...                          |
+---------------+---------------+---------------+------------------------------+
|               | 20号接触器(B  |               | ...                          |
|               | 负)           |               |                              |
+---------------+---------------+---------------+------------------------------+
```


<a id="cmd-121"></a>
### M2广播液冷水泵及系统风扇信息(cmd=121) [cmd=121]
    .液冷机型专用

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 液冷泵1状态                  | 4bit          | 00：液冷泵1正常                             |
|               |                              |               | 01：液冷泵1故障                             |
|               |                              |               | 02：液冷泵1手动                             |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 液冷泵2状态                  | 4bit          | 00：液冷泵2正常                             |
|               |                              |               | 01：液冷泵2故障                             |
|               |                              |               | 02：液冷泵2手动                             |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 液冷泵1 PWM                  | 1             | 0~100                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 液冷泵2 PWM                  | 1             | 0~100                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 液冷泵1压力                  | 1             | 归一化到0-100                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 液冷泵2压力                  | 1             | 归一化到0-100                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 换热器1出水口温度            | 1             | 作废，暂保留                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 进水口1温度                  | 1             | 偏移量-50，-50 - 200℃                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 换热器2出水口温度            | 1             | 作废，暂保留                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 进水口2温度                  | 1             | 偏移量-50，-50 - 200℃                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 系统风扇1转速                | 1             | 0-100(百分比)                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 系统风扇2转速                | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 系统风扇3转速                | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 系统风扇4转速                | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 系统风扇5转速                | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | M2软件版本号                 | 4             | 0x23CC6BD8 代表版本号V600B599D512           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | U1软件版本号                 | 4             | 0x23CC6BD8 代表版本号V600B599D512           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | U2-1号板软件版本号           | 4             | 0x23CC6BD8 代表版本号V600B599D512           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | U2-2号板软件版本号           | 4             | 0x23CC6BD8 代表版本号V600B599D512           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | U2-3号板软件版本号           | 4             | 0x23CC6BD8 代表版本号V600B599D512           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | U2-4号板软件版本号           | 4             | 0x23CC6BD8 代表版本号V600B599D512           |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-020"></a>
## CCU-S-V8广播数据-核心功能(cmd=20X) [cmd=020]
<a id="cmd-201"></a>
### CCU-V8当前充电枪的实时状态(cmd=201) [cmd=201]
    向整个网络广播当前设备信息,只MCU和M2板接收处理。

    发送停止完成帧前需要发送一次这个状态，更新当前电表读数。

    注意本帧的累计充电电量和当前功率为本枪自己的功率。

    枪典型的重复发送周期为2s，突发事件可以立刻发送更新。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 工作状态                     | 1             | 0 空闲                                      |
|               |                              |               | 1 握手阶段                                  |
|               |                              |               | 2 配置阶段                                  |
|               |                              |               | 3 充电中                                    |
|               |                              |               | 4 充电结束阶段                              |
|               |                              |               | 5 故障（告警）                              |
|               |                              |               | 6 副枪处于并充状态                          |
|               |                              |               | 7 维护模式                                  |
|               |                              |               | 8 作为副枪并充中                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 枪故障状态                   | 32            | 参见附录2控制模块告警位信息列表             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 并充主枪的枪号               | 1             | 工作状态处于“6”时候有效                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 当前电表读数                 | 4             | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 本次充电累计充电电量         | 4             | 状态为充电时才有效                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 当前充电功率                 | 2             | 0.1kW/bit                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 终端充电状态(发给主机)       | 2             | 按BIT定义                                   |
|               |                              |               | BIT0：插枪信号                              |
|               |                              |               | BIT1：系统启动状态                          |
|               |                              |               | BIT2：模块启动状态                          |
|               |                              |               | BIT3：模块挡位                              |
|               |                              |               |                                             |
|               |                              |               | BIT4：预留                                  |
|               |                              |               | BIT5：双枪/ 单枪                            |
|               |                              |               | BIT6：风扇状态                              |
|               |                              |               | BIT7：并充状态（主副都发）                  |
|               |                              |               |                                             |
|               |                              |               | BIT8：预留状态                              |
|               |                              |               | BIT9：超充机型                              |
|               |                              |               | BIT10：绝缘状态                             |
|               |                              |               | BIT11：中间接触器状态                       |
|               |                              |               |                                             |
|               |                              |               | BIT12：预充信号(分配模块)                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 枪需要输出的电压(发给主机)   | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 枪需要输出的电流(发给主机)   | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 充电模式                     | 1             | 充电模式（0x01：恒压充电；0x02：恒流充电）  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | BMS需求电压                  | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | BMS需求电流                  | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 枪采样的模块电压             | 2             | 0.1V/bit，非实际采样值，模块电压主机发送给  |
|               |                              |               | CCU                                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 枪采样电池电压               | 2             | 0.1V/bit，接触器外测电压                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 单枪实际输出电流             | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 总直流充电电流(并充)         | 2             | 0.1V/bit(并充为多枪合并的电流)              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 启动充电订单识别码           | 4             | 使用MCU下发启动充电命令CMD=5的“命令序号”  |
|               |                              |               | 每一笔充电订单识别码唯一                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 液冷2枪模块电压采样          | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 并充组网状态                 | 1             | 0-标准模式各枪独立工作                      |
|               |                              |               | 1-单终端/机柜并充组网                       |
|               |                              |               | 2-多终端/机柜并充组网                       |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 组网枪数量                   | 1             | 0-255                                       |
|               |                              |               | 如果并充组网了，这个值不能为0，数量不包括本 |
|               |                              |               | 枪                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 并充组网枪1地址              | 1             | 组网状态至少一个副枪，地址不包括本枪        |
|               |                              |               | 高4bit 终端地址                             |
|               |                              |               | 低4bit 枪号                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22            | ……                         | 1             | 高4bit 终端地址                             |
|               |                              |               | 低4bit 枪号                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23            | 并充组网枪4地址              | 1             | 高4bit 终端地址                             |
|               |                              |               | 低4bit 枪号                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24            | 1 路电压(最高位符号位)       | 4             | 0.0001/bit                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25            | 1 路电流(最高位符号位)       | 4             | 0.0001/bit                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26            | 1 路功率(最高位符号位)       | 4             | 0.0001/bit                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 27            | 1 路总电量(最高位符号位)     | 4             | 0.001/bit                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
```




<a id="cmd-202"></a>
### CCU-V8当前充电枪的液冷实时状态(cmd=202) [cmd=202]
    只有液冷终端时才发本报文

    每个枪都需发送本报文，各枪的状态是独立的，对于公共部分填充一样的值。

    周期1s

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 液冷系统风扇速率             | 1             | 0~100                        |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 液冷泵速                     | 1             | 0~100                        |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 液冷枪进水温度               | 1             | 偏移量-50，-50 - 200℃       |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 液冷枪出水温度               | 1             | 偏移量-50，-50 - 200℃       |
+---------------+------------------------------+---------------+------------------------------+
| 5             | 液冷量化水压                 | 1             | 1~100量化                    |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 液冷水压压力值               | 2             | 0.01MPa/bit                  |
+---------------+------------------------------+---------------+------------------------------+
| 7             | D1软件版本号                 | 1             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 8             | D2软件版本号                 | 1             |                              |
+---------------+------------------------------+---------------+------------------------------+
```



<a id="cmd-203"></a>
### CCU-V8状态需求短报文(cmd=203) [cmd=203]
    当第一次实际电流(电表电流)大于需求电流5A以上时，马上发送一帧

    若实际电流仍大于需求电流5A以上，则每隔100ms发送一帧，直到实际电流与需求电流
    的差值小于5A

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 终端充电状态(发给主机)       | 2             | 按BIT定义                    |
|               |                              |               | BIT0：插枪信号               |
|               |                              |               | BIT1：系统启动状态           |
|               |                              |               | BIT2：模块启动状态           |
|               |                              |               | BIT3：模块挡位               |
|               |                              |               |                              |
|               |                              |               | BIT4：预留                   |
|               |                              |               | BIT5：双枪/ 单枪             |
|               |                              |               | BIT6：风扇状态               |
|               |                              |               | BIT7：并充状态（主副都发）   |
|               |                              |               |                              |
|               |                              |               | BIT8：预留状态               |
|               |                              |               | BIT9：超充机型               |
|               |                              |               | BIT10：绝缘状态              |
|               |                              |               | BIT11：中间接触器状态        |
|               |                              |               |                              |
|               |                              |               | BIT12：预充信号(分配模块)    |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 枪需要输出的电流(发给主机)   | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
```

























<a id="cmd-022"></a>
## CCU-C-V8广播数据(cmd=22X) [cmd=022]
    以下内容为一体机CCU广播数据

<a id="sec-3889fbac"></a>
### CCU广播当前所有模块的状态信息数据(221)
    最大N=一体机最大模块数，对于模块号跳跃的情况，也按最大模块数量上报，空槽模块
    上报0。例如最大模块数量为10，实际模块数量为6，实际模块号使用1-3,6-8，那么空
    槽4-5,9-10也是需要上报数据。

    周期5s

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 最大模块数量                 | 1             | N的大小，一体机支持的最大模块号             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 实际模块数量                 | 1             | 实际有效的模块数量                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 模块1电压                    | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 模块1电流                    | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 模块1当前设置分组号          | 1             | 0-255                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 模块1故障码                  | 1             | 参见附录文档模块告警定义                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 模块1状态码                  | 2             | 定义标志 ：0/1                              |
|               |                              |               | Bit0:  离线/在线                            |
|               |                              |               | Bit1:  正常/故障                            |
|               |                              |               | Bit2:  未就绪/就绪                          |
|               |                              |               | Bit3:  低压档/高压档                        |
|               |                              |               |                                             |
|               |                              |               | Bit4:  关机/开机                            |
|               |                              |               | Bit5:  EPO未触发/EPO触发                    |
|               |                              |               | Bit6:  下电/上电                            |
|               |                              |               | Bit7:  正常/空槽                            |
|               |                              |               |                                             |
|               |                              |               | Bit8： 正常/损坏(不调用)                    |
|               |                              |               | Bit9： 正常/禁用(不通高压)                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | ……                         | ……          | ……                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 模块N电压                    | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 模块N电流                    | 2             | 0.1A/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 模块N当前设置分组号          | 1             | 0-255                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 模块1故障码                  | 1             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 模块1状态码                  | 2             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | A相电压                      | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | B相电压                      | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | C相电压                      | 2             | 0.1V/bit                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | A相电流                      | 2             | 0.1A/bit,预留                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | B相电流                      | 2             | 0.1A/bit,预留                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | C相电流                      | 2             | 0.1A/bit,预留                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 电网频率                     | 1             | Hz                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 交流电表值                   | 4             | 0.001kWh/bit,预留                           |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-222"></a>
### CCU广播模块版本信息(cmd=222) [cmd=222]
    最大N=一体机最大模块数，对于模块号跳跃的情况，也按最大模块数量上报，空槽模块
    上报0。例如最大模块数量为10，实际模块数量为6，实际模块号使用1-3,6-8，那么空
    槽4-5,9-10也是需要上报数据。

    CCU上电后需要及时获取一次所有模块版本信息，并在M2给MCU签到后广播此报文10次，
    周期1s。

    每次充电模块有上电动作广播2次该报文。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 最大模块数量  |               | N的大小，即最大模块号        |
+---------------+---------------+---------------+------------------------------+
| 2             | 实际模块数量  |               | 实际有效的模块数量           |
+---------------+---------------+---------------+------------------------------+
| 3             | 模块1-AC版本  | 2             | 0x 28AA代表版本104.10        |
+---------------+---------------+---------------+------------------------------+
| 4             | 模块1-DC版本  | 2             | 0x 28AA代表版本104.10        |
+---------------+---------------+---------------+------------------------------+
| 5             | ……          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 6             | ……          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 7             | 模块N-AC版本  | 2             | 0x 28AA代表版本104.10        |
+---------------+---------------+---------------+------------------------------+
| 8             | 模块N-DC版本  | 2             | 0x 28AA代表版本104.10        |
+---------------+---------------+---------------+------------------------------+
```


<a id="cmd-003"></a>
## CCU-S-V8广播数据-附加功能(cmd=3XX) [cmd=003]
<a id="cmd-301"></a>
### CCU-V8 主机允许进入并枪的辅枪信息(cmd=301) [cmd=301]
    报文功能：收到BMS嗅探报文，并收到用户启动充电命令时，向整个网络广播当前设备
    信息。

    发送时间段：收到启动充电命令至收到BCP报文前。

    说明：

    主枪收到启动充电命令时，开始每间隔50ms发送一帧此报文，直到收到所有对应的副枪
    发送的302报文或BMS流程到达BCP报文，停止发送此报文。

    非同一个终端的副枪，只有收到字段6包含其终端及枪号时，才允许副枪进入充电流程
    。


```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 拨码地址                     | 1             | CCU-拨码地址                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 总枪数                       | 1             | 1-单枪终端;2-双枪终端                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 本枪枪号                     | 1             | 1/2                                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 同一个CAN总线终端数量        | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 允许进入辅枪的地址           | 8             | 8个嗅探终端信息                             |
|               | （嗅探报文终端地址和枪号）   |               |                                             |
|               |                              |               | 每个字节前4bit是终端地址，后4bit是枪号。    |
|               |                              |               | 如：0x51 表示收到5号终端的1枪的CAN总线BMS嗅 |
|               |                              |               | 探报文                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 主机已收到副枪确认地址       | 8             | 已收到枪应答的副枪地址和枪号                |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-302"></a>
### CCU-MCU 并枪的副枪信息(cmd=302) [cmd=302]
    报文功能：有CAN嗅探报文时，向总线广播本枪数据

    说明：

    1.BMS的CAN总线收到并充的CAN嗅探后，每100ms发送一帧此报文。

    副枪进入并充状态后，再退出时，则对应并充的流程就结束，不能启动电流。

    若因故障副枪退出并充，但能继续收到CAN总线上的充电中的报文，则也广播发送此报
    文，但并充状态要填0。


```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 拨码地址                     | 1             | CCU-拨码地址                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 总枪数                       | 1             | 1-单枪终端;2-双枪终端                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 本枪枪号                     | 1             | 1/2                                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 并充状态                     | 1             | 未进入并充副枪状态（不能向M2发送开机需求）  |
|               |                              |               | 已进入并充副枪状态                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 并充主机拨码地址             | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 并充主机拨码枪号             | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 初始电表度                   | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 当前电表度                   | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 当前充电电流                 | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-303"></a>
### CCU-V8 并充订单信息(CCU-MCU-点对点)(cmd=303) [cmd=303]
    报文发送时机与周期

    未插枪组网情况下，不必发送303报文，减少日志内容。

    插枪状态下，组网成功后立刻发送一帧，随后周期1s发送直到收到cmd5。

    启动充电中、充电中、停止中周期5s持续发送。在收到cmd5之后和发送cmd13之前需要
    补充发一帧。

    当并充状态从并充变为非并充后，连续发送周期1s发送10帧后切换到正常判断模式，按
    未插枪组网和已插枪组网判断发送。

    组网阶段（未收到cmd5前）

    所有组网的枪都需发送cmd303

    主枪地址填0，并充状态发送有效并充状态1或者2

    副枪发送除自己之外的其他枪信息，并充数量为组网数量-1

    电表信息都填充0

    组网失败即空闲状态，可以不发送303.

    充电阶段（收到cmd5后）

    仅由主枪发送cmd303，并填写有效电表值,副枪不能发送cmd303.

    如果副枪发生掉线或故障：

    故障副枪可以停止输出。

    并充状态保持不变，主枪的303报文副枪数量和起始电量不能改变。所有副枪的当前电
    量维持更新或者维持当前值。不能归零或者跳变。

    维持原有周期。



```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 主枪地址      | 1             | 高4bit 终端地址              |
|               |               |               | 低4bit 枪号                  |
+---------------+---------------+---------------+------------------------------+
| 2             | 并充状态      | 1             | 0-标准模式各枪独立工作       |
|               |               |               | 1-单终端/机柜并充            |
|               |               |               | 2-多终端/机柜并充            |
|               |               |               | 主要用来区分是否同一TCU      |
+---------------+---------------+---------------+------------------------------+
| 3             | 并充副枪数量  | 1             |                              |
+---------------+---------------+---------------+------------------------------+
| 4             | 副枪1地址     | 1             | 高4bit 终端地址              |
|               |               |               | 低4bit 枪号                  |
+---------------+---------------+---------------+------------------------------+
| 5             | 副枪1起始电表 | 4             |                              |
|               | 值            |               |                              |
+---------------+---------------+---------------+------------------------------+
| 6             | 副枪1当前电表 | 4             |                              |
|               | 值            |               |                              |
+---------------+---------------+---------------+------------------------------+
| 7             | ...           |               |                              |
+---------------+---------------+---------------+------------------------------+
| 8             | 副枪8地址     | 1             | 高4bit 终端地址              |
|               |               |               | 低4bit 枪号                  |
+---------------+---------------+---------------+------------------------------+
| 9             | 副枪8起始电表 | 4             |                              |
|               | 值            |               |                              |
+---------------+---------------+---------------+------------------------------+
| 10            | 副枪8当前电表 | 4             |                              |
|               | 值            |               |                              |
+---------------+---------------+---------------+------------------------------+
```


<a id="sec-fbad6dd4"></a>
# 充电桩维护报文
<a id="sec-0914d4dd"></a>
## CCU(M2) --- MCU:日志上传
    日志系统通信采用UDP 点对点发送数据

    MCU逻辑：

    MCU在需要的时刻下发“日志文件请求”，在得到CCU/M2的应答之前以约定的重传间隔
    时间进行重传；

    MCU在下发“日志文件请求”之前，应开启 FTP 文件服务，直至收到CCU/M2的“拒绝响
    应”应答，或完成CCU/M2的 FTP文件写入（FTP服务常开）；

    MCU在收到CCU/M2的状态报文中的状态为非“上传中”时，结束日志获取流程。

    MCU在下发“日志文件请求”之前，应该创建存放日志的文件夹，格式为：

    (1)log_设备类型_桩编码_年月日_时分秒

    (2)例如：log_mcu_31011500901009_2024-01-05_10-33-17

    CCU/M2逻辑：

    CCU/M2实时应答“日志文件请求”消息；

    CCU/M2若判断日志请求信息无效，可拒绝响应日志请求消息，并在应答结果填写“拒绝
    响应”；

    CCU/M2应答结果为“响应”时，应同时按要求上传对应的日志文件到“日志文件请求”
    指定的路径中。

    CCU/M2自发送结果域为“响应”的应答报文开始，直至收到状态变为非“上传中”，以
    约定周期上报日志上传状态，不需MCU应答。

<a id="cmd-401"></a>
### 日志文件请求指令下发(cmd=401) [cmd=401]
```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 事务号                       | 4             | 从上电开始，每拉取一次累加1  |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 设备类型                     | 2             | 2:CCU/控制器                 |
|               |                              |               | 6:M2分体机主机控制器         |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 日志类型                     | 2             | 按bit生效                    |
|               |                              |               | Bit1:log 打印日志            |
|               |                              |               | Bit2:event 事件日志          |
|               |                              |               | Bit3:alarm 告警日志          |
|               |                              |               | Bit4:charge 充电记录         |
|               |                              |               | Bit5:conf 配置文件           |
|               |                              |               | Bit6:bms BMS车辆报文日志     |
|               |                              |               | Bit7:bms BMS功率日志         |
|               |                              |               | Bit8:power 功率分配日志      |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 日志上传文件路径             | 128           | ASCII字符，最大长度63        |
|               |                              |               | 例如：/log/log_ccu_2024xxx   |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="cmd-402"></a>
### 日志文件请求指令回复(cmd=402) [cmd=402]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 事务号        | 4             | 序号与发送一样表示对该命令序号的应答        |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 设备类型      | 2             | 2:CCU/控制器                                |
|               |               |               | 6:M2分体机主机控制器                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 结果          | 1             | 0xAA: 响应                                  |
|               |               |               | 0xBB: 拒绝响应                              |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 拒绝原因      | 2             | 0x00：None                                  |
|               |               |               | 0x01: 无效的设备类型                        |
|               |               |               | 0x02: 当前状态不支持获取日志                |
|               |               |               | 0x03: 日志发送中                            |
|               |               |               | 0x04：路径无效                              |
|               |               |               | 0x05:其他错误                               |
|               |               |               | 说明：选填，结果为拒绝响应时                |
|               |               |               | 需要                                        |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-403"></a>
### 日志文件上传状态(cmd=403) [cmd=403]
```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 设备类型      | 2             | 2:CCU/控制器                 |
|               |               |               | 6:M2分体机主机控制器         |
+---------------+---------------+---------------+------------------------------+
| 2             | 上传状态      | 2             | 0x00：上传中                 |
|               |               |               | 0x01：上传完成               |
|               |               |               | 0x02:ftp 地址连接失败        |
|               |               |               | 0x03:ftp 服务登录失败        |
|               |               |               | 0x04:目录无权限              |
|               |               |               | 0x05:其他错误                |
+---------------+---------------+---------------+------------------------------+
| 3             | 上传进度      | 1             | 0-100%                       |
+---------------+---------------+---------------+------------------------------+
```

<a id="sec-7ccb7bd4"></a>
## CCU(M2)--- MCU:在线升级
    使用点对点UDP下发升级命令

    MCU逻辑：

    MCU在需要的时刻，下发“在线升级指令”，在收到CCU/M2的应答之前以约定的的重传
    间隔时间进行重传次,失败则向上通知；

    MCU开启 FTP 服务。

    3. MCU在CCU/M2的升级状态为“等待复位”时可下发“立即复位指令”，在得到CCU/M2
    的应答之前按约定的重传间隔时间进行重传；

    4. MCU在CCU/M2的升级状态为“升级包下载失败”、“无效升级包-校验失败”、“无
    效升级包-不支持的设备信息”时，判断升级失败。针对“升级包下载失败”，交互控
    制板可下发“在线升级指令”重新发起在线升级，其他失败状态不再重新发起在线升级
    ，直至有新的可升级软件包；

    CCU/M2逻辑：

    5. CCU/M2在收到在线升级指令下发报文后，应判断当前是否满足在线升级条件，并实
    时做出应答：

    a) CCU/M2当前不满足升级条件或升级信息不匹配时，应答报文的结果应为“拒绝响应
    ”，并附带拒绝原因；

    b) CCU/M2在应答报文结果为“响应”后，立即开始从MCU的FTP 服务器下载升级文件；

    6. CCU/M2自发送结果域为“响应”的应答报文开始，直至收到MCU的”立即复位”指令
    之前，以约定周期上报在线升级状态，不需MCU应答；

    7. CCU/M2在升级文件下载过程中出现MCU通信故障，或 FTP 服务异常时，其升级状态
    转为“升级包下载失败”；

    8. CCU/M2完成升级文件的 FTP 下载后，升级状态为“升级包处理中”；

    9. CCU/M2应控制完成升级文件的校验、解析等处理，处理结果正常后升级状态为“等
    待复位”；

    10. CCU/M2校验升级文件的结果异常时，可选择再次从 FTP 服务器下载升级文件，下
    载开始时CCU/M2的升级状态应转为“升级包下载中”，3 次下载的升级文件均无法通过
    校验时，CCU/M2的升级状态应转为“无效升级包-校验失败”；

    11. CCU/M2校验升级文件的结果正常，而解析文件类型结果异常时，CCU/M2的升级状态
    应转为“无效升级包-不支持的设备信息”；

    12. CCU/M2在收到MCU的“立即复位指令”时，应判断当前是否满足立即复位条件，并
    及时做出应答：

    a) CCU/M2当前不满足复位条件时，应答报文的结果域填写“拒绝响应”，并附带拒绝
    原因；

    b) CCU/M2在做出立即复位“响应”应答后，控制CCU/M2整体重启并完成升级，重启过
    程耗时不大于 2min。

    13. 如果升级类型为M2的下层模块时，涉及两层数据下发（MCU-M2-下层模块），升级
    进度在每一层各占用50%，在状态上报下发进度时要有所体现。并且只有最后一层升级
    包下发完成是，状态才能上送 “下载完成”或者等“等待复位”；对于这种两层升级
    场景，设备允许从“升级包下载中”转换为任意失败状态。

    升级包逻辑：

    升级包使用数字签名技术对固件进行签名，以确保其来源的可信度和完整性。数字签名
    的过程包括以下步骤：

    生成哈希值：OTA升级包使用MD5生成哈希值(固件摘要)。MD5需要使用16字节按二进制
    存储。

    验证完整性：在接收方接收到数据包时，需要对数据包进行拆分，对原始固件信息进行
    MD5，把计算结果和固件包头MD5做对比。对接一致才进行后续操作。

    升级包包头固定预留1024字节存储安全信息，且该包头固定在内部flash中

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 有效标志      | 4             | 0xFFFF FFFF：默认值（脚本生成），以下字段无 |
|               |               |               | 效                                          |
|               |               |               | 0xAAF5 B7D6：系统软件                       |
|               |               |               | 其他：模块软件，以下字段无效                |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 签名值        | 16            | 对升级包整个原始文件进行MD5的哈希值         |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 设备类型      | 2             | 0x17C9:CCU/控制器                           |
|               |               |               | (shccu_v8.bin)                              |
|               |               |               | 0xA7B6:分体机主机控制器(shm2_v8.bin)        |
|               |               |               | 0x5695:主机驱动板控制板程序                 |
|               |               |               | (shvcus.bin)                                |
|               |               |               | 0x7362:液冷驱动板控制板程序                 |
|               |               |               | (shlcu.bin)                                 |
|               |               |               | 工具根据keil生成的文件名插入对应的设备类型  |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 升级软件版本  | 4             | 0x000028AA代表版本号V 104.10                |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 升级包大小    | 4             | 整个文件的大小(包括包头)                    |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 升级包页数    | 2             | 升级包大小(包括包头)/256 +1                 |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 预留          | X             | 字段长度把此报文补齐1024字节                |
+---------------+---------------+---------------+---------------------------------------------+
```



<a id="cmd-411"></a>
### 在线升级指令下发(cmd=411) [cmd=411]
```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 命令序号                     | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |                              |               | 命令共用序号                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 设备类型                     | 2             | 2:CCU/控制器                                |
|               |                              |               | 3:模块AC                                    |
|               |                              |               | 4:模块DC                                    |
|               |                              |               | 6:分体机主机控制器                          |
|               |                              |               | 8:C2或C3板                                  |
|               |                              |               | 11:D1 板                                    |
|               |                              |               | 12：液冷M2板                                |
|               |                              |               | 13：液冷U1板                                |
|               |                              |               | 14：液冷U2板                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 设备范围                     | 8             | 按位表示64个设备类型是否选中                |
|               |                              |               | 1-选中                                      |
|               |                              |               | 0-未选中                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 升级执行动作指示             | 2             | 控制器控制复位升级逻辑                      |
|               |                              |               | MCU控制复位重启逻辑                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 升级软件版本                 | 2             | 0x000028AA代表版本号V 104.10                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 升级文件路径                 | 64            | ASCII字符，最大长度63                       |
|               |                              |               | 完整路径，包括文件名称                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 升级文件数据长度             | 4             | 字节长度                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-412"></a>
### 在线升级指令应答(cmd=412) [cmd=412]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号                                |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 设备类型      | 1             | 2:CCU/控制器                                |
|               |               |               | 3:模块AC                                    |
|               |               |               | 4:模块DC                                    |
|               |               |               | 6:分体机主机控制器                          |
|               |               |               | 8:C2或C3板                                  |
|               |               |               | 11:D1 板，终端液冷控制                      |
|               |               |               | 12：液冷M2板程序                            |
|               |               |               | 13：液冷U1板程序-功率控制                   |
|               |               |               | 14：液冷U2板程序-继电器分配                 |
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 结果          | 1             | 0xAA: 响应                                  |
|               |               |               | 0xBB: 拒绝响应                              |
+---------------+---------------+---------------+---------------------------------------------+
| 8             | 拒绝原因      | 2             | 0x00：None                                  |
|               |               |               | 0x01: 无效的设备类型                        |
|               |               |               | 0x02: 当前状态不支持在线升级                |
|               |               |               | 0x03: 升级包下载中                          |
|               |               |               | 0x04: 升级包名称校验错误                    |
|               |               |               | 说明：选填，结果为拒绝响应时                |
|               |               |               | 需要                                        |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-413"></a>
### 在线升级状态上报(cmd=413) [cmd=413]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 设备类型      | 1             | 2:CCU/控制器                                |
|               |               |               | 3:模块AC                                    |
|               |               |               | 4:模块DC                                    |
|               |               |               | 6:分体机主机控制器                          |
|               |               |               | 8:C2或C3板                                  |
|               |               |               | 11:D1 板，终端液冷控制                      |
|               |               |               | 12：液冷M2板程序                            |
|               |               |               | 13：液冷U1板程序-功率控制                   |
|               |               |               | 14：液冷U2板程序-继电器分配                 |
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 升级状态      | 2             | 0x00：升级包下载中                          |
|               |               |               | 0x01：升级包下载失败                        |
|               |               |               | 0x02：升级包处理中                          |
|               |               |               | 0x03：无效升级包-校验失败                   |
|               |               |               | 0x04：无效升级包-不支持的设备信息           |
|               |               |               | 0x05:预留                                   |
|               |               |               | 0x06：等待复位                              |
|               |               |               | 0x07: 执行复位动作                          |
|               |               |               | 0x08: 重启升级成功                          |
|               |               |               | 0x09: 重启升级失败                          |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 下载进度      | 1             | 0-100%                                      |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-415"></a>
### 在线升级复位指令下发(cmd=415) [cmd=415]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 从上电开始，每发送一个命令累加1，所有设置/  |
|               |               |               | 命令共用序号                                |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-416"></a>
### 在线升级复位指令回复(cmd=416) [cmd=416]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 命令序号      | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 结果          | 1             | 0xAA: 响应                                  |
|               |               |               | 0xBB: 拒绝响应                              |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 拒绝原因      | 2             | 0x00：None                                  |
|               |               |               | 0x01: 当前有功率输出                        |
|               |               |               | 说明：选填，结果为拒绝响应时                |
|               |               |               | 需要                                        |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="sec-96d5e952"></a>
## CCU(M2) - OTHER:日志打印或者其他TCP服务(telnet暂时不做)
    限制客户端个数为4个，不需要太多的调试设备同时在线。

<a id="sec-53f8b3ff"></a>
## CCU(M2)--- MCU:隐私点对点数据(UDP)(暂时不做)
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 拨码地址      | 1             | CCU-拨码地址  |
|               |               |               | M2调试填充    |
|               |               |               | 0xff          |
+---------------+---------------+---------------+---------------+
| 2             | 日志类型      | 1             | 1,log         |
|               |               |               | 2,bms         |
|               |               |               | 3,event       |
+---------------+---------------+---------------+---------------+
| 3             | Payload_Log   | n             | GB2312编码    |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-006"></a>
# MCU-CCU,MCU-M2工装调试数据(cmd=6XX，点对点UDP) [cmd=006]
    工装报文全部采用UDP报文点对点发送。

    MCU-CCU或者MCU-M2交互

<a id="cmd-060"></a>
## MCU-CCU,MCU-M2工装调试数据(cmd=60x-63x) [cmd=060]
<a id="cmd-601"></a>
### 终端启动或者退出工装流程(cmd=601) [cmd=601]
    该报文只能在设备空闲时发起，设备不能充电，也不能处于任意工装模式中。

    对于同一个设备，同时只能处于一种状态。

    如果从一种工装状态进入另外一种工装状态，需要发起退出，然后才能重新进入。

    该报文针对每一把枪单独发起测试，不同的枪可以同时测试。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 事务号                       | 4             | 自增，重发保持不变           |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 工装模式                     | 1             | 0：退出所有工装流程          |
|               |                              |               | 1：终端半自动工装模式        |
|               |                              |               | 2：终端全自动工装模式        |
+---------------+------------------------------+---------------+------------------------------+
| 3             | CCU全自动工装使能            | 2             | 按bit生效                    |
|               |                              |               | Bit0:干接点测试使能          |
|               |                              |               | Bit1:辅助电源测试使能        |
|               |                              |               | Bit2:电压采样测试使能        |
|               |                              |               | Bit3:绝缘测试使能            |
|               |                              |               | Bit4:电表计量测试使能        |
|               |                              |               | Bit5:33008加测使能           |
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="cmd-602"></a>
### 设备响应工装控制指令(cmd=602) [cmd=602]
    终端设备应该判断接收到的设备类型是否正确。

    终端设备在充电中或者已经在工装状态下，响应失败，如果是重发的报文，需要响应成
    功。

    终端设备只能响应终端半自动化工装，终端全自动工装模式，其他模式需要拒绝。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 事务号        | 4             | 序号与发送一样表示对该命令序号的应答        |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 结果          | 1             | 0xAA: 响应                                  |
|               |               |               | 0xBB: 拒绝响应                              |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 拒绝原因      | 2             | 0x00：None                                  |
|               |               |               | 0x01: 无效的设备类型                        |
|               |               |               | 0x02: 正在充电                              |
|               |               |               | 0x03：已经处于工装模式                      |
|               |               |               | 0x04：无效的工装模式参数                    |
|               |               |               | 说明：选填，结果为拒绝响应时                |
|               |               |               | 需要                                        |
+---------------+---------------+---------------+---------------------------------------------+
```

<a id="cmd-603"></a>
### 终端半自动化工装控制指令(cmd=603) [cmd=603]
    该指令只能在半自动化工装模式下有效，其他状态，设备不响应。

    终端在10s内不在收到该报文，自动退出半自动化工装测试流程，恢复正常状态。

    该报文不设应答，此报文不分枪。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | YL风扇调速调节               | 1             | 液冷泵的风扇专设设置：0--100                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | YL泵转速调节                 | 1             | 液冷泵的电机专设设置：0--100                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | A枪干接点驱动测试            | 2             | 按bit生效 0-失效 1-生效                     |
|               |                              |               | Bit0:灯带R红 1亮/0灭                        |
|               |                              |               | Bit1:灯带G绿 1亮/0灭                        |
|               |                              |               | Bit2:灯带B蓝 1亮/0灭                        |
|               |                              |               | Bit3:枪CC2电阻开关 1闭/0断                  |
|               |                              |               | Bit4:辅助电源12V/24V切换测试 1 24V/0 12V    |
|               |                              |               | Bit5:枪锁 0开锁/1闭锁                       |
|               |                              |               | Bit6:枪CC1电阻投切 1闭/0断                  |
|               |                              |               | Bit7:辅助电源开关 1闭/0断                   |
|               |                              |               | Bit8:DC+接触器开关 1闭/0断                  |
|               |                              |               | Bit8:DC-接触器开关 1闭/0断                  |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | B枪干接点驱动测试            | 2             | Bit0:灯带R红 1亮/0灭                        |
|               |                              |               | Bit1:灯带G绿 1亮/0灭                        |
|               |                              |               | Bit2:灯带B蓝 1亮/0灭                        |
|               |                              |               | Bit3:枪CC2电阻开关 1闭/0断                  |
|               |                              |               | Bit4:辅助电源12V/24V切换测试 1 24V/0 12V    |
|               |                              |               | Bit5:枪锁 0开锁/1闭锁                       |
|               |                              |               | Bit6:枪CC1电阻投切 1闭/0断                  |
|               |                              |               | Bit7:辅助电源开关 1闭/0断                   |
|               |                              |               | Bit8:DC接触器开关 1闭/0断                   |
|               |                              |               | Bit9:A_BMS电阻投切控制                      |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 终端干接点驱动测试           | 2             | Bit1:终端风扇 1启/0停                       |
|               |                              |               | Bit2:中间接触器+开关 1闭/0断                |
|               |                              |               | Bit2:中间接触器-开关 1闭/0断                |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-605"></a>
### 终端全自动工装模式下的实时状态数据(cmd=605) [cmd=605]
    枪在全自动测试期间需要周期1s发送终端自动化工装测试状态和结果，当收到cmd606报
    文回复后，停止发送。

    本报文按枪发送

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 终端类型                     | 1             | 1、单枪250A                  |
|               |                              |               | 2、双枪250A                  |
|               |                              |               | 3、单枪400A                  |
|               |                              |               | 4、双枪400A                  |
|               |                              |               | 5、液冷单枪                  |
|               |                              |               | 6、液冷双枪                  |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 硬件版本                     | 2             | 整数                         |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 软件版本号                   | 2             | 0x000028AA代表版本号V 104.10 |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 执行阶段                     | 1             | 0:工装空闲状态               |
|               |                              |               | 1:干接点测试                 |
|               |                              |               | 2:辅助电源测试中             |
|               |                              |               | 3:电压采样测试中             |
|               |                              |               | 4:绝缘测试中                 |
|               |                              |               | 5:电表计量测试中             |
|               |                              |               | 6：33008加测中               |
|               |                              |               | 7:测试结束                   |
|               |                              |               | 100：工装测试结束            |
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 5             | 全自动工装结果               | 4             | 每两个bit为一个状态位        |
|               |                              |               | 未测试                       |
|               |                              |               | 测试通过                     |
|               |                              |               | 测试失败                     |
|               |                              |               | Bit1-2:干接点测试状态        |
|               |                              |               | Bit3-4:辅助电源测试状态      |
|               |                              |               | Bit5-6:电压采样测试状态      |
|               |                              |               | Bit7-8:绝缘测试状            |
|               |                              |               | Bit9-10:电表计量测试状态     |
|               |                              |               | Bit12-12:33008测试状态       |
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 700V枪电压采数据             | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 7             | 700V模块电压采数据           | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 8             | 700V BMS工装电压数据         | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 9             | 辅源测量电压                 | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 10            | 绝缘正阻值                   | 4             | 千欧                         |
+---------------+------------------------------+---------------+------------------------------+
| 11            | 绝缘负阻值                   | 4             | 千欧                         |
+---------------+------------------------------+---------------+------------------------------+
| 12            | 正桥臂电压X0                 | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 13            | 正桥臂电压X1                 | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 14            | 负桥臂电压Y0                 | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 15            | 负桥臂电压Y1                 | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 16            | 充电前-桩电表电量            | 4             | 0.001kWh/bit                 |
+---------------+------------------------------+---------------+------------------------------+
| 17            | 充电后-桩电表电量            | 4             | 0.001kWh/bit                 |
+---------------+------------------------------+---------------+------------------------------+
| 18            | 桩-充电电量                  | 4             | 0.001kWh/bit                 |
+---------------+------------------------------+---------------+------------------------------+
| 19            | 充电前-工装电表电量          | 4             | 0.001kWh/bit                 |
+---------------+------------------------------+---------------+------------------------------+
| 20            | 充电后-工装电表电量          | 4             | 0.001kWh/bit                 |
+---------------+------------------------------+---------------+------------------------------+
| 21            | 工装测量充电电量             | 4             | 0.001kWh/bit                 |
+---------------+------------------------------+---------------+------------------------------+
| 22            | 枪锁测试结果                 | 1             | 0-未测试                     |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 2-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
| 23            | 直流接触器+结果              | 1             | 0-未测试                     |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 2-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
| 24            | 直流接触器-结果              | 1             | 0-未测试                     |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 2-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
| 25            | 中间接触器+结果              | 1             | 0-未测试                     |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 2-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
| 26            | 中间接触器-结果              | 1             | 0-未测试                     |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 2-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
| 27            | 倾斜-结果                    | 1             | 0-未测试                     |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 2-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
```



<a id="cmd-606"></a>
### 终端全自动工装模式下的实时状态数据回复(cmd=606) [cmd=606]
    只有当cmd605中的执行阶段为“工装测试结束”时，才回复。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-607"></a>
### 主机半自动化工装控制指令(cmd=607) [cmd=607]
    该指令只能空闲模式生效，有任意枪在充电，不能执行动作。

    该指令只能进入半自动化测试状态

    半自动工装状态下30s自动退出

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 事务号                       | 4             | 自增，重发保持不变           |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 工装模式                     | 1             | 0：退出所有工装流程          |
|               |                              |               | 3：进入主机半自动工装模式    |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 主机风扇PWM1调节             | 1             | 主机风扇设置：0--100         |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 主机风扇PWM2调节             | 1             | 主机风扇设置：0--100         |
+---------------+------------------------------+---------------+------------------------------+
| 5             | A面主机地址N模块点亮和关闭   | 4             | 按bit设置模块继电器闭合      |
|               |                              |               | 断开  1-闭合                 |
|               |                              |               | 最多支持32个模块             |
+---------------+------------------------------+---------------+------------------------------+
| 6             | B面主机地址N模块点亮和关闭   | 4             | 按bit设置模块继电器闭合      |
|               |                              |               | 断开  1-闭合                 |
|               |                              |               | 最多支持32个模块             |
+---------------+------------------------------+---------------+------------------------------+
| 7             | A面主机接触器下层的打开和关  | 4             | 按bit设置接触器闭合          |
|               | 闭                           |               | 断开  1-闭合                 |
|               |                              |               | 最多支持64个接触器           |
+---------------+------------------------------+---------------+------------------------------+
|               | A面主机接触器上层的打开和关  | 4             |                              |
|               | 闭                           |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 8             | B面主机接触器下层的打开和关  | 4             |                              |
|               | 闭                           |               |                              |
+---------------+------------------------------+---------------+------------------------------+
|               | B面主机接触器上层的打开和关  | 4             |                              |
|               | 闭                           |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 9             | M2的半自动干接点驱动测试     | 2             | 按bit生效                    |
|               |                              |               | 0- 断开  1-闭合              |
|               |                              |               | Bit1:R红灯                   |
|               |                              |               | Bit2:G绿灯                   |
|               |                              |               | Bit3:B蓝灯                   |
|               |                              |               | Bit4:断上级开关              |
|               |                              |               | Bit5:RSV                     |
+---------------+------------------------------+---------------+------------------------------+
| 10            | 主机风扇PWM3调节（液冷主机） | 1             | 主机风扇设置：0--100         |
+---------------+------------------------------+---------------+------------------------------+
| 11            | 主机水泵PWM1调节（液冷主机） | 1             | 主机水泵1设置：0--100        |
+---------------+------------------------------+---------------+------------------------------+
| 12            | 主机水泵PWM2调节（液冷主机） | 1             | 主机水泵2设置：0--100        |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="cmd-608"></a>
### 主机半自动化工装控制指令应答(cmd=608) [cmd=608]
    该指令只能空闲模式生效，有任意枪在充电，不能执行动作。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 事务号        | 4             | 序号与发送一样，表示对该命令序号的应答      |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 结果          | 1             | 0xAA: 响应                                  |
|               |               |               | 0xBB: 拒绝响应                              |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 拒绝原因      | 2             | 0x00：None                                  |
|               |               |               | 0x01: 无效的设备类型                        |
|               |               |               | 0x02: 正在充电                              |
|               |               |               | 0x03：已经处于工装模式                      |
|               |               |               | 0x04：无效的工装模式参数                    |
|               |               |               | 说明：选填，结果为拒绝响应时需要            |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-609"></a>
### 主机全自动化工装控制指令(cmd=609) [cmd=609]
    该指令只能空闲模式生效，有任意枪在充电，不能执行动作。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 事务号                       | 4             | 自增，重发保持不变           |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 工装模式                     | 1             | 0：退出所有工装流程          |
|               |                              |               | 4：进度主机全自动工装模式    |
+---------------+------------------------------+---------------+------------------------------+
| 3             | M2的全自动干接点驱动测试     | 2             | 按bit生效， 1为通过          |
|               |                              |               | Bit1:预留                    |
|               |                              |               | Bit2:模块地址测试使能        |
|               |                              |               | Bit3:开关反馈状态测试使能    |
|               |                              |               | Bit4:主机终端之间线缆测试使  |
|               |                              |               | 能                           |
|               |                              |               | Bit5:开关驱动位置测试使能    |
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
```


<a id="cmd-610"></a>
### 主机响应全自动工装控制指令(cmd=610) [cmd=610]
    主机应该判断接收到的设备类型是否正确。

    主机设备在充电中或者已经在工装状态下，响应失败，如果是重发的报文，需要响应成
    功。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 事务号        | 4             | 序号与发送一样表示对该命令序号的应答        |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 结果          | 1             | 0xAA: 响应                                  |
|               |               |               | 0xBB: 拒绝响应                              |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 拒绝原因      | 2             | 0x00：None                                  |
|               |               |               | 0x01: 无效的设备类型                        |
|               |               |               | 0x02: 正在充电                              |
|               |               |               | 0x03：已经处于工装模式                      |
|               |               |               | 0x04：无效的工装模式参数                    |
|               |               |               | 说明：选填，结果为拒绝响应时                |
|               |               |               | 需要                                        |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-611"></a>
### 主机全自动工装模式下的实时回复数据(cmd=611) [cmd=611]
    全自动测试期间需要周期1s发送主机自动化工装测试状态和结果，当收到cmd612报文回
    复后，停止发送。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | M2全自动工装在执行阶段       | 2             | 0:工装空闲状态                              |
|               |                              |               | 1:工装前置条件检测中                        |
|               |                              |               | 2:模块地址测试中                            |
|               |                              |               | 3:开关反馈状态测试中                        |
|               |                              |               | 4:主机终端之间线缆测试中                    |
|               |                              |               | 5:开关驱动位置测试中                        |
|               |                              |               | 6:模块输出线缆测试中                        |
|               |                              |               | 7：CAN通信质量测试中                        |
|               |                              |               | 100：工装测试结束                           |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | M2全自动工装结果             | 4             | 每两个bit为一个状态位                       |
|               |                              |               | 0-未测试                                    |
|               |                              |               | 1-测试通过                                  |
|               |                              |               | 2-测试失败                                  |
|               |                              |               | 2-测试中                                    |
|               |                              |               |                                             |
|               |                              |               | Bit1-2:工装前置测试通过                     |
|               |                              |               | Bit3-4:模块地址测试通过                     |
|               |                              |               | Bit5-6:开关反馈状态测试通过                 |
|               |                              |               | Bit7-8:开关驱动位置测试通过                 |
|               |                              |               | Bit9-10:主机终端之间线缆测试通过            |
|               |                              |               | Bit11-12:模块输出线缆测试                   |
|               |                              |               | Bit13-14:CAN通信质量测试                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 终端数量                     | 1             |                                             |
|               |                              |               | 有效的终端数量                              |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 模块数量                     | 1             |                                             |
|               |                              |               | 有效的模块数量                              |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 前置条件1-终端通讯状态       | 2             | 按bit生效， 1为通讯正常                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 前置条件2-驱动板通讯状态     | 2             | 按bit生效， 1为通讯正常                     |
|               |                              |               | 从低到高依次为M2,C2,8*P1                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 前置条件3-A模块通讯状态      | 4             | 按bit生效， 1为通讯正常                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 前置条件3-B模块通讯状态      | 4             | 按bit生效， 1为通讯正常                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | A接触器驱动反馈测试结果正    | 8             | 按bit生效， 1为驱动反馈正常                 |
|               | （测试驱动与反馈信号一致）   |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | A接触器驱动反馈测试结果负    | 8             | 按bit生效， 1为驱动反馈正常                 |
|               | （测试驱动与反馈信号一致）   |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | B接触器驱动反馈测试结果正    | 8             | 按bit生效， 1为驱动反馈正常                 |
|               | （测试驱动与反馈信号一致）   |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | B接触器驱动反馈测试结果负    | 8             | 按bit生效， 1为驱动反馈正常                 |
|               | （测试驱动与反馈信号一致）   |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 模块地址测试结果             | 8             | 按bit生效， 1为测试通过                     |
|               | （测试模块与枪的空间位置一致 |               | bit1为1号模块                               |
|               | ）                           |               | bit19和bit20对应的模块不存在                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 主机终端充电枪之间           | 4             | 按bit生效                                   |
|               | 线缆测试结果                 |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | A面接触器驱动位置测试结果    | 8             | 按bit生效（正负在一起）                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | B面接触器驱动位置测试结果    | 8             | 按bit生效（正负在一起）                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 干节点测试结果               | 2             | 按bit生效                                   |
|               |                              |               | 1(右前门)：1                                |
|               |                              |               | 2(右后门)：1                                |
|               |                              |               | 3(右侧门)：1                                |
|               |                              |               | 4(左侧门)：1                                |
|               |                              |               | 5( 左前门)：1                               |
|               |                              |               | 6(左后门)：1                                |
|               |                              |               | 急停：1                                     |
|               |                              |               |                                             |
|               |                              |               | 以下为液冷主机：                            |
|               |                              |               | 8:系统风扇1 ：1                             |
|               |                              |               | 9:系统风扇2：1                              |
|               |                              |               | 10:系统风扇3：1                             |
|               |                              |               | 11:系统风扇4：1                             |
|               |                              |               | 12:系统风扇5                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 模块输出线缆测试结果         | 8             | 按bit生效， 1为测试通过                     |
|               |                              |               | bit1为1号模块                               |
|               |                              |               | bit19和bit20对应的模块不存在                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 已发送的数据帧               | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | CAN1已接收的数据帧           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | CAN2已接收的数据帧           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | CAN3已接收的数据帧           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | CAN4已接收的数据帧           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

<a id="cmd-612"></a>
### 全自动工装模式下的实时状态数据回复(cmd=612) [cmd=612]
    只有当cmd611中的执行阶段为“工装测试结束”时，才回复。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```

<a id="cmd-613"></a>
### 终端全自动工装模式下的33008实时状态数据(cmd=613) [cmd=613]
    1，开始接结束时间同611保持一致。


```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 33008测试结果                | 4             | 保护接地连续性试验:1         |
|               |                              |               | 连续信号检测试验：1          |
|               |                              |               | 急停试验结果：1              |
|               |                              |               | 舱门试验结果：1              |
|               |                              |               | 预留：4                      |
|               |                              |               |                              |
|               |                              |               | 车辆插头锁止试验结果：1      |
|               |                              |               | 预充电试验结果：1            |
|               |                              |               | *输入电流过冲试验结果：1     |
|               |                              |               | 输出电流设定误差试验结果：1  |
|               |                              |               | 输出电压设定误差试验结果：1  |
|               |                              |               | 充电控制状态试验结果：1      |
|               |                              |               | 充电连接时序：1              |
|               |                              |               | 限流特性试验：1              |
|               |                              |               |                              |
|               |                              |               | 动力电源输入失电试验结果：1  |
|               |                              |               | 通讯中断失电试验结果：1      |
|               |                              |               | 过温保护试验结果：1          |
|               |                              |               | 蓄电池反接试验：1            |
|               |                              |               | 防逆流试验：1                |
|               |                              |               | 充电功能试验：1              |
|               |                              |               | 接触器粘连试验：1            |
|               |                              |               | 限压特性试验：1              |
|               |                              |               |                              |
|               |                              |               | 1-测试通过                   |
|               |                              |               | 0-测试失败                   |
+---------------+------------------------------+---------------+------------------------------+
| 2             | -车辆插头锁止试验-           | 1             | 0/1   驱动/不驱动            |
|               | 绝缘状态下枪锁驱动           |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 绝缘状态下枪锁反馈           | 1             | 0/1   断开/锁止              |
+---------------+------------------------------+---------------+------------------------------+
| 4             | -预充电试验-                 | 2             | 0.1V/bit                     |
|               | 电池BCP电压数据              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 5             | 直流接触器闭合前的枪口电压   | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 直流接触器闭合前的模块电压   | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 7             | K1K2闭合时刻的两端电压和压差 | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 8             | -输入电流过冲试验-           | 2             | 0.1A/bit                     |
|               | k1k2闭合1s内最高电流         |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 9             | -输出设定误差试验-           | 2             | 0.1A/bit                     |
|               | 系统电流                     |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 10            | 系统电压                     | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 11            | 电表电流                     | 2             | 0.1A/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 12            | 电表电压                     | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 13            | -充电控制状态试验-           | 2             | 0.1V/bit                     |
|               | 插枪前按下枪锁CC1的电压      |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 14            | 插枪前未按下插枪前CC1的电压  | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 15            | 插枪后CC1的电压              | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
| 16            | -动力电源输入失电试验-       | 1             | 0/1   断开/锁止              |
|               | 枪锁反馈                     |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 17            | 断开枪锁时刻的DC电压数值     | 2             | 0.1V/bit                     |
+---------------+------------------------------+---------------+------------------------------+
|               |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
```

<a id="sec-374b03be"></a>
# 光储充报文
<a id="sec-8b8088ef"></a>
## GateWay-MCU-M2:广播数据(UDP)
<a id="cmd-701"></a>
### GateWay广播储能电池状态信息(cmd=701) [cmd=701]
    GateWay向MCU、M2广播当前储能电池状态信息。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 储能柜ID                     | 1             | 取值范围：[1,3]                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 储能柜容量                   | 4             | 单位：0.1kWh                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 储能电池状态                 | 1             | 0：开路，1：充电，2：放电                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 储能柜系统状态               | 1             | 0：初始，1：自检，2：上电                   |
|               |                              |               | 3：上电完成，4：禁充                        |
|               |                              |               | 5：禁放，6：禁止充放                        |
|               |                              |               | 7：故障，8：故障恢复                        |
|               |                              |               | 9：强制控制测试模式                         |
|               |                              |               | 10：维护模式，11：下电中                    |
|               |                              |               | 12：下电完成，13：自检完成                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 储能柜故障汇总               | 1             | 0：正常，1：轻度告警                        |
|               |                              |               | 2：中度告警，3：严重告警                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 储能柜上电模式               | 1             | 0：自动上电，1：手动上电                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 储能柜总电压                 | 2             | 单位：0.1V                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 储能柜总电流                 | 2             | 单位：0.1A                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 储能柜总 SOC                 | 2             | 单位：0.1%                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 储能柜总 SOH                 | 2             | 单位：0.1%                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 储能柜绝缘电阻 R-            | 2             | 单位：1kΩ                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 储能柜绝缘电阻 R+            | 2             | 单位：1kΩ                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 储能柜供电电压               | 2             | 单位：0.1V                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 储能柜DI 检测状态            | 2             | Bit0~bit11 分别DI1~DI12                     |
|               |                              |               | 0 为无效，1 为有效                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 储能柜DO 检测状态            | 2             | 同上                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 储能柜可充电量               | 2             | 单位：0.1kWh                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 储能柜可放电量               | 2             | 单位：0.1kWh                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 储能柜高压箱温度             | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 储能柜从控失联状态           | 1             | 从控 1~5 对应bit0~bit4，0：通信正常，1：通  |
|               |                              |               | 信失败（bit6-bit7无效，最多5个从控）        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 储能柜充放电倍率             | 2             | (电池状态)为充电（1）时为充电倍率；电池状态 |
|               |                              |               | 为放电（2）时为放电倍率，单位：0.01P；其余  |
|               |                              |               | 时候无效                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 储能柜电池故障信息           | 14            | 见光储充附录B                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22            | 空调出水温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23            | 空调回水温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24            | 空调排气温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25            | 空调环境温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26            | 空调回水压力                 | 2             | 精确到0.01Bar                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 27            | 空调出水压力                 | 2             | 精确到0.01Bar                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 28            | 空调水泵运行转速             | 2             | 范围[0,1000]，精确到0.1%                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 29            | 空调水泵启停状态             | 1             | 0：关闭；1：开启                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 30            | 空调压缩机启停状态           | 1             | 0：关闭；1：开启                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 31            | 空调系统运行模式             | 1             | 0:停止;1:自循环;2:制冷;                     |
|               |                              |               | 3:加热;4:全自动;                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 32            | 空调机组开关机状态           | 1             | 0：关机；1：开机。                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 33            | 空调电加热启停状态           | 1             | 0：关机；1：开机。                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 34            | 空调外风机运行转速           | 1             | 范围[0,100]，单位：%                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 35            | 空调压缩机运行转速           | 1             | 范围[0,100]，单位：%                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 36            | 空调系统开关机               | 1             | 0:关机;1:开机;                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 37            | 空调运行模式                 | 1             | 0:停止;1:自循环;2:制冷;                     |
|               |                              |               | 3:加热;4:全自动;                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 38            | 空调当前告警最高等级         | 1             | 0：无告警；1：一级告警；                    |
|               |                              |               | 2：二级告警；3：三级告警；                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 39            | 空调故障信息                 | 6             | 见光储充附录A                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 40            | 消防内置温度                 | 2             | 40度偏移，精度：1℃                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 41            | 消防外置温度                 | 2             | 40度偏移，精度：1℃                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 42            | 消防温度报警状态             | 1             | 0：无报警，1：声光报警                      |
|               |                              |               | 2：启动灭火装置                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 43            | 烟雾传感器值                 | 2             | 范围0-3300（毫伏），烟雾传感器电压值        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 44            | 烟雾传感器报警状态           | 1             | 0：烟雾没有超标                             |
|               |                              |               | 1：烟雾超标报警                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 45            | 烟雾等级                     | 1             | 烟雾0~490nv＝0                              |
|               |                              |               | 烟雾 491~1031mv＝1                          |
|               |                              |               | 烟雾 1032~1499 mv＝2                        |
|               |                              |               | 烟雾 1500~2085 mv＝3                        |
|               |                              |               | 烟雾 2086~3300（最大量称） mv＝4            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 46            | 一氧化碳传感器值             | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 47            | 一氧化碳传感器报警状态       | 1             | 0：一氧化碳没有超标                         |
|               |                              |               | 1：一氧化碳超标报警                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 48            | 一氧化碳等级                 | 1             | 一氧化碳0~199mv＝0                          |
|               |                              |               | 一氧化碳 200~399 mv＝1                      |
|               |                              |               | 一氧化碳 400~599 mv＝2                      |
|               |                              |               | 一氧化碳 600~719 mv＝3                      |
|               |                              |               | 一氧化碳720~2000 mv（最大量称）＝4          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 49            | 灭火装置反馈状态值           | 1             | 0：无动作，1：已动作                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 50            | 消防故障状态                 | 1             | 0：无故障，1：有故障                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 51            | 消防故障信息                 | 8             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 52            | 电池总循环次数               | 2             | 电池循环参考次数：6000次                    |
|               | (电池寿命)                   |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-702"></a>
### GateWay广播储能单体信息(cmd=702) [cmd=702]
    GateWay向MCU、M2广播储能单体信息。

```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 储能柜ID                     | 1             | 取值范围：    |
|               |                              |               | [1,3]         |
+---------------+------------------------------+---------------+---------------+
| 2             | 单体最高电压                 | 2             | 精确到0.001V  |
+---------------+------------------------------+---------------+---------------+
| 3             | 单体最低电压                 | 2             | 精确到0.001V  |
+---------------+------------------------------+---------------+---------------+
| 4             | 单体平均电压                 | 2             | 精确到0.001V  |
+---------------+------------------------------+---------------+---------------+
| 5             | 单体压差                     | 2             | 精确到0.001V  |
+---------------+------------------------------+---------------+---------------+
| 6             | 单体最高温度                 | 2             | 精确到0.1℃   |
+---------------+------------------------------+---------------+---------------+
| 7             | 单体最低温度                 | 2             | 精确到0.1℃   |
+---------------+------------------------------+---------------+---------------+
| 8             | 单体平均温度                 | 2             | 精确到0.1℃   |
+---------------+------------------------------+---------------+---------------+
| 9             | 单体温差                     | 2             | 精确到0.1℃   |
+---------------+------------------------------+---------------+---------------+
| 10            | 单体最高电压序号             | 2             | 范围1-260     |
+---------------+------------------------------+---------------+---------------+
| 11            | 单体最低电压序号             | 2             | 范围1-260     |
+---------------+------------------------------+---------------+---------------+
| 12            | 单体最高温度序号             | 2             | 范围1-260     |
+---------------+------------------------------+---------------+---------------+
| 13            | 单体最低温度序号             | 2             | 范围1-260     |
+---------------+------------------------------+---------------+---------------+
| 14            | 单体最高电压所在模块         | 1             | 范围1-5       |
+---------------+------------------------------+---------------+---------------+
| 15            | 单体最低电压所在模块         | 1             | 范围1-5       |
+---------------+------------------------------+---------------+---------------+
| 16            | 单体最高温度所在模块         | 1             | 范围1-5       |
+---------------+------------------------------+---------------+---------------+
| 17            | 单体最低温度所在模块         | 1             | 范围1-5       |
+---------------+------------------------------+---------------+---------------+
| 18            | 单体总个数                   | 2             | 范围[1-52]    |
+---------------+------------------------------+---------------+---------------+
```


<a id="cmd-703"></a>
### GateWay广播储能单体电压信息(cmd=703) [cmd=703]
    电池配置信息优先于电池的其他信息上报

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 储能柜ID      | 1             | 取值范围：    |
|               |               |               | [1,3]         |
+---------------+---------------+---------------+---------------+
| 2             | 从控ID        | 1             | 取值范围：    |
|               |               |               | [1,5]         |
+---------------+---------------+---------------+---------------+
| 3             | 单体总个数    | 2             | 范围[1-52]    |
+---------------+---------------+---------------+---------------+
| 4             | 单体1电压     | 2             | 单位：0.001V  |
|               |               |               | ；            |
+---------------+---------------+---------------+---------------+
|               | ...           |               |               |
+---------------+---------------+---------------+---------------+
|               | 单体N电压     | 2             | N取值范围     |
|               |               |               | [1-52]        |
+---------------+---------------+---------------+---------------+
|               |               |               |               |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-704"></a>
### GateWay广播储能单体温度信息(cmd=704) [cmd=704]
    电池配置信息优先于电池的其他信息上报

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 储能柜ID      | 1             | 取值范围：    |
|               |               |               | [1,3]         |
+---------------+---------------+---------------+---------------+
| 2             | 从控ID        | 1             | 取值范围：    |
|               |               |               | [1,5]         |
+---------------+---------------+---------------+---------------+
| 3             | 单体总个数    | 2             | 范围[1-52]    |
+---------------+---------------+---------------+---------------+
| 4             | 单体1温度     | 2             | 精确到0.1℃   |
+---------------+---------------+---------------+---------------+
|               | ...           |               |               |
+---------------+---------------+---------------+---------------+
|               | 单体N温度     | 2             | 精确到0.1℃   |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-705"></a>
### GateWay广播储能极柱详细信息(cmd=705) [cmd=705]
    GateWay向MCU、M2广播当前电池状态信息。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 储能柜ID                     | 1             | 取值范围：[1,3]                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | PACK总个数                   | 2             | 范围1-5                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 极柱最高温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 极柱最低温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 极柱平均温度                 | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 极柱温差                     | 2             | 精确到0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 极柱最高温度所在序号         | 1             | 范围1-10                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 极柱最低温度所在序号         | 1             | 范围1-10                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 极柱最高温度所在PACK         | 1             | 范围1-5                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 极柱最低温度所在PACK         | 1             | 范围1-5                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | PACK 1极柱温度1              | 2             | 说明：一个PACK上有两个极柱温度采样。        |
|               |                              |               | 单位：0.1℃                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | PACK 1极柱温度2              | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | ....                         |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | PACK N极柱温度1              | 2             | N范围1-5                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | PACK N极柱温度2              | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-706"></a>
### GateWay广播储能柜空调累计信息(cmd=706) [cmd=706]
    GateWay向MCU、M2广播当前电池极柱信息

```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 储能柜ID                     | 1             | 取值范围：    |
|               |                              |               | [1,3]         |
+---------------+------------------------------+---------------+---------------+
| 2             | 空调压缩机总运行时间         | 2             | 单位：h       |
+---------------+------------------------------+---------------+---------------+
| 3             | 空调压缩机开启次数           | 4             |               |
+---------------+------------------------------+---------------+---------------+
| 4             | 空调电加热总运行时间         | 2             | 单位：h       |
+---------------+------------------------------+---------------+---------------+
| 5             | 空调电加热开启次数           | 4             |               |
+---------------+------------------------------+---------------+---------------+
| 6             | 空调水泵总运行时间           | 2             | 单位：h       |
+---------------+------------------------------+---------------+---------------+
| 7             | 空调水泵开启次数             | 4             |               |
+---------------+------------------------------+---------------+---------------+
| 8             | 空调外风机总运行时间         | 2             | 单位：h       |
+---------------+------------------------------+---------------+---------------+
| 9             | 空调外风机开启次数           | 4             |               |
+---------------+------------------------------+---------------+---------------+
```

<a id="cmd-707"></a>
### GateWay广播储能累计信息(cmd=707) [cmd=707]
    GateWay向MCU、M2广播当前电池累计信息。

```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 储能柜ID                     | 1             | 取值范围：    |
|               |                              |               | [1,3]         |
+---------------+------------------------------+---------------+---------------+
| 2             | 储能单日放电总电量           | 4             | 0.1kWh        |
+---------------+------------------------------+---------------+---------------+
| 3             | 储能单日蓄电总电量           | 4             | 0.1kWh        |
+---------------+------------------------------+---------------+---------------+
| 4             | 储能单日放电尖电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 5             | 储能单日放电峰电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 6             | 储能单日放电平电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 7             | 储能单日放电谷电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 8             | 储能单日放电其他电量         | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 9             | 储能单日蓄电尖电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 10            | 储能单日蓄电峰电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 11            | 储能单日蓄电平电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 12            | 储能单日蓄电谷电量           | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 13            | 储能单日蓄电其他电量         | 4             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
```


<a id="sec-4b9aba38"></a>
## M2-MCU:广播数据(UDP)
<a id="cmd-801"></a>
### M2广播光伏状态信息(cmd=801) [cmd=801]
    注：固定上报14个通道数据，未使用数据传0。

```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 系统铺设的光伏最大功率       | 4             | 单位：0.1kW   |
+---------------+------------------------------+---------------+---------------+
| 2             | 光伏通道1总功率              | 4             | 单位：0.1kW   |
+---------------+------------------------------+---------------+---------------+
| 3             | 光伏通道1电压                | 2             | 单位：0.1V    |
+---------------+------------------------------+---------------+---------------+
| 4             | 光伏通道1电流                | 2             | 单位：0.1A    |
+---------------+------------------------------+---------------+---------------+
|               | ...                          |               |               |
+---------------+------------------------------+---------------+---------------+
|               | 光伏通道14总功率             | 4             |               |
+---------------+------------------------------+---------------+---------------+
|               | 光伏通道14输入电压           | 2             |               |
+---------------+------------------------------+---------------+---------------+
```


<a id="cmd-802"></a>
### M2广播光伏单通道详细信息(cmd=802) [cmd=802]
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 光伏模块ID    | 1             | 取值范围：    |
|               |               |               | 1-14          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```

<a id="cmd-803"></a>
### M2广播光伏累计信息(cmd=803) [cmd=803]
```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 光伏单日累计发电总电量       | 2             | 0.1kWh        |
+---------------+------------------------------+---------------+---------------+
| 2             | 光伏单日发电尖电量           | 2             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 3             | 光伏单日发电峰电量           | 2             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 4             | 光伏单日发电平电量           | 2             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 5             | 光伏单日发电谷电量           | 2             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
| 6             | 光伏单日发电其他电量         | 2             | 0.1kWh，预留  |
+---------------+------------------------------+---------------+---------------+
```


<a id="cmd-804"></a>
### M2广播系统功率路由状态(cmd=804) [cmd=804]
```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 三相电网实时方向             | 1             | 0：输出(系统使用电网的电)                   |
|               |                              |               | 1：馈电(系统给电网放电)                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 三相电网实时功率             | 4             | 0.1kW                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 储能电池实时方向             | 1             | 0：输出                                     |
|               |                              |               | 1：蓄电                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 储能电池实时功率             | 4             | 0.1kW                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 光伏实时功率                 | 4             | 0.1kW                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 车辆充电实时功率             | 4             | 0.1kW                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 车辆放电实时功率             | 4             | 0.1kW                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 调度策略标识                 | 4             | 平台下发的调度策略标识                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 系统工作模式                 | 1             | 0-自动调控(桩依据尖峰平谷时段-4403自动能源  |
|               |                              |               | 调控)；                                     |
|               |                              |               | 1-平台手动调控：平台主动调控模式            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 系统的工作状态设置           | 1             | Bit位表示（0：使用，1禁用）；               |
|               |                              |               | Bit0:0-电网使用,1-电网禁用;(电网输出和上网  |
|               |                              |               | 全禁止)                                     |
|               |                              |               | Bit1:0-光伏使用,1-光伏禁用；(光伏放电禁止)  |
|               |                              |               | Bit2:0-储能使用，1-储能禁用; (储能输出和蓄  |
|               |                              |               | 电全禁止)                                   |
|               |                              |               | Bit3:0-充电桩使用，1-充电桩禁用; (充电桩全  |
|               |                              |               | 都不能充电和放电)                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 光伏输出限制功率             | 2             | 0.1kwh                                      |
|               |                              |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 储能电池功率方向             | 1             | 0：输出                                     |
|               |                              |               | 1：蓄电                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 储能输出限制功率             | 2             | 0.1kwh                                      |
|               | (储能对电网/车)              |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 储能输出限制soc              | 2             | 0.1，最终停止soc                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 储能蓄电限制功率             | 2             | 0.1kwh                                      |
|               | (外部对储能电池)             |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 储能蓄电限制soc              | 2             | 0.1，最终停止soc                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 电网输出限制功率             | 2             | 0.1kwh                                      |
|               | (电网对系统)                 |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 光储对电网放电               | 1             | 0：允许光储对电网放电                       |
|               |                              |               | 1：禁止光储对电网放电                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | V2G对电网放电                | 1             | 0：允许V2G对电网放电                        |
|               |                              |               | 1：禁止V2G对电网放电                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 电网馈电限制功率             | 2             | 0.1kwh                                      |
|               | (系统对电网)                 |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-805"></a>
### M2广播电网时段调度策略(cmd=805) [cmd=805]
    注：时间需要满足0-24；

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 有效时段个数                 | 1             | N,取值范围：[1-24]           |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 调度策略标识                 | 4             | 平台下发的调度策略标识       |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 时段1费率类型                | 1             | 其他                         |
|               |                              |               | 尖                           |
|               |                              |               | 峰                           |
|               |                              |               | 平                           |
|               |                              |               | 4-谷                         |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 时段1费率开始时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
| 5             | 时段1费率结束时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 时段2费率类型                | 1             | 其他                         |
|               |                              |               | 尖                           |
|               |                              |               | 峰                           |
|               |                              |               | 平                           |
|               |                              |               | 4-谷                         |
+---------------+------------------------------+---------------+------------------------------+
| 7             | 时段2费率开始时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
| 8             | 时段2费率结束时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
|               | …..                         |               | …..                         |
+---------------+------------------------------+---------------+------------------------------+
|               | 时段N费率类型                | 1             | 其他                         |
|               |                              |               | 尖                           |
|               |                              |               | 峰                           |
|               |                              |               | 平                           |
|               |                              |               | 4-谷                         |
+---------------+------------------------------+---------------+------------------------------+
|               | 时段N费率开始时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
|               | 时段N费率结束时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
```


<a id="sec-f805412d"></a>
## M2-MCU-GATEWAY:点对点数据(UDP)
<a id="cmd-901"></a>
### MCU应答请求(cmd=901) [cmd=901]
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 命令CMD       | 2             | 与请求CMD一致 |
+---------------+---------------+---------------+---------------+
| 2             | 结果          | 1             | 0-成功；1-失  |
|               |               |               | 败            |
+---------------+---------------+---------------+---------------+
```

<a id="sec-cae268af"></a>
### M2/GATEWAY请求MCU下发指令(902)
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 命令CMD       | 2             |               |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-903"></a>
### MCU请求数据同步指令(cmd=903) [cmd=903]
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 命令CMD       | 2             |               |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-904"></a>
### M2/GATEWAY应答MCU数据同步请求(cmd=904) [cmd=904]
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 命令CMD       | 2             | 与请求CMD一致 |
+---------------+---------------+---------------+---------------+
| 2             | 结果          | 1             | 0-成功；1-失  |
|               |               |               | 败            |
+---------------+---------------+---------------+---------------+
```


<a id="cmd-905"></a>
### MCU-M2,MCU下发电网时段调度策略(cmd=905) [cmd=905]
```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 有效时段个数                 | 1             | 取值范围：[1-24]             |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 调度策略标识                 | 4             | 平台下发的调度策略标识       |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 时段1费率类型                | 1             | 0-其他                       |
|               |                              |               | 1-尖                         |
|               |                              |               | 2-峰                         |
|               |                              |               | 3-平                         |
|               |                              |               | 4-谷                         |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 时段1费率开始时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
| 5             | 时段1费率结束时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 时段2费率类型                | 1             | 0-其他                       |
|               |                              |               | 1-尖                         |
|               |                              |               | 2-峰                         |
|               |                              |               | 3-平                         |
|               |                              |               | 4-谷                         |
+---------------+------------------------------+---------------+------------------------------+
| 7             | 时段2费率开始时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
| 8             | 时段2费率结束时间            | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
|               | …..                         |               | …..                         |
+---------------+------------------------------+---------------+------------------------------+
|               | 时段24费率类型               | 1             | 0-其他                       |
|               |                              |               | 1-尖                         |
|               |                              |               | 2-峰                         |
|               |                              |               | 3-平                         |
|               |                              |               | 4-谷                         |
+---------------+------------------------------+---------------+------------------------------+
|               | 时段24费率开始时间           | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
|               | 时段24费率结束时间           | 4             | 单位分钟                     |
+---------------+------------------------------+---------------+------------------------------+
```



<a id="cmd-906"></a>
### M2-MCU,M2应答电网时段调度策略(cmd=906) [cmd=906]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 调度策略标识  | 4             | 平台下发的调度策略标识                      |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 有效时段个数  | 1             | 取值范围：[1-24]                            |
+---------------+---------------+---------------+---------------------------------------------+
| 3             | 结果          | 1             | 0-成功；1-失败                              |
+---------------+---------------+---------------+---------------------------------------------+
| 4             | 失败原因      | 1             | 0-时段错误；1-时段标志错误；255-其他        |
+---------------+---------------+---------------+---------------------------------------------+
```


<a id="cmd-907"></a>
### MCU-M2,MCU下发光储充工作模式设置(cmd=907) [cmd=907]
```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 系统工作模式                 | 1             | 0-自动调控(桩依据尖峰平谷时段-4403自动能源  |
|               |                              |               | 调控)；                                     |
|               |                              |               | 1-平台手动调控：平台主动调控模式            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 系统的工作状态设置           | 1             | Bit位表示（0：使用，1禁用）；               |
|               |                              |               | Bit0:0-电网使用,1-电网禁用;(电网输出和上网  |
|               |                              |               | 全禁止)                                     |
|               |                              |               | Bit1:0-光伏使用,1-光伏禁用；(光伏放电禁止)  |
|               |                              |               | Bit2:0-储能使用，1-储能禁用; (储能输出和蓄  |
|               |                              |               | 电全禁止)                                   |
|               |                              |               | Bit3:0-充电桩使用，1-充电桩禁用; (充电桩全  |
|               |                              |               | 都不能充电和放电)                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 光伏输出限制功率             | 2             | 0.1kwh                                      |
|               |                              |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 储能电池功率方向             | 1             | 0：输出                                     |
|               |                              |               | 1：蓄电                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 储能输出限制功率             | 2             | 0.1kwh                                      |
|               | (储能对电网/车)              |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 储能输出限制soc              | 2             | 0.1，最终停止soc                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 储能蓄电限制功率             | 2             | 0.1kwh                                      |
|               | (外部对储能电池)             |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 储能蓄电限制soc              | 2             | 0.1，最终停止soc                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 电网输出限制功率             | 2             | 0.1kwh                                      |
|               | (电网对系统)                 |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 光储对电网放电               | 1             | 0：允许光储对电网放电                       |
|               |                              |               | 1：禁止光储对电网放电                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | V2G对电网放电                | 1             | 0：允许V2G对电网放电                        |
|               |                              |               | 1：禁止V2G对电网放电                        |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | 电网馈电限制功率             | 2             | 0.1kwh                                      |
|               | (系统对电网)                 |               | （非0生效）                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-908"></a>
### M2-MCU,M2应答光储充放工作模式设置(cmd=908) [cmd=908]
```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 调度策略标识  | 4             | 平台下发的调度策略标识       |
+---------------+---------------+---------------+------------------------------+
| 2             | 生效时段      | 1             | 取值范围：[1-24]             |
+---------------+---------------+---------------+------------------------------+
| 3             | 结果          | 1             | 0-成功；1-失败               |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-909"></a>
### MCU应答gateway注册请求(cmd=909) [cmd=909]
```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 储能柜ID                     | 1             | 取值范围：    |
|               |                              |               | [1,3]         |
+---------------+------------------------------+---------------+---------------+
| 2             | GATEWAY主版本信息            | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 3             | GATEWAY子版本信息            | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 4             | 电池硬件主版本号             | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 5             | 电池硬件子版本号             | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 6             | 电池基础软件主版本信息       | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 7             | 电池基础软件子版本信息       | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 8             | 电池项目程序主名称           | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 9             | 电池项目程序子名称           | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 10            | 电池项目程序主版本信息       | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 11            | 电池项目程序子版本信息       | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 12            | 空调软件编码                 | 2             |               |
+---------------+------------------------------+---------------+---------------+
| 13            | 空调软件版本                 | 2             |               |
+---------------+------------------------------+---------------+---------------+
```



<a id="cmd-910"></a>
### GateWay版本注册帧(cmd=910) [cmd=910]
    1. gateway上电发送签到到MCU，如果MCU没有回复，持续周期发送。

    2. 版本变更时发送

```text
+---------------+------------------------------+---------------+---------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明          |
+---------------+------------------------------+---------------+---------------+
| 1             | 储能柜ID                     | 1             | 取值范围：    |
|               |                              |               | [1,3]         |
+---------------+------------------------------+---------------+---------------+
| 2             | GATEWAY主版本号              | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 3             | GATEWAY子版本号              | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 4             | 电池硬件主版本号             | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 5             | 电池硬件子版本号             | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 6             | 电池基础软件主版本号         | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 7             | 电池基础软件子版本号         | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 8             | 电池项目程序主名称           | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 9             | 电池项目程序子名称           | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 10            | 电池项目程序主版本号         | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 11            | 电池项目程序子版本号         | 1             |               |
+---------------+------------------------------+---------------+---------------+
| 12            | 空调软件编码                 | 2             |               |
+---------------+------------------------------+---------------+---------------+
| 13            | 空调软件版本                 | 2             |               |
+---------------+------------------------------+---------------+---------------+
```


<a id="sec-9d6193c2"></a>
# SECC_PLC报文
<a id="sec-72515a82"></a>
## 充电部分
<a id="cmd-1001"></a>
### 状态上传报文(cmd=1001)点对点UDP报文 [cmd=1001]


<a id="sec-627e7e8c"></a>
# 附录1：主机状态
    主机状态1：

```text
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 0         | 热电偶1反馈 - 未使用                        |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 1         | 热电偶2反馈- 未使用                         |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 2         | 热电偶3反馈- 未使用                         |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 3         | 热电偶4反馈- 未使用                         |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 4         | 预留隔离反馈1 0-断开  1-闭合                |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 5         | 预留隔离反馈2  0-断开  1-闭合               |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 6         | 倾斜 0-正常  1-触发                         |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 7         | 水浸   0-正常  1-触发                       |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 0         | 防雷1  0-正常  1-触发                       |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 1         | 防雷2   0-正常  1-触发                      |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 2         | 断路器1   0-闭合  1-断开                    |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 3         | 断路器2   0-闭合  1-断开                    |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 4         | 预留非隔离反馈1 0-断开  1-闭合              |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 5         | 预留非隔离反馈2  0-断开  1-闭合             |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 6         | 门禁1   0-关门   1-开门                     |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 7         | 门禁2   0-关门   1-开门                     |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 0         | 门禁3   0-关门   1-开门                     |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 1         | 预留输入干接点1   0-断开  1-闭合            |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 2         | 预留输入干接点2   0-断开  1-闭合            |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 3         | 主机掉电保护   0-正常  1-断电               |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 4         | 硬件版本1                                   |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 5         | 硬件版本2                                   |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 6         | LED状态                                     |
|               |               | 00：R   01:G   10:B                         |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 7         | LED状态                                     |
|               |               | 00：R   01:G   10:B                         |
+---------------+---------------+---------------------------------------------+
```


```text
+---------------+---------------+------------------------------+
| Byte4         | Bit 0         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 1         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 2         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 3         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 4         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 5         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 6         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
| Byte4         | Bit 7         | 风扇调速大小--主机           |
|               |               | 0-100                        |
+---------------+---------------+------------------------------+
```







    主机状态2：

```text
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 0         | 门禁4   0-关门   1-开门                     |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 1         | 门禁5   0-关门   1-开门                     |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 2         | 门禁6   0-关门   1-开门                     |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 3         | C2掉电保护  0-正常  1-断电                  |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 4         | 断路器3   0-闭合  1-断开                    |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 5         | 断路器4   0-闭合  1-断开                    |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 6         | 防雷3   0-正常  1-触发                      |
+---------------+---------------+---------------------------------------------+
| Byte1         | Bit 7         | 防雷4   0-正常  1-触发                      |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 0         | 断上级开关    0-正常  1-触发                |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 1         | 急停状态   0-正常  1-触发                   |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 2         | 液位状态   0-正常   1- 缺液  （液冷主机）   |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 3         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 4         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 5         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 6         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte2         | Bit 7         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 0         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 1         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 2         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 3         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 4         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 5         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 6         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte3         | Bit 7         |                                             |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 0         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 1         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 2         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 3         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 4         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 5         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 6         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
| Byte4         | Bit 7         | 风扇调速大小--C2                            |
|               |               | 0-100                                       |
+---------------+---------------+---------------------------------------------+
```

    主机状态3：预留

    主机状态4：预留


    附录2 33008测试结果

    1通过 /  0不通过

```text
+---------------+---------------+------------------------------+
| Byte1         | Bit 0         | 保护接地连续性试验           |
+---------------+---------------+------------------------------+
| Byte1         | Bit 1         | 连续信号检测试验             |
+---------------+---------------+------------------------------+
| Byte1         | Bit 2         | 急停试验结果                 |
+---------------+---------------+------------------------------+
| Byte1         | Bit 3         | 舱门试验结果                 |
+---------------+---------------+------------------------------+
| Byte1         | Bit 4         | 预留                         |
+---------------+---------------+------------------------------+
| Byte1         | Bit 5         | 预留                         |
+---------------+---------------+------------------------------+
| Byte1         | Bit 6         | 预留                         |
+---------------+---------------+------------------------------+
| Byte1         | Bit 7         | 预留                         |
+---------------+---------------+------------------------------+
| Byte2         | Bit 0         | 车辆插头锁止试验结果         |
+---------------+---------------+------------------------------+
| Byte2         | Bit 1         | 预充电试验结果               |
+---------------+---------------+------------------------------+
| Byte2         | Bit 2         | 输入电流过冲试验结果         |
+---------------+---------------+------------------------------+
| Byte2         | Bit 3         | 输出电流设定误差试验结果     |
+---------------+---------------+------------------------------+
| Byte2         | Bit 4         | 输出电压设定误差试验结果     |
+---------------+---------------+------------------------------+
| Byte2         | Bit 5         | 充电控制状态试验结果         |
+---------------+---------------+------------------------------+
| Byte2         | Bit 6         | 充电连接时序                 |
+---------------+---------------+------------------------------+
| Byte2         | Bit 7         | 限流特性试验                 |
+---------------+---------------+------------------------------+
| Byte3         | Bit 0         | 动力电源输入失电试验结果     |
+---------------+---------------+------------------------------+
| Byte3         | Bit 1         | 通讯中断失电试验结果         |
+---------------+---------------+------------------------------+
| Byte3         | Bit 2         | 过温保护试验结果             |
+---------------+---------------+------------------------------+
| Byte3         | Bit 3         | 蓄电池反接试验               |
+---------------+---------------+------------------------------+
| Byte3         | Bit 4         | 防逆流试验                   |
+---------------+---------------+------------------------------+
| Byte3         | Bit 5         | 充电功能试验                 |
+---------------+---------------+------------------------------+
| Byte3         | Bit 6         | 接触器粘连试验               |
+---------------+---------------+------------------------------+
| Byte3         | Bit 7         | 接触器粘连试验               |
+---------------+---------------+------------------------------+
```


```text
+---------------+---------------+---------------+
| Byte4         | Bit 0         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 1         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 2         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 3         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 4         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 5         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 6         |               |
+---------------+---------------+---------------+
| Byte4         | Bit 7         |               |
+---------------+---------------+---------------+
```




