

    充电机智能终端与智能中心管理系统


    通迅协议


    目录

    一、网络拓扑	4

    1.1  功能界定	4

    1.1.1 充电机智能终端	4

    1.1.2 智能中心管理系统	4

    1.2  接口定义	4

    1.3  通信方式	4

    1.4  通信规约	5

    1.5  报文格式	7

    1.6  关键命令	8

    二、应用层	9

    2.1  数据格式：	9

    2.2  心跳包机制	9

    2.3  计费方式	10

    2.4  扫码充电	10

    2.5  刷卡充电	12

    2.6  预约充电	13

    2.7  离线充电	14

    2.8  即插即充	14

    2.9  典型处理流程	15

    2.9.1 连接和注册	15

    2.9.2 远程升级	16

    2.9.3 状态报文上报	17

    2.9.4 告警信息上报	18

    2.10  充电记录上报规则	19

    2.10.1 冗余规则	19

    2.10.2 重复规则	19

    2.10.3 过滤规则	19

    2.10.4 实时规则	19

    2.10.5 完整性规则	19

    三、协议格式	20

    3.1  服务器向充电桩设置/查询工作参数和命令	20

<a id="cmd-001"></a>
### 3.1.1  (cmd=1)后台服务器下发充电桩整形工作参数	20 [cmd=001]

<a id="cmd-002"></a>
### 3.1.2  (cmd=2)充电桩参数整形设置/查询应答	29 [cmd=002]

<a id="cmd-003"></a>
### 3.1.3  (cmd=3)后台服务器下发充电桩字符型参数	29 [cmd=003]

<a id="cmd-004"></a>
### 3.1.4  (cmd=4)充电桩参数字符形设置/查询应答	31 [cmd=004]

<a id="cmd-005"></a>
### 3.1.5  (cmd=5)后台服务器下发充电桩控制命令	32 [cmd=005]

<a id="cmd-006"></a>
### 3.1.6  (cmd=6)充电桩对后台控制命令应答	35 [cmd=006]

<a id="cmd-007"></a>
### 3.1.7  (cmd=7)后台服务器下发充电桩开启充电控制命令	35 [cmd=007]

<a id="cmd-008"></a>
### 3.1.8  (cmd=8) 充电桩对后台下发的充电桩开启充电控制应答	37 [cmd=008]

<a id="cmd-009"></a>
### 3.1.9  (cmd=9)后台服务器应答桩上传命令请求(预留)	38 [cmd=009]

<a id="cmd-010"></a>
### 3.1.10 (cmd=10)充电桩上传命令请求(预留)	38 [cmd=010]

<a id="cmd-011"></a>
### 3.1.11 (cmd=11)服务器查询充电桩软件版本(非必实现功能)	39 [cmd=011]

<a id="cmd-012"></a>
### 3.1.11 (cmd=12)充电桩应答软件版本(非必实现功能)	40 [cmd=012]

    3.2  充电桩主动上传数据	40

<a id="cmd-101"></a>
### 3.2.1  (cmd=101)服务器应答心跳包信息	40 [cmd=101]

<a id="cmd-102"></a>
### 3.2.2  (cmd=102)充电桩上传心跳包信息	41 [cmd=102]

<a id="cmd-103"></a>
### 3.2.3  (cmd=103)服务器应答充电桩状态信息包	41 [cmd=103]

<a id="cmd-104"></a>
### 3.2.4  (cmd=104)充电桩状态信息包上报	42 [cmd=104]

<a id="cmd-105"></a>
### 3.2.5  (cmd=105)服务器应答充电桩签到命令	46 [cmd=105]

<a id="cmd-106"></a>
### 3.2.6  (cmd=106)充电桩签到信息上报	47 [cmd=106]

<a id="cmd-107"></a>
### 3.2.7  (cmd=107)服务器应答充电桩告警信息	49 [cmd=107]

<a id="cmd-108"></a>
### 3.2.8  (cmd=108)充电桩告警信息上报(预留)	49 [cmd=108]

<a id="cmd-109"></a>
### 3.2.9  (cmd=109)服务器应答充电桩启动完成命令	50 [cmd=109]

<a id="cmd-110"></a>
### 3.2.10 (cmd=110)充电桩上报充电启动完成命令(可选项)	50 [cmd=110]

<a id="cmd-111"></a>
### 3.2.11 (cmd=111)服务器应答充电桩上报模块信息(预留)	52 [cmd=111]

<a id="cmd-112"></a>
### 3.2.12 (cmd=112)充电桩模块信息上报(预留)	53 [cmd=112]

<a id="cmd-113"></a>
### 3.2.13 (cmd=113)服务器查询最近一次充电各时段信息	54 [cmd=113]

<a id="cmd-114"></a>
### 3.2.14 (cmd=114)充电桩应答服务器查询最近一次充电各时段信息	54 [cmd=114]

    3.3  充电信息数据	57

    3.3.1  (CMD=201/221)服务器应答充电桩上报充电信息报文	57

    3.3.2  (CMD=202/222)充电桩上报充电记录信息	57

<a id="cmd-203"></a>
### 3.3.3  (cmd=203)服务器应答帐户查询信息	66 [cmd=203]

<a id="cmd-204"></a>
### 3.3.4  (cmd=204)充电桩充电上传用户帐户查询报文	67 [cmd=204]

<a id="cmd-205"></a>
### 3.3.5  (cmd=205)服务器应答充电密码验证报文(预留)	68 [cmd=205]

<a id="cmd-206"></a>
### 3.3.6  (cmd=206)充电桩上传用户密码验证报文(预留)	69 [cmd=206]

<a id="cmd-207"></a>
### 3.3.7  (cmd=207) 平台回复”即插即充“请求充电结果	70 [cmd=207]

<a id="cmd-208"></a>
### 3.3.8  (cmd=208) 充电桩上报“即插即充“启动充电请求	70 [cmd=208]

<a id="cmd-209"></a>
### 3.3.9  (cmd=209) 平台回复“即插即充” 启动充电结果(没用)	71 [cmd=209]

<a id="cmd-210"></a>
### 3.3.10 (cmd=210)充电桩上报“即插即充” 启动充电结果(没用)	71 [cmd=210]

    3.4  直流充电桩BMS信息数据(预留)	71

<a id="cmd-301"></a>
### 3.4.1  (cmd=301)服务器应答充电桩上报BMS信息	72 [cmd=301]

<a id="cmd-302"></a>
### 3.4.2  (cmd=302)充电桩上报BMS信息	72 [cmd=302]

<a id="cmd-303"></a>
### 3.4.3  (cmd=303)服务器应答充电桩上报BMS信息	77 [cmd=303]

<a id="cmd-304"></a>
### 3.4.4  (cmd=304)充电桩上报BMS信息(预留-暂时不用)	78 [cmd=304]

    3.5  历史记录	79

    3.5.3  (CMD=401/421)服务器查询充电桩历史充电记录	79

    3.5.4  (CMD=402/422)充电桩上报历史的充电记录	79

    3.6  升级命令	85

<a id="cmd-1001"></a>
### 3.6.1  (cmd=1001)服务器下发擦除指令	85 [cmd=1001]

<a id="cmd-1002"></a>
### 3.6.2  (cmd=1002)充电桩回复服务器下发擦除指令	85 [cmd=1002]

<a id="cmd-1003"></a>
### 3.6.3  (cmd=1003)服务器下发升级文件名指令	85 [cmd=1003]

<a id="cmd-1004"></a>
### 3.6.4  (cmd=1004) 充电桩应答服务器下发升级文件名指令	86 [cmd=1004]

<a id="cmd-1005"></a>
### 3.6.5  (cmd=1005)服务器下发升级文件大小	86 [cmd=1005]

<a id="cmd-1006"></a>
### 3.6.6  (cmd=1006)充电桩应答服务器下发升级文件大小指令	86 [cmd=1006]

<a id="cmd-1007"></a>
### 3.6.7  (cmd=1007)服务器下发升级文件数据	87 [cmd=1007]

<a id="cmd-1008"></a>
### 3.6.8  (cmd=1008)充电桩应答服务器下发升级文件数据指令	87 [cmd=1008]

<a id="cmd-1009"></a>
### 3.6.9  (cmd=1009)服务器下发升级文件数据结束指令	88 [cmd=1009]

<a id="cmd-1010"></a>
### 3.6.10 (cmd=1010)充电桩应答服务器下发升级文件数据结束指令	88 [cmd=1010]

<a id="cmd-1011"></a>
### 3.6.11 (cmd=1011)服务器下发重启指令	88 [cmd=1011]

<a id="cmd-1012"></a>
### 3.6.12 (cmd=1012)充电桩应答服务器下发重启指令	88 [cmd=1012]

<a id="cmd-1021"></a>
### 3.6.13 (cmd=1021)服务器回复充电桩主动请求升级命令	88 [cmd=1021]

<a id="cmd-1022"></a>
### 3.6.14 (cmd=1022)充电桩主动请求升级命令	89 [cmd=1022]

    3.7  与计费策略相关的指令	91

    3.7.1  （CMD=1101）后台服务器查询24时电费计价策略信息	91

    3.7.2  （CMD=1102）充电桩应答后台服务器查询24时电费计价策略信息	91

    3.7.3  （CMD=1103）后台服务器设置24时段电费计价策略信息	94

    3.7.4  （CMD=1104）充电桩应答后台服务器设置24时电费计价策略信息	98

    3.7.5  （CMD=1105）后台服务器设置分时段计价策略信息	98

    3.7.6  （CMD=1106）充电桩应答后台服务器设置分时段计价策略信息	99

    3.7.7  （CMD=1107）后台服务器查询分时电费计价策略信息	99

    3.7.8  （CMD=1108）充电桩回复分时电费计价策略信息	99

    3.9  白名单报文	103

<a id="cmd-1301"></a>
### 3.9.1  (cmd=1301)服务器下发白名单操作日志数据包	103 [cmd=1301]

<a id="cmd-1302"></a>
### 3.9.2  (cmd=1302) 充电桩应答白名单操作日志数据包	104 [cmd=1302]

    3.10  FTP远程升级和FTP方式日志上传	106

<a id="cmd-1401"></a>
### 3.10.1  (cmd=1401)服务器下发FTP远程升级命令	106 [cmd=1401]

<a id="cmd-1402"></a>
### 3.10.2  (cmd=1402)充电桩应答服务器下发FTP远程升级命令	107 [cmd=1402]

<a id="cmd-1403"></a>
### 3.10.3  (cmd=1403)充电桩应答FTP升级包下载进度	107 [cmd=1403]

<a id="cmd-1406"></a>
### 3.10.3  (cmd=1406)服务器下发获取充电桩日志信息命令	107 [cmd=1406]

<a id="cmd-1407"></a>
### 3.10.4  (cmd=1407)充电桩应答服务器下发获取充电桩日志命令	108 [cmd=1407]

    3.11  协议方式日志上传	108

    3.11.1  (CMD=1501）申请上传文件	109

    3.11.2  (CMD=1502）服务器允许上传	109

    3.11.3  (CMD=1503）上传日志数据	109

    3.11.4  (CMD=1504）服务器应答上传日志	110

    3.11.5  (CMD=1505）当前文件日志数据上传完成	110

    3.11.6  (CMD=1506）当前文件接收完成	111

    附录1  告警编码定义（CMD=104最高告警码字段）	112

    附录2  停止原因编码定义	117

    附录3  充电启动失败编码定义	125

    附录4  系统告警位定义表（CMD=108全部告警内容字段）	127

    附录5  通信报文校验C参考实现	134

    符录6  通信报文交互参考流程	135

    附录7  不加密报文与加密报文说明	138

    附录8  CMD112模块告警定义	140



    版本记录

```text
+---------------+---------------------------------------------+---------------+---------------+
| 版本          | 更改说明                                    | 修改时间      | 修改人        |
+---------------+---------------------------------------------+---------------+---------------+
| V1.0          | 新拟制，报文已满足充电桩监控和运营业务需求  | 2015-7-20     | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.0          | 1.增加104报文的一些字段                     | 2016-2-10     | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.5          | 1.增加部分协议的解释说明                    | 2016-09-28    | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.5          | 2.明确后台判断充电启动成功的方法            | 2016-09-28    | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.5          | 3.104报文增加温度字段                       | 2016-09-28    | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.5          | 4.203报文的字段3响应码增加几个响应回应说明  | 2016-09-28    | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.6          | 1.CMD 204增加用户卡密码字段                 | 2016-12-14    | 郑吉祥        |
|               |                                             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.6          | 2.增加充电流水号字段                        | 2016-12-14    | 郑吉祥        |
|               |                                             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.6          | 3.增加充电结束原因列表内容                  | 2016-12-14    | 郑吉祥        |
|               |                                             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.6          | 4.增加通信加密机制和3.8节安全章节           | 2016-12-14    | 郑吉祥        |
|               |                                             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.7          | 1.为工装测试增加111、112命令                | 2017-3-9      | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.7          | 2.恢复402报文，并且完善部分报文的一些字段   | 2017-3-9      | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.8          | 1.CMD1增加工装测试参数内容。                | 2017-4-17     | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.8          | 2.根据客户需求，在104中增加功率后台调配允许 | 2017-4-17     | 郑吉祥        |
|               | 标志。                                      |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.8          | 3.在CMD201报文，增加后台计费优费折扣等相关  | 2017-4-17     | 郑吉祥        |
|               | 字段。                                      |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.8          | 4.增加CMD113、114命令，用于查询本次充电各时 | 2017-4-17     | 郑吉祥        |
|               | 间段信息。                                  |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.8          | 5.按一些客户的需求，在CMD8命令中增加启动流  | 2017-4-17     | 郑吉祥        |
|               | 水号上传。                                  |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.9          | 1.命令5增加命令地址26，充电机限电流。       | 2017-07-12    | 邓志政        |
|               |                                             |               | 王厚林        |
+---------------+---------------------------------------------+---------------+---------------+
| V2.9          | 2.命令106增加字段，白名单版本号，连接后台之 | 2017-07-12    | 邓志政        |
|               | 后会首先发送签到信息，后台可以根据这个版本  |               | 王厚林        |
|               | 号决定要不要更新终端的白名单数据。          |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.9          | 3.命令1增加参数地址77~80，延迟充电起止时间  | 2017-07-12    | 邓志政        |
|               | ，以及81表示白名单版本号（该版本号只支持查  |               | 王厚林        |
|               | 询，不支持写操作，写操作会返回失败）。      |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V2.9          | 4.增加白名单指令，包括服务器下发1301和充电  | 2017-07-12    | 邓志政        |
|               | 桩回复1302。                                |               | 王厚林        |
+---------------+---------------------------------------------+---------------+---------------+
| V3.0          | 1.增加报文示例说明                          | 2017-10-19    | 郑吉祥        |
+---------------+---------------------------------------------+---------------+---------------+
| V4.0          | 1.增加：命令402增加字段76，充电服务费；     | 2018-07-17    | 邓志政        |
|               | 2.增加：章节2.3，协议中计费方式规则；       |               |               |
|               | 3.增加：章节2.4，扫码充电方式说明；         |               |               |
|               | 4.增加：章节2.5，刷卡充电方式说明；         |               |               |
|               | 5.增加：章节2.6，预约充电方式说明；         |               |               |
|               | 6.增加：章节2.7，离线充电方式说明；         |               |               |
|               | 7.增加：章节2.8，典型处理流程说明；         |               |               |
|               | 8.增加：章节2.9，充电记录上报规则；         |               |               |
|               | 9.增加：203报文增加流水号和VIN字段          |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.1          | 1.增加：附录三增加失败编码19,20,21说明；    | 2018-08-22    | 邓志政        |
|               | 2.增加：附录三增加备注，后台下发充电策略参  |               |               |
|               | 数限制                                      |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.2          | 1.增加：106签到报文增加字段22：设备类型；   | 2018-09-27    |               |
|               | 2.增加：附录1告警编码定义增加告警编码32—36 |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.3          | 1.增加：104报文增加第48字段：充电流水号     | 2018-12-05    |               |
|               | 2.增加：110报文增加第30字段：充电流水号     |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.5          | 1.增加：(CMD=3)后台服务器下发充电桩字符型参 | 2019-04-08    |               |
|               | 数  增加项13：增加域名设置；                |               |               |
|               | 2.增加：(CMD=7)后台服务器下发充电桩开启充电 |               |               |
|               | 控制命令中 增加 12/24V启动充电的选项；      |               |               |
|               | 3.增加：(CMD=104)充电桩状态信息包上报中  增 |               |               |
|               | 加 “本次充电累计充电电量”对应的充电电费和 |               |               |
|               | 充电服务费，而不是 电费与服务费的合计。     |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.5_A06      | 1.增加:cmd=1的设置参数82-86，设置参数详见   | 2019-09-25    |               |
|               | cmd=1的正文。                               |               |               |
|               | 2.增加:FTP远程升级和日志上传(详见3.10)      |               |               |
|               | 3.修改:模块故障字节第2字节第3个Bit为：其他  |               |               |
|               | 故障(不可恢复)                              |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.5_A07      | 1.增加：cmd = 207-210，用于即插即充交互。   | 2020-02-19    |               |
|               | 2.cmd =202中，74字段启动方式中添加3：即插即 |               |               |
|               | 充                                          |               |               |
|               | 3.修改CMD=1301，1302.增加查询白名单版本号。 |               |               |
|               | 以及后台下发可以一次下发10条VIN数据。       |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.6_A00      | 增加：cmd = 1:遥测一次104状态报文；         | 2020-05-06    |               |
|               | 强制电子解锁一次；                          |               |               |
|               | 控制板复位一次；                            |               |               |
|               | 下发桩处于急停状态（不可用）；              |               |               |
|               | 强制锁枪（非充电中）。                      |               |               |
|               | 增加:CMD09/10:充电桩请求凭他下发参数。      |               |               |
|               | 新增：CMD205/206：充电密码鉴权报文（预留）  |               |               |
|               | 。                                          |               |               |
|               | 新增CMD111/112:模块故障上报报文。           |               |               |
|               | 新增CMD207/208:即插即充鉴权报文。           |               |               |
|               | 新增CMD209/210:VIN启动充电报文              |               |               |
|               | cmd =202中，74字段启动方式中添加4：密码启动 |               |               |
|               | cmd202和cmd104中新增千分位电量的一个字节    |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.6_A01      | 新增cmd=202订单报文描述                     | 2020-06-28    |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.6_A02      | 1. 启动方式3由过去的屏幕启动改为VIN启动     | 2020-06-28    | 胡帆          |
|               | 2. 将屏幕启方式改为6                        |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.6_A03      | 1. 新增cmd1新字段：自检更新                 | 2020-08-03    | 胡帆          |
|               | 2. 新增V6部分停机原因                       |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.6_A04      | 1. 更新报文cmd202关于时段电量描述           | 2020-08-25    |               |
|               | 2. 更新报文cmd402关于时段电量描述           |               |               |
|               | 3. 更新报文cmd1105关于分时段费率描述        |               |               |
|               | 4. 更新报文cmd106关于版本的描述             |               |               |
|               | 5. 增加 222和422 支持三位电量小数点的订单报 |               |               |
|               | 文                                          |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.6_A05      | 1.平台回复105报文，下发是否支持222和422 支  |               |               |
|               | 持三位电量小数点的订单报文                  |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.7_A01      | 升级1401命令增加升级设备类型                |               |               |
|               | 在104、202、222报文增加并充充电标志位       |               |               |
|               | 对白名单1301、1302报文进行更新              |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.8_A02      | 1.增加“3.11  协议方式日志上传”章节的相关  | 2021-06-15    |               |
|               | 内容                                        |               |               |
|               |                                             |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.8_A03      | CMD7增加“充放电标志位”                    | 2021-8-3      |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.8_A04      | CMD3增加VIN预约启动参数设置                 | 2021-8-23     |               |
|               | CMD1105报文增加V6平台使用说明               |               |               |
|               | 增加CMD1106，充电桩应答后台服务器设置分时段 |               |               |
|               | 计价策略信息                                |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V4.9          | 1.对CMD1、CMD105、CMD106 增加对ASE加密的相  | 2022-1-24     |               |
|               | 关密钥更新和设置，详细见标红文字            |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V5.0          | 202/222报文新增瑞银电表“电表加密数据”、“ | 2023-2-22     |               |
|               | 电表表号”、“电表协议版本”、“加密方式”  |               |               |
|               | 字段                                        |               |               |
+---------------+---------------------------------------------+---------------+---------------+
| V5.1A         | 命令CMD1增加更新余额设置                    | 2023-4-4      |               |
+---------------+---------------------------------------------+---------------+---------------+
| V5.2          | 1.Cmd1105修改描述信息，BCD改为BIN           | 2023-5-17     |               |
|               | 2.cmd1105删除针对不同硬件平台特有描述，统一 |               |               |
|               | 协议描述方式                                |               |               |
|               | 3.cmd1105 cmd1106 修改描述问题，0~30修改为0 |               |               |
|               | 或30                                        |               |               |
+---------------+---------------------------------------------+---------------+---------------+
```


<a id="sec-ebf94e65"></a>
# 一、网络拓扑
    1.1  功能界定

    本接口协议用于界定了充电机智能终端与智能中心管理系统之间的通信协议规范。

    充电机智能终端

    内置于现场无人值守充电机，或者安装于场站充电机内，负责充电机设备通信接入和充电调度管理，同时收集
    充电机各个模块的实时状态、充电状态、交易状态、环境状态等信息，并将这些信息存储并转发到智能中心管
    理平台。


    智能中心管理系统

    实时获取充电机设备信息和电池管理系统 BMS 等相关信息，完成数据的接收，解析，存储和展示。


    1.2  接口定义

    充电机(机)智能终端和智能中心管理系统之间的通信接口采用基于 TCP/IP Socket 的通信方式实现，按照长
    连接工作模式。两个系统可部署在同一个或者不同的企业网络环境中，可以通过局域网或者互联网实现互相连
    接通信。


    1.3  通信方式

    本接口采用 Server/Client 的通信方式：

    充电机智能终端作为客户端 Client 方；

    智能中心管理系统作为服务器 Server 方。

    所有协议中除去特别说明以外，低字节在前，高字节在后。


    1.4  通信规约

    通信数据报文采用二进制格式；

    客户端 Client 方自动向服务器 Server 方提出连接请求，连接成功后，采用推送方式，向服务器方发送协议
    数据包。

    一律采用单包传输方式，不采用多包传输方式；

    客户端 Client 方的发送模式和频率可以设置。

    对接收的数据包需进行合法性校验，包括通信长度、校验和计算，命令代码等多个属性的合法性校验。

    客户端需要自动维护通信连接状态的有效性，在初始化和断链以后，自动进行连接尝试，直到连接恢复。

    应答模式心跳和状态报文信息要后台查询才发送

    正常充电桩与后台通信的报文时序是：

    8.1）充电桩连接后台成功，要先发送106报文进行签到，后台用105回应充电桩

    8.2）充电桩上报完106签到报文后，然后才发送104状态和102心跳、202充电记录等报文给后台服务器

    8.3）充电桩执行后台的相应控制指令

    后台、充电桩在收到报文帧头时，3秒内没有收到完整的报文，自动丢掉此次的帧头数据，然后继续处理下一
    帧报文。

    发送端下发给接收端的数据或命令，接收端要在5S内回复，若发送端在5S内没有收到回复，则应重发或其他逻
    辑处理。

    ★ 协议在升级中会一些报文上增加字段，为了保持软件兼容性，应用层实现时不要做“接收到报文与协议定
    义长度一致才判断为有效报文”的检测。如当前版本104报文字段共42字段，后续根据需要升级到45个字段（
    之前42字段保持不变），这里即使服务器软件还是用旧版本42字段的软件，也应该正确处理桩上报的新104报
    文。

    除了CMD=1202加密能用RSA加密方式，其他报文若是加密，全部是采用AES方式加密。

    协议中说明采用RSA算法加密的其使用密钥长度为1024位

    协议中说明采用AES算法加密的其使用密钥长度为192位

    加密后的“业务数据长度”独立出来，跟之前的报文字段没有关系，加密后的新增加2字节“业务数据长度”
    放在每个报文的业务数据之前，根据是否加密决定报文是否带有2字节“业务数据长度”字段,详细报文格式可
    参考符录7.

    加密只对业务层的数据进行加密，报文中的起始域、长度域、信息域、序列号域、命令代CMD、校验和域不参
    与报文加密。

    桩的一次连接（SOCKET没有断开），只能把非加密方式改变加密报文方式发送，而不能由加密方式改变成非加
    密方式报文发送。

    充电桩与服务器刚创建连接的第一个签到106报文，不能使用任何加密方式。

    19)协议中预留或没有实现的报文字段，建议默认用0进行填充。



    1.5  报文格式

    本通信协议中使用到得报文格式，见表1_1所示。

```text
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 起始域        | 长度域        | 信息域        | 序列号域      | 命令代CMD     | 数据域        | 校验和域      |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 2 (字节)      | 2 (字节)      | 1 (字节)      | 1 (字节)      | 2 (字节)      | N (字节)      | 1 (字节)      |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 0xAA0xF5      | 0～0x8000     | 0x10          | 0～0xFF       | 消息类型      | 参考说明      | 后8位         |
+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
```

    表1_ 1报文格式


    本协议中，所有数值长度为2字节、4字节数值数据，均是低位在前，高位在后的小端格式表示。

    起始域：固定为 0xAA0xF5。

    长度域：起始域到校验和域整个报文长度。

    信息域：信息域-加密标志：代表此数据帧是否加密。详见表1_2

    序列号域：报文的流水号。

    命令代码：即消息类型，代表不同功能要求，命令代码为奇数表示服务器下发的数据，命令代码为偶数表示充
    电桩上传给服务器的数据包.

    数据域：具体的信息数据区域，不同的命令代码对应的内容不同。加密与不加密数据域格式有点区别，加密的
    数据域首部多两个字节的业务数据长度，报文是否加密可以根据信息域中的“加密标志”位来识别。

    校验和域:采用累计和计算校验值，并取校验和的低8位，计算范围包含从命令代码和数据域，参考附录5

```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 信息域                                                                                                      |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| bit7          | bit6          | bit5          | bit4          | bit3~bit0协议主版本                         |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 加密标志      | 预留          | 预留          | 预留          | 如当前协议是V2.6，此值填0x02，详细版本见    |
|               |               |               |               | CMD106签到报文中的20字段                    |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```

    表1_ 2信息域字段



    1.6  关键命令

    本协议内容比较全面，后台可以按需求实现相关的指令，但以下指令是必要实现的命令，指令列表如表1_3所
    示。

```text
+---------------+---------------+---------------------------------------------+
| 序号          | 命令          | 说明                                        |
+---------------+---------------+---------------------------------------------+
| 1             | CMD = 5       | 要实现其索引2的停止充电功能                 |
+---------------+---------------+---------------------------------------------+
| 2             | CMD = 7       | 要实现即时远程开启指令                      |
+---------------+---------------+---------------------------------------------+
| 3             | CMD=101       | 服务器心跳应答                              |
+---------------+---------------+---------------------------------------------+
| 4             | CMD=103       | 服务器应答充电桩状态信息包                  |
+---------------+---------------+---------------------------------------------+
| 5             | CMD=105       | 服务器应答充电桩签到命令                    |
+---------------+---------------+---------------------------------------------+
| 6             | CMD=201       | 服务器应答充电桩充电上报最新一次充电信息报  |
|               |               | 文                                          |
+---------------+---------------+---------------------------------------------+
| 7             | CMD=401       | 服务器查询充电桩历史充电记录                |
+---------------+---------------+---------------------------------------------+
| 8             | CMD=1103      | 服务器设置24时电费计价策略信息              |
+---------------+---------------+---------------------------------------------+
```

    表1_ 3后台指令列表


<a id="sec-90a40732"></a>
# 二、应用层
    2.1  数据格式：

    通信协议中数据格式定义如表2_1所示。

```text
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 数据类型      | 比例因子      | 范围(实际量程)                              | 偏移量        | 字节数        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 容量/电量     | 1AH/bit       | 0 - 65535                                   | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电压          | 0.1V/bit      | 0 - 10000                                   | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电流          | 0.1A/bit      | -32768 – 32768(-3276.8 – 3276.8)          | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 单体电池电压  | 0.01V/bit     | 0 - 4095（ 0 - 40.95 )                      | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电池SOC       | 1%/bit        | 0 - 100（ 0 - 100%)                         | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 温度          | 1℃/bit       | 偏移量-50，-50 - 200                        | 0             | 1BYTE         |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 箱号（组号)   | 1/bit         | 0 - 255                                     | 0             | 1BYTE         |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 箱内位置      | 1/bit         | 0 - 255                                     | 0             | 1BYTE         |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 电度数        | 0.01kWh/bit   | 0 - 65535*65535                             | 0             | 4BYTE         |
|               |               | 特殊说明：报文222、403 电量采用0.001kWh/bit |               |               |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 功率          | 0.1KW/bit     | 0 - 65535 (0 - 6000)                        | 0             | 2 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 金额          | 0.01元/bit    | 0 - 65535*65535                             | 0             | 4 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
| 费率          | 0.01元/度     | 0 - 65535*65535                             | 0             | 4 BYTE        |
+---------------+---------------+---------------------------------------------+---------------+---------------+
```

    表2_ 1 通信协议中的数据格式


    2.2  心跳包机制

    充电机终端在成功连接到服务器后， 需要设置单独任务机制检测通信连接的稳定可靠性，定期向服务器发送
    心跳包，服务器正常情况下给出应答，如果多次没有应答，任务服务器的连接失效，充电机终端必须复位连接
    重新向中心服务器申请连接请求。心跳间隔时间和超时次数可以通过远程设置修改。

    心跳包实现功能如下：

    1) 充电机终端定时向服务器发送心跳包， 中心服务器按照要求返回心跳响应给充电机终端。

    2)充电机终端发送心跳包后，开始计数，计数达到超时次数（可配置)，认为心跳超时，关闭当前连接，恢复
    连接工作状态，自动重新发起 TCP 连接，在获得响应后，向中心服务器发送注册签到报文。


    2.3  计费方式

    现实生活中，计费规则非常复杂，比如电价的多时段计费、服务收费、车位占用费用、预约费用、活动优惠劵
    、充电费用折扣计算等各种计费方式，另外每一个时期还可能采用不同的计费模板。因此实际的计费是一个非
    常复杂的计算过程。而充电机的主要任务是保证正常充电，并确保计量准确

    基于上述原因，采用管理系统完成费用计算的方式执行，用户充电费用在管理系统侧完成，充电机需要保证上
    传准确的充电电量（包括每个时段的电量）和相关的充电记录信息。

    管理系统下发给充电机的费率信息只是当前的电价信息，不涉及其他费用，用户可以通过充电机屏幕查看当前
    的电价信息。


    2.4  扫码充电

    用户通过扫描桩上的二维码远程启动充电，充电桩接收到启动指令后，判断符合启动条件后立即进入充电启动
    中，如果启动中一切正常则进入充电中，否则启动失败。充电完成后立即上报当次充电的充电记录到平台。详
    细的交互流程如下图所示：


    2.5  刷卡充电

    充电卡仅作为身份识别，卡里面没有金额信息，想要获取卡的金额信息，需要向管理系统查询。操作流程如下
    图2-1所示：


```text
+------------------------------+
|                              |
+------------------------------+
| 图2_1  刷卡充电系统流程图    |
+------------------------------+
```



    2.6  预约充电

    不插枪也可以下发预约充电指令。

    预约充电的场景举例：车主还在去充电站的路上查询到某一个充电桩空闲，但是又担心在自己到达前会被别人
    占用，于是用手机APP预约该充电桩，并且预估自己10分钟内能到达充电站，于是设置预约超时时间为10分钟
    。充电桩接收到预约指令后立即进入预约状态，在预约状态内充电桩不能接收其他用户的启动指令或者预约指
    令，只有当前的预约用户才可以下发启动指令。如果该车主在10分钟内到达充电站，则随时可以下发启动充电
    指令；如果超过10分钟还没有到达，则充电桩自动解除预约状态，恢复空闲状态。

    车主下发预约指令的时间就是预约开始的时间，车主不能指定具体的预约开始时间，



    2.7  离线充电

    建议充电桩离线不允许充电，应立即派人维修。

    如果因为当前充电桩的网络状况短时间内无法恢复，则离线充电只能用刷卡充电方式，因为充电卡只用于身份
    识别，并没有金额数据，因此离线充电时并不会扣费。等待网络恢复后，充电桩再把离线充电记录全部上报到
    平台，由平台进行补扣费。




    2.8  即插即充

    即插即充充电模式说明：

    1.当车抢插好之后，用户屏幕点击VIN充电：

    1.1充电桩如果获取到车辆 VIN 码，则通过cmd=208 上报启动充电请求， 由平台的cmd=207返回结果来决定是
    否启动充电。桩收到应答后启动充电，并由cmd=210返回启动结果，充电中可以通过后台停机或者密码停机。

    1.2充电桩如果获取不到车辆VIN码，则由桩自行在本地屏蔽，不需要上传cmd=208到平台校验。

    2.当充电桩与平台连接正常时，所有车辆均需要进行后台请求验证。

    3.当充电桩与平台连接异常时，保存在本地的车辆 VIN 码可启动充电，否则拒绝启动，断网模式时充电订单
    需要等网络连接正常时，按照订单上报策略进行上报。



    2.9  典型处理流程

    2.9.1 连接和注册

```text
+------------------------------+
|                              |
+------------------------------+
| 图2_2 充电机连接注册流程框图 |
+------------------------------+
```



    2.9.2 远程升级












    2.9.3 状态报文上报
















    2.9.4 告警信息上报




    2.10  充电记录上报规则


    2.10.1 冗余规则

    充电机每次上电后，会上报最近几次充电记录，默认上报最近5次（这个数目会根据市场情况调整，有些客户
    是50条）的充电记录，因此后台如果发现记录已经上报成功，则可以过滤。


    2.10.2 重复规则

    订单报文是充电费用的依据，是充电桩最重要的报文。后台收到此报文，一定要进行入数据库持久化保存，严
    禁丢弃，除非判断是重复订单才可以过滤掉。

    “重复订单”的判断依据是，当前收到的202/222订单报文的字段“6-充电卡号、7-充电开始时间、8-充电结
    束时间、10-充电开始SOC、11-充电结束SOC、12-充电结束原因，13-充电电量、14-充电前电表读数、24-车辆
    VIN、75-充电流水号”这些所有字段与之前已入库的订单字段全部一模一样时，才能判定为重复订单，只要任
    何一个字段有差异，都不能判定是重复订单，都要进行入库计费处理或进行人员审核结算。




    2.10.3 过滤规则

    充电机上报的充电记录可能会重复上报，后台应具备过滤功能，过滤的判断规则是：开始时间、用户账户（充
    电卡号）、充电桩编号。如果三者一直就表示是同一条充电记录。


    2.10.4 实时规则

    充电机在线正常，则充电完成后，立即上报本次充电记录。


    2.10.5 完整性规则

    未上报的充电记录会在重新连上后台时重新上传，即使充电机重新上电，未上传成功的充电记录依然会重新上
    传。

    平台在充电记录上传功能上也要保证完整性，应在每次签到时核对充电机上报的充电记录总数和平台储存的充
    电记录总数，如果两者不一致，平台要从最近一次的充电记录开始读取充电桩本地的充电记录，直到两者的充
    电记录总数一致为止。


<a id="sec-336a2a71"></a>
# 三、协议格式
    说明：在该部分通信协议中涉及的每一条命令代码，都具备下面两个信息字段：

    1）服务器向充电桩设置的工作参数，充电桩是要对参数要永久保存

    2）桩编码、用户卡号/用户识别号 是32字节的字段，但有效可用只有31个，最后一个字符必须填0，不足最大
    长度在尾部都用0填充。桩编码按ASCII发送，有效数据最大31字节，不足会补‘\0',如桩编码为“112233”，
    则桩发送的编码数据为 0x31 0x31 0x32 0x32 0x33 0x33 0x00 后面25字节的桩编码无效不用管，即按字符串
    方式处理，遇到'\0'就代表结束了

    注：

    1) 充电模块位置编号: 从 1 开始， 1-N 代表 N 个充电模块位置编号,充电模块位置编号 0 代表所有。

    2) 标准时钟时间，格式：xxxx-xx-xx-xx-xx-xx 年 -月-日-时-分-秒，用BCD码表示,最后一位是保留位0xff
    。

    如2015－07－22－13－16－15， 为：0x20 0x15 0x07 0x22 0x13 0x16 0x15 0xff

    *表示必填字段，非必填字段置0。**表示充电或预约时必填字段，这些字段非充电非预约时置0。


    3.1  服务器向充电桩设置/查询工作参数和命令

<a id="cmd-001"></a>
### 3.1.1  (cmd=1)后台服务器下发充电桩整形工作参数 [cmd=001]

    报文功能：后台服务器向充电桩下发充电桩整形工作参数命令,如表3_1_1示。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 3*            | 类型                         | 1             | 0-查询/1-设置                |
+---------------+------------------------------+---------------+------------------------------+
| 4*            | 设置/查询参数起始地址        | 4             | 参见“参数地址列表3_1_2”    |
+---------------+------------------------------+---------------+------------------------------+
| 5*            | 设置/查询个数                | 1             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 6*            | 设置参数字节数               | 2             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 7*            | 设置数据                     | N             | 当类型为设置时才有此字段     |
+---------------+------------------------------+---------------+------------------------------+
```

    表3_1_1 工作参数命令


```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 参数地址      | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 签到时间间隔                 | 4             | 按照分钟为单位（默认 30 分)                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 充电桩项目类型               | 4             | 内部参数，一般用于查询                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 充电枪个数                   | 4             | 内部参数，一般用于查询                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 通道号                       | 4             | 内部参数，一般用于查询                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 最高充电电压                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 最大充电电流                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 读卡器类型                   | 4             | 1:MT622                                     |
|               |                              |               | 2:ID读卡器                                  |
|               |                              |               | 硬件决定的，运营的后台不需要设置或查询此项  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 读卡器波特率                 | 4             | 硬件决定的，运营的后台不需要设置或查询此项  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 充电卡片协议编号             | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 后台验证                     | 4             | 0-不验证  1-验证                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 车牌验证                     | 4             | 0-不验证  1-验证                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 车卡VIN绑定                  | 4             | 0-不绑定  1-绑定                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | BMS单体保护电压              | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | BMS充电保护温度              | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15*           | 调试地址1                    | 4             | 0保持不变                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 调试地址2                    | 4             | 0保持不变                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 调试地址3                    | 4             | 0保持不变                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 调试地址4                    | 4             | 0保持不变                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 调试地址5                    | 4             | 0保持不变                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 定时上报间隔                 | 4             | 上报模式，定时上报的间隔                    |
|               |                              |               | 单位：秒；缺省：15秒                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 心跳上报周期                 | 4             | 0保持不变缺省=3 秒                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22            | 心跳包检测超时次数           | 4             | 0保持不变缺省=3 秒                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23            | 充电桩状态信息报上报周期     | 4             | 0保持不变缺省=3 秒                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24            | 通信模式                     | 4             | 1：应答模式                                 |
|               |                              |               | 2：主动上报模式                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25*           | 中心服务器地址               | 4             | 按照字节顺序注 3)                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26*           | 中心服务器端口               | 4             | 低字节在前注 4)                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 27            | 服务费价格                   | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 28            | 全时段电费费率               | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 29            | 广告灯开启起始小时           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 30            | 广告灯开启起始分钟           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 31            | 广告灯关闭起始小时           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 32            | 广告灯关闭起始分钟           | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 33            | 调试控制地址                 | 4             | 内部调试用，运营平台不需实现                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 34            | 调试控制数据                 | 4             | 要与调试控制地址一起发送                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 35            | 过压值                       | 4             | 放大10倍                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 36            | 欠压值                       | 4             | 放大10倍                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 37            | 过流值                       | 4             | 放大10倍                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 39            | 辅源类型                     | 4             | 1-12V   2-24V                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 40            | 充电枪类型                   | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 41            | 控制板软件版本               | 4             | 只支持读，而且在M3+U1+U2平台中才有效        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 42            | 采集板软件版本               | 4             | 只支持读，而且在M3+U1+U2平台中才有效        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 43            | 模块类型                     | 4             | 0：500V标准；1：750V标准；2:500V恒功率模块  |
|               |                              |               | ；3：750V恒功率模块；4：低压250V模块；5：第 |
|               |                              |               | 二代恒功率模块；6：低压档100V模块；内部参数 |
|               |                              |               | ，可设可查，一般只用于查询                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 44            | 组号                         | 4             | 监控组号，与模块组号一致（0-9）；内部参数， |
|               |                              |               | 可设可查，一般只用于查询                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 45            | 地址                         | 4             | 监控地址（1-10）；内部参数，可设可查，一般  |
|               |                              |               | 只用于查询                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 46            | 最大组号                     | 4             | 监控最大组号（0-9）；内部参数，可设可查，一 |
|               |                              |               | 般只用于查询                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 47            | 最大地址                     | 4             | 监控最大地址号（1-10）；内部参数，可设可查  |
|               |                              |               | ，一般只用于查询                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 48            | 双充模式                     | 4             | 1：双枪单充；2：双枪双充；内部参数，可设可  |
|               |                              |               | 查，一般只用于查询                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 49            | 界面类型                     | 4             | 0：标准界面；1：N个双枪单屏类型；内部参数， |
|               |                              |               | 可设可查，一般只用于查询                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 50            | 预留IO类型                   | 4             | 0：预留；1：N枪单屏功能（一般只设主机）；2  |
|               |                              |               | ：群充IO；3：SOC显示灯；内部参数，可设可查  |
|               |                              |               | ，一般只用于查询                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 51            | 环境低温值                   | 4             | 放大10倍；内部参数，可设可查，一般只用于查  |
|               |                              |               | 询                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 52            | 群充模块数量                 | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 53            | 指示灯类型                   | 4             | 0：各枪各自的指示灯或N个双枪单屏类型； 1：  |
|               |                              |               | 整个系统只有一个指示灯；内部参数，可设可查  |
|               |                              |               | ，一般只用于查询                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 54            | 电表类型                     | 4             | 0:没有电表                                  |
|               |                              |               | 1：DLT645-2007（地址号：01） ；2：          |
|               |                              |               | DLT645-2007（科陆电表，带CT上传，地址号：01 |
|               |                              |               | ）；3：DLT645-2007（广播帧，不用设电表地址  |
|               |                              |               | ）；4：DLT645-2007（地址号：01，主机带机柜  |
|               |                              |               | 总电表（地址号：02）））；内部参数，可设可  |
|               |                              |               | 查，一般只用于查询                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 55            | 充电卡类型                   | 4             | 0:本公司旧标准M1充电卡 1:本公司支持用户自定 |
|               |                              |               | 义密钥M1卡；内部参数，可设可查，一般只用于  |
|               |                              |               | 查询                                        |
|               |                              |               | 注：类型0的卡基本不用了，后续一般都是支持类 |
|               |                              |               | 型1卡                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 56            | CAN3外部通信地址             | 4             | 1-100；内部参数，可设可查，一般只用于查询   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 57            | BMS类型                      | 4             | 0：新旧国标兼容（默认）；1：旧国标协议；02  |
|               |                              |               | ：国标与普天自适应协议；03：普天地标协议；  |
|               |                              |               | 内部参数，可设可查，一般只用于查询          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 58            | 充电卡后台验证               | 4             | 1：后台验证使能；2：不使能；内部参数，可设  |
|               |                              |               | 可查，一般只用于查询                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 59            | 认证方式                     | 4             | 1：认证优先；2：充电优先；内部参数，可设可  |
|               |                              |               | 查，一般只用于查询                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 60            | 充电限电压                   | 4             | 放大10倍；内部参数，可设可查，一般只用于查  |
|               |                              |               | 询                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 61            | 充电限电流                   | 4             | 放大10倍；内部参数，可设可查，一般只用于查  |
|               |                              |               | 询                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 62            | 快充段-起始小时              | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 63            | 快充段-起始分钟              | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 64            | 快充段-结束小时              | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 65            | 快充段-结束分钟              | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 66            | 状态A和状态B                 | 4             | 见注7                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 67            | 模块电压                     | 4             | 放大10倍                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 68            | 绝缘正电压                   | 4             | 放大10倍                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 69            | 绝缘负电压                   | 4             | 放大10倍                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 70            | 绝缘阻抗                     | 4             | 放大1倍                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 71            | 枪正端温度保护               | 4             | 偏移量-50，-50 - 200                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 72            | 枪负端温度保护               | 4             | 偏移量-50，-50 - 200                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 73            | 模块数量                     | 4             | 0-255                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 74            | 电表电能                     | 4             | 放大100倍，kwh                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 75            | 后台支持计费优惠功能         | 4             | 0-不支持                                    |
|               |                              |               | 1-支持                                      |
|               |                              |               | 若后台支持计费优惠功能，报文201要回应相应的 |
|               |                              |               | 优惠字段                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 76            | 环境过温保护                 | 4             | 偏移量-50，-50 - 200                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 77            | 延迟充电段-起始小时          | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 78            | 延迟充电段-起始分钟          | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 79            | 延迟充电段-结束小时          | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 80            | 延迟充电段-结束分钟          | 4             | 放大1倍；内部参数，可设可查，一般只用于查询 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 81            | 白名单版本号                 | 4             | 只能查询，不能设置                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 82            | 遥测104报文                  | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 83            | 强制解锁一次                 | 4             | 只有在充电结束且发生解锁故障时候才会生效。  |
|               |                              |               | 枪锁软锁未解除下,此命令无效。               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 84            | 控制板复位                   | 4             | 只能在非充电过程中触发                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 85            | 急停                         | 4             | 充电中下发急停会导致本地停机,慎重使用。     |
|               |                              |               | 1：软急停触发                               |
|               |                              |               | 0：软急停解除                               |
|               |                              |               | 输入调试变量6005解除                        |
|               |                              |               | 输入调试变量6005触发                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 86            | 本地锁枪动作                 | 4             | 只能在非充电期间且本地未发生闭锁失败情况下  |
|               |                              |               | 下发。                                      |
|               |                              |               | 1：枪锁上软锁                               |
|               |                              |               | 0：枪锁解软锁                               |
|               |                              |               | 界面输入调试变量6000解锁                    |
|               |                              |               | 界面输入调试变量6001闭锁                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 87            | 软件更新自检                 | 4             | 充电桩检查并且执行最新官方可                |
|               |                              |               | 升级性软件，非充电下发。                    |
|               |                              |               | 0xAA01:表示升级监控                         |
|               |                              |               | 0xAA02:表示升级CCU-H2 板                    |
|               |                              |               | 0xAA03:表示升级DCDC 模块                    |
|               |                              |               | 0xAA04:表示升级ACDC 模块                    |
|               |                              |               | 0xAA05:表示升级绝缘板                       |
|               |                              |               | 0xAA06:表示升级功率控制板                   |
|               |                              |               | 其他:                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 88            | 离线时默认限功率             | 4             | 后台限功率                                  |
|               |                              |               | 不限功率                                    |
|               |                              |               |                                             |
|               |                              |               | 限功率10KW                                  |
|               |                              |               | 1000-限功率 100KW                           |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 89            | 最高允许SOC                  | 4             | 大于100表示不限制                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 90            | AES密钥                      | 32            | 设置索引90，设置个数8                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 91            | 更新余额                     | 8             | 前4字节枪号                                 |
|               |                              |               | 后4字节余额值，单位0.0001元                 |
+---------------+------------------------------+---------------+---------------------------------------------+
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_1_2 参数地址列表1

    注：

    1) 中心服务器地址， 例：IP： 16.80.1.20  ，指令为：0x10 0x50 0x01 0x14

    2) 中心服务器端口， 例：端口 10001，0x11 0x27

    3) 一次设置/查询的个数要求不超过10个且整个报文小于规约规定最大报文长度。

    4)非字符号类型的长度全部设置为4是为方便程序统一接口

    5)这些参数设置完后，没有特殊说明的，充电桩要能掉电保存

    6)后台根据可实际需要开发相应的设置/查询功能，以上有些参数是生产时进行设置的出厂参数，运营后台不
    一定要全部实现以上参数的查询和设置，而且若没有需要都可以不实现这条设备指令。

    7)状态A和状态B定义，见下表3_1_3所示。

```text
+---------------+---------------+---------------------------------------------+
| 状态A         |                                                             |
+---------------+---------------+---------------------------------------------+
| Bit0--Bit2    | BMS状态       | 0：待机；1：握手；2：配置；3：充电；4：结束 |
|               |               | ；                                          |
+---------------+---------------+---------------------------------------------+
| Bit3          | 插枪状态      | 0：未插；1：已插                            |
+---------------+---------------+---------------------------------------------+
| Bit4          | 开关机状态    | 0：关机；1：开机                            |
+---------------+---------------+---------------------------------------------+
| Bit5-Bit7     | 绝缘状态      | 0：未启动；1：检测中；2：通过；3：异常；4： |
|               |               | 通过（告警）                                |
+---------------+---------------+---------------------------------------------+
| Bit8          | 枪锁状态      | 0：断开；1：闭合                            |
+---------------+---------------+---------------------------------------------+
| Bit9          | 急停状态      | 0：正常；1：急停                            |
+---------------+---------------+---------------------------------------------+
| BitA          | 辅电状态      | 0：未供；1：已供                            |
+---------------+---------------+---------------------------------------------+
| BitB          | 风扇状态      | 0：停止；1：启动                            |
+---------------+---------------+---------------------------------------------+
| BitC          | 电表状态      | 0：离线；1：在线                            |
+---------------+---------------+---------------------------------------------+
| BitD          | 直流接触器状  | 0：断开；1：闭合                            |
|               | 态            |                                             |
+---------------+---------------+---------------------------------------------+
| BitE-BitF     | 系统状态      | 0：待机；1：充电中；2：故障                 |
+---------------+---------------+---------------------------------------------+
| 状态B         |                                                             |
+---------------+---------------+---------------------------------------------+
| Bit10         | AC接触器状态  | 0：断开；1：闭合                            |
+---------------+---------------+---------------------------------------------+
| Bit11         | 枪归位状态    | 0：归位；1：未归位                          |
+---------------+---------------+---------------------------------------------+
| Bit12         | 舱门状态      | 0：闭合；1：断开                            |
+---------------+---------------+---------------------------------------------+
| Bit13         | 广告灯状态    | 0：断开；1：闭合                            |
+---------------+---------------+---------------------------------------------+
| Bit14         | 预留          |                                             |
+---------------+---------------+---------------------------------------------+
| Bit15         | 防雷状态      | 0：正常；1：异常                            |
+---------------+---------------+---------------------------------------------+
| Bit16         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit17         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit18         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit19         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit1A         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit1B         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit1C         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit1D         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit1E         |               |                                             |
+---------------+---------------+---------------------------------------------+
| Bit1F         |               |                                             |
+---------------+---------------+---------------------------------------------+
```

    表3_1_3 状态A和状态B的定义


<a id="cmd-002"></a>
### 3.1.2  (cmd=2)充电桩参数整形设置/查询应答 [cmd=002]

    报文功能：充电桩对后台服务器的充电桩整形参数设置报文应答，见表3_1_4所示。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                    |
+---------------+------------------------------+---------------+------------------------------+
| 4*            | 类型                         | 1             | 0-查询 1-设置                |
+---------------+------------------------------+---------------+------------------------------+
| 5*            | 设置/查询参数启始地址        | 4             | 同设置命令地址               |
+---------------+------------------------------+---------------+------------------------------+
| 6*            | 设置/查询个数                | 1             | 同设置命令地址               |
+---------------+------------------------------+---------------+------------------------------+
| 7*            | 设置/查询结果                | 1             | 0表示成功，其它失败          |
+---------------+------------------------------+---------------+------------------------------+
| 8*            | 查询参数信息                 | N             |                              |
+---------------+------------------------------+---------------+------------------------------+
```

    表3_1_4 报文应答


<a id="cmd-003"></a>
### 3.1.3  (cmd=3)后台服务器下发充电桩字符型参数 [cmd=003]

    报文功能：后台服务器向充电桩下发充电桩字符形参数命令，见表3_1_5所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 类型          | 1             | 0-查询 1-设置                |
+---------------+---------------+---------------+------------------------------+
| 4*            | 设置/查询参数 | 4             | 参见“参数地址列表3_1_6”    |
|               | 启始地址      |               |                              |
+---------------+---------------+---------------+------------------------------+
| 5*            | 设置参数字节  | 2             |                              |
|               | 数            |               |                              |
+---------------+---------------+---------------+------------------------------+
| 6*            | 设置数据      | N             | 当类型为设置时才有此字段     |
+---------------+---------------+---------------+------------------------------+
```

    表3_1_5 字符形参数命令


```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 参数地址      | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1*            | 充电桩编码                   | 32            | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2*            | 标准时钟时间                 | 8             | 同步充电桩时间                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 管理员密码                   | 8             | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 操作员密码                   | 8             | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | MAC地址                      | 6             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 桩登入服务器密码             | 16            | 阿拉伯数字,不足最后补’\0’                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 桩主界面二维码               | 256*          | ASCII码,  预留                              |
|               |                              |               | 这个是单枪的才用这个命令发送                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 客户服务热线1                | 16*           | ASCII码预留                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 客户服务热线2                | 16*           | ASCII码预留                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 用户支付二维码               | 256*          | 最大256,ASCII码预留                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11*           | 桩主界面二维码前缀           | 128*          | 最大128字节,ASCII码一般加的前缀如           |
|               |                              |               | http://www.xxx.com/charger/，若其值第一个字 |
|               |                              |               | 节为数字表示前缀无效，二维码按桩编码直接显  |
|               |                              |               | 示；                                        |
|               |                              |               | 桩上显示的二维码为：前缀+桩号+"-枪号”；    |
|               |                              |               | 一桩多枪使用这个索引设置二维码              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | DLT645-2007电表地址          | 12            |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 云服务器域名                 | 64            | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | VIN定时启动充电信息          | 8             | BCD码，启动时间+停止时间+是否启用(00-停用   |
|               |                              |               | 01-启用)                                    |
|               |                              |               | 时间格式：时+分+秒                          |
|               |                              |               | 例如：每天22:30到凌晨5:30启用VIN定时启动    |
|               |                              |               | 发送：22 30 00 05 30 00 01                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15~20         | 1-6枪完整二维码信息          | 256*          | 1到6枪的二维码信息，参数地址对应为15-20，例 |
|               |                              |               | 如下发2枪完整二维码信息，则使用参数地址16， |
|               |                              |               | 单个参数地址最大设置长度为256字节，ASCII码  |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_1_6 参数地址列表

    注：

    1) 参数字符串类型，一次只能设置一个参数

    2) 一次设置/查询的整个报文小于规约规定最大报文长度。

    3)上表中的字符类型长度是指最大设置长度，若比最大允许的字符短，最后一个字节以’\0’结束。长度字段
    带“*”号，表示其长度可根据实际长度发送。

    4)这些参数设置完后，充电桩要能掉电保存

    5)正常运营的后台，根据需要进行开发相应的设置\查询项，不需要全部都实现。

    6)当充电桩上传106签到报文时，会上传当前桩的系统时间，若上传的系统时间与后台服务器时间差异大时，
    需要下发同步时间命令。

    7）一个SOCKET 连接，上传多枪数据的机型，平台若支持扫码充电，在上电签到时，平台要下发“11桩主界面
    二维码前缀”给充电桩，充电桩生成的标准二维码数据内容为：前缀+桩号+“-枪号”（2位），如平台下发前
    缀为http://baidu.com/,则桩号123456的1枪、2枪生成的二维码内容为

    1枪：http://baidu.com/123456-01

    2枪：http://baidu.com/123456-02

<a id="cmd-004"></a>
### 3.1.4  (cmd=4)充电桩参数字符形设置/查询应答 [cmd=004]

    报文功能：充电桩对后台服务器的充电桩字符形参数设置报文应答，如3_1_7所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 类型          | 1             | 0-查询 1-设置                |
+---------------+---------------+---------------+------------------------------+
| 5*            | 设置/查询参数 | 4             | 同设置命令地址               |
|               | 启始地址      |               |                              |
+---------------+---------------+---------------+------------------------------+
| 6*            | 设置/查询结果 | 1             | 0表示成功，其它失败          |
+---------------+---------------+---------------+------------------------------+
| 7*            | 设置参数信息  | N             |                              |
+---------------+---------------+---------------+------------------------------+
```

    表3_1_7 字符形参数设置报文应答


<a id="cmd-005"></a>
### 3.1.5  (cmd=5)后台服务器下发充电桩控制命令 [cmd=005]

    报文功能：后台服务器向充电桩控制命令,如下表3_1_8所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 充电枪口      | 1             | 只有一机一桩此参数可为0，多枪编号从1开始    |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 启始命令地址  | 4             | 参见“命令地址列表3_1_9”                   |
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 命令个数      | 1             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 6*            | 命令参数长度  | 2             | 命令个数*4（字节）                          |
+---------------+---------------+---------------+---------------------------------------------+
| 7*            | 命令参数      | n             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_1_8 充电桩控制命令

    说明：充电桩掉电后不保存命令的任何信息，在接收到后执行。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 命令地址      | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 4             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2**           |                              | 4             | 0x55 有效 后台用这个指令下发远程停止充电，  |
|               | 停止充电                     |               | APP和后台停止全部用此命令                   |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 预留                         | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | 充电控制方式                 | 4             | 0:BMS控制充电(正常给汽车充电方式)           |
|               |                              |               | 1:非BMS协议控制（一般测试、调试、认证使用） |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 预留                         | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 预留                         | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 电阻模式输出电压             | 4             | 用于生产测试                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 电阻模式输出电流             | 4             | 用于生产测试                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 充电模式                     | 4             | 0-恒流  1-恒压                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10**          | 取消预约充电                 | 4             | 0x55 有效                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 设备重启                     | 4             | 0x55 有效                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 进入升级模式                 | 4             | 0x55 有效                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 进入正常应用模式             | 4             | 0x55 有效                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 立即上报一次签到106报文      | 4             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 立即上报一次桩状态信息104报  | 4             | 预留                                        |
|               | 文                           |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 扫描支付成功                 | 4             | 0x55 有效                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 实时充电（限制）最大充电功率 | 4             | 0表示无限制                                 |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 负载类型                     | 4             | 0-电池  1-电阻                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 绝缘检测                     | 4             | 1-启动一次绝缘检测动作                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 模块类型                     | 4             | 0：500V标准；1：750V标准；2:500V恒功率模块  |
|               |                              |               | ；3：750V恒功率模块；4：低压250V模块；5：第 |
|               |                              |               | 二代恒功率模块；6：低压档100V模块；         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 本地计费                     | 4             | 0-不启用 1-启用                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22            | 刷卡密码输入流程             | 4             | 不验证密码                                  |
|               |                              |               | 先输入密码再刷卡                            |
|               |                              |               | 先刷卡再输入密码                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23            | 充电暂停服务                 | 4             | 0x55-暂停服务                               |
|               |                              |               | 其他-恢复充电服务                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24            | 输出电压较准                 | 4             | 在电阻模式下设置完输出电压（7）后，这里输入 |
|               |                              |               | 实际万用表测量到的输出电压值                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25            | 离线时默认限功率             | 4             | 后台限功率，需要断电保存                    |
|               |                              |               | 0-不限功率                                  |
|               |                              |               |                                             |
|               |                              |               | 限功率10KW                                  |
|               |                              |               | 1000-限功率 100KW                           |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26            | 充电机限电流                 | 4             | 后台限电流，设置只对一次充电有效，充电结束  |
|               |                              |               | 后自动取消限电流功能。                      |
|               |                              |               | 0-不限电流                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_1_9 命令地址列表

    注：

    1) 一次设置的命令个数要求不超过10个且整个报文小于规约规定最大报文长度。

    2)非字符号类型的命令长度全部设置为4是为方便程序统一接口,上表中的字符类型长度是指最大设置长度，若
    比最大允许的字符短，最后一个字节以’\0’结束。

    3)这些参数设置完后，没有特殊说明的，一般充电桩断电后不保存

    4)以带“*”为后台必须要实现的命令，不带“*”可根据业务需要再实现

    示例：

```text
+---------------+---------------------------------------------+
| 功能          | 报文                                        |
+---------------+---------------------------------------------+
| 1号枪停止充电 | AA F5 19 00 10 01 05 00 11 22 33 44 01 02   |
|               | 00 00 00 01 04 00 55 00 00 00 0C            |
+---------------+---------------------------------------------+
```


<a id="cmd-006"></a>
### 3.1.6  (cmd=6)充电桩对后台控制命令应答 [cmd=006]

    报文功能：充电桩对后台服务器的后台控制命令报文应答，如下表3_1_10所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 充电枪口      | 1             |                              |
+---------------+---------------+---------------+------------------------------+
| 5*            | 命令启始标志  | 4             | 同设置命令                   |
+---------------+---------------+---------------+------------------------------+
| 6*            | 命令个数      | 1             | 同设置命令                   |
+---------------+---------------+---------------+------------------------------+
| 7*            | 命令执行结果  | 1             | 0表示成功，其它失败          |
+---------------+---------------+---------------+------------------------------+
```

    表3_1_10 充电桩应答


<a id="cmd-007"></a>
### 3.1.7  (cmd=7)后台服务器下发充电桩开启充电控制命令 [cmd=007]

    报文功能：后台服务器向充电桩开始充电控制命令，如表3_1_11所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电枪口                     | 1             | 编号从1开始                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4**           | 充电生效类型                 | 4             | 0:即时充电                                  |
|               |                              |               | 1:定时启动充电                              |
|               |                              |               | 2:预约充电                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 界面充电停止密码             | 4             | 此字段为整数形字段                          |
|               |                              |               | 建议为用户卡号最后4位，若服务器没有下发此字 |
|               |                              |               | 段，桩默认取充电卡号的最后4位，如卡号“     |
|               |                              |               | 1122334455667788”，其最后4位是“7788”，而 |
|               |                              |               | 不是0，若后台不下发此字段，默认使用0填充，  |
|               |                              |               | 此数为0时桩自动取字段10的未4/6位当做停止充  |
|               |                              |               | 电密码。                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6**           | 充电策略                     | 4             | 0:充满为止                                  |
|               |                              |               | 1:按时间充电                                |
|               |                              |               | 2:按金额充电                                |
|               |                              |               | 3:按电量充电                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7**           | 充电策略参数                 | 4             | 时间单位为1秒                               |
|               |                              |               | 金额单位为0.01元                            |
|               |                              |               | 电量时单位为0.01kw                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8**           | 预约/定时启动时间            | 8             | 标准时间                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9**           | 预约超时时间                 | 1             | 单位分钟                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10**          | 用户卡号/用户识别号          | 32            | 内容只能”0~9、A~Z、a~z字符ASCII码，不够长  |
|               |                              |               | 度填’\0’                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11**          | 断网充电标志                 | 1             | 0-不允许 1-允许                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12**          | 离线时本次最大可充电总电量   | 4             | 分辨率0.01kw                                |
|               |                              |               | 若字段11、12都是0，表示不限制离线可充电量， |
|               |                              |               | 即允许客户在桩离线时充满电                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13**          | 充电流水号                   | 32            | 若后台没有下发，桩会自动生成，流水号只能”  |
|               |                              |               | 0~9、A~Z、a~z、-、_”这些字符               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | BMS辅源电压                  | 1             | 0-12V；1-24V。仅当前充电有效，当前充电完成  |
|               |                              |               | 恢复为充电机系统设置值（已废除此功能）      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 用户账号余额                 | 4             | 金额单位为0.01元                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 充放电标志                   | 1             | 充电                                        |
|               |                              |               | 0xf1-放电                                   |
|               |                              |               |                                             |
|               |                              |               | 非协议定义值，都表示充电                    |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_1_11 充电桩开始充电控制命令

    说明：

    通过“用户卡号/用户识别号”即可确定充电用户谁，建议后台对一个充电用户只有唯一的“用户卡号/用户识
    别号”。

    每个用户的“用户卡号/用户识别号”都是唯一的，若用户的APP或微信绑定了充电卡，则用户通过APP或微信
    等远程充电时，这个字段后台应该下发其绑定的充电卡卡号。

    默认下发参数是：充电生效类型：即时充电 充电策略：充满为止

    若平台需要根据用户的金额限制充电电量功能，充电策略请不要使用“0-充满为止”，而是每次平台下发启动
    充电策略都采用“2:按金额充电或3:按电量充电”方式

    若字段11、12都是0，表示不限制离线可充电量，即允许客户在桩离线时充满电。平台要限制不允许离线充电
    ，则字段11设置为0，字段12随便设置一个不为0数字即可，建议此情况下字段12值不大于10.

    字段12“离线时本次最大可充电总电量”，是指在充电中离网时最大的本次最大可充电总电量，而不是离线后
    的这段时间电量。即这个电量包含了，在线时的充电电量和离线时的充电电量。这样平台就能根据当前的时间
    点、服务费、电费在充电前就可预估出这个值，并下发给充电桩。



<a id="cmd-008"></a>
### 3.1.8  (cmd=8) 充电桩对后台下发的充电桩开启充电控制应答 [cmd=008]

    报文功能：充电桩对后台下发的充电桩开启充电控制报文应答，如表3_1_12所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 充电枪口      | 1             | 同服务发送枪口               |
+---------------+---------------+---------------+------------------------------+
| 5*            | 命令执行结果  | 4             | 0表示成功，其它失败          |
|               |               |               | 含义见附录3                  |
+---------------+---------------+---------------+------------------------------+
| 6             | 充电流水号    | 32            | 按命令7的字段13回复          |
+---------------+---------------+---------------+------------------------------+
```

    表3_1_12 充电桩开启充电控制报文应答

    注意：当收到命令执行结果返回失败，表示当前桩故障不可用，代表后台启动命令充电桩不接收，代表此次启
    动失败。命令执行结果返回成功，表示桩正常工作，并响应后台启动指令，此时会把CMD=104的字段7“工作状
    态”立即变成“1-正准备开始充电”，具体充电启动是否成功要用CMD=104的字段7“工作状态”进行判断，按
    目前情况最长启动时间最长有可能达120S后充电桩才能判断是否成功。

<a id="cmd-009"></a>
### 3.1.9  (cmd=9)后台服务器应答桩上传命令请求(预留) [cmd=009]

    报文功能：后台服务器向充电桩数据请求命令，如表3_1_13所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3             | 充电枪号      | 1             |                              |
+---------------+---------------+---------------+------------------------------+
| 4             | 执行结果      | 4             | 0-收到合法命令，并执行       |
|               |               |               | 1-非法命令或参数             |
+---------------+---------------+---------------+------------------------------+
| 5             | 命令地址      | 4             | 同CMD10的字段5               |
+---------------+---------------+---------------+------------------------------+
| 6             | 数据长度      | 4             |                              |
+---------------+---------------+---------------+------------------------------+
| 7             | 数据          | n             |                              |
+---------------+---------------+---------------+------------------------------+
```

    表3_1_13 充电桩数据请求命令


<a id="cmd-010"></a>
### 3.1.10 (cmd=10)充电桩上传命令请求(预留) [cmd=010]

    报文功能：充电桩根据应用场景向后台服务器发送请求数据，如表3_1_14所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 3             | 充电桩编码    | 32            | ASCII编码     |
+---------------+---------------+---------------+---------------+
| 4             | 充电枪号      | 1             | 充电枪号      |
+---------------+---------------+---------------+---------------+
| 5             | 请求启始地址  | 4             | 桩请求命令参  |
|               |               |               | 数            |
|               |               |               | 地址列表      |
|               |               |               | 3_1_15        |
+---------------+---------------+---------------+---------------+
| 6             | 参数          | 4*n           |               |
+---------------+---------------+---------------+---------------+
```

    表3_1_14 后台服务器发送请求数据


```text
+---------------+------------------------------+---------------+------------------------------+
| 参数地址      | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 请求生成预付费支付二维码     | 4             | 预付费金额，单位0.01元       |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 预留                         | 4             | 单位0.01元                   |
+---------------+------------------------------+---------------+------------------------------+
| 3~100         | 预留                         |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 101           |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
| 102           |                              |               |                              |
+---------------+------------------------------+---------------+------------------------------+
```

    表3_1_15 桩请求命令参数地址列表


<a id="cmd-011"></a>
### 3.1.11 (cmd=11)服务器查询充电桩软件版本(非必实现功能) [cmd=011]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 查询设备类型  | 2             | 1:TCU/S7 监控主单元          |
|               |               |               | 2:CCU 充电控制器             |
|               |               |               | 3:模块AC                     |
|               |               |               | 4:模块DC                     |
|               |               |               |                              |
+---------------+---------------+---------------+------------------------------+
| 5             |               |               |                              |
+---------------+---------------+---------------+------------------------------+
| 6             |               |               |                              |
+---------------+---------------+---------------+------------------------------+
| 7             |               |               |                              |
+---------------+---------------+---------------+------------------------------+
```



<a id="cmd-012"></a>
### 3.1.11 (cmd=12)充电桩应答软件版本(非必实现功能) [cmd=012]

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 返回设备类型  | 2             | 与命令11字段4定义设备含义一致               |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 1号软件版本   | 2             | 0x09 0x52 表示：0x5209,则版本号为：210.01   |
+---------------+---------------+---------------+---------------------------------------------+
| 6             | 2号软件版本   | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 7             | 3号软件版本   | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
```



    3.2  充电桩主动上传数据

<a id="cmd-101"></a>
### 3.2.1  (cmd=101)服务器应答心跳包信息 [cmd=101]

    报文功能：后台服务器对收到充电桩心跳包后的应答，如表3_2_1所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 心跳应答      | 2             | 累加，到最大值时为1，重新累  |
|               |               |               | 加                           |
+---------------+---------------+---------------+------------------------------+
```

    表3_2_1 充电桩心跳包后的应答

<a id="cmd-102"></a>
### 3.2.2  (cmd=102)充电桩上传心跳包信息 [cmd=102]

    报文功能：充电桩定期发送该指令向服务器传递连接心跳包信息，如表3_2_2所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 心跳序号      | 2             | 缺省=0                                      |
+---------------+---------------+---------------+---------------------------------------------+
| 5             | 各枪状态      | 16            | HEX，每位代表一个枪，可表示1~128枪的状态    |
|               |               |               | 0-未插入枪                                  |
|               |               |               | 1-已插枪                                    |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_2_2 连接心跳包信息


    注：1.建议在104报文发送时间少于30秒的阶段时，不发心跳报文，以节省网络流量。

<a id="cmd-103"></a>
### 3.2.3  (cmd=103)服务器应答充电桩状态信息包 [cmd=103]

    报文功能：后台服务器对收到充电桩状态报文后的应答,如表3_2_3所示。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 充电口号                     | 1             | 这个字段与104报文字段5一致   |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 是否立即上报一次104报文      | 1             | 0：否                        |
|               |                              |               | 1：是                        |
+---------------+------------------------------+---------------+------------------------------+
```

    表3_2_3 应答充电桩状态信息包

<a id="cmd-104"></a>
### 3.2.4  (cmd=104)充电桩状态信息包上报 [cmd=104]

    报文功能：充电桩定期发送此信息上报充电桩当前工作状态信息，如表3_2_4所示。

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                                  | 32            | ASCII编码                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪数量                                  | 1             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5*            | 充电口（枪）号                              | 1             | 编码从1开始,如有2枪，那这个字段的值为1、2两 |
|               |                                             |               | 个值                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6*            | 充电枪类型                                  | 1             | BIT0~BIT1:1=直流；2=交流；                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7*            | 工作状态                                    | 1             | 0-空闲中                                    |
|               |                                             |               | 1-正准备开始充电                            |
|               |                                             |               | 2-充电进行中                                |
|               |                                             |               | 3-充电结束                                  |
|               |                                             |               | 4-启动失败                                  |
|               |                                             |               | 5-预约状态                                  |
|               |                                             |               | 6-系统故障(不能给汽车充电)                  |
|               |                                             |               | 7-暂停服务                                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8**           | 当前SOC %                                   | 1             | （直流有效，交流无效）                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9*            | 当前最高告警编码                            | 4             | 无告警,参见附录1                            |
|               |                                             |               | 此字段不能判定是否可以给汽车充电的条件,系统 |
|               |                                             |               | 告警是否可以给车充电用字段7判断             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 10*           | 车连接状态                                  | 1             | 断开 1-半连接 2-连接                        |
|               |                                             |               | 直流目前只有0和2状态                        |
|               |                                             |               | 交流目前有0、1、2三种状态                   |
|               |                                             |               | 只有状态不为0时，手机才能下发开机指令       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 11**          | 本次充电累计充电费用                        | 4             | 从本次充电开始到目前的累计充电费用（包括电  |
|               |                                             |               | 费与服务费），这里是整型，要乘以0.01才能得  |
|               |                                             |               | 到真实的金额                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 12            | 内部变量2                                   | 4             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 13            | 内部变量3                                   | 4             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 14**          | 直流充电电压                                | 2             | 充电有效（直流有效，交流置0）               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 15**          | 直流充电电流                                | 2             | 充电有效（直流有效，交流置0）               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 16**          | BMS需求电压                                 | 2             | 充电有效（直流有效，交流置0）               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 17**          | BMS需求电流                                 | 2             | 充电有效（直流有效，交流置0）               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 18**          | BMS充电模式                                 | 1             | 恒压                                        |
|               |                                             |               | 恒流                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 19**          | 交流A相充电电压                             | 2             | 直流桩表示三相输入电压；                    |
|               |                                             |               | 交流桩有单相和三相输入电压                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 20**          | 交流B相充电电压                             | 2             | 交流桩单相输入，此项无效                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 21**          | 交流C相充电电压                             | 2             | 交流桩单相输入，此项无效                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 22*           | 交流A相充电电流                             | 2             | 直流桩表示三相输入电流；                    |
|               |                                             |               | 交流桩有单相和三相输入电流                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 23**          | 交流B相充电电流                             | 2             | 交流桩单相输入，此项无效                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 24**          | 交流C相充电电流                             | 2             | 交流桩单相输入，此项无效                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 25**          | 剩余充电时间(min)                           | 2             | 充电有效（直流有效，交流无效）              |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 26**          | 充电时长(秒)                                | 4             | 状态为充电时才有效                          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 27**          | 本次充电累计充电电量（0.01kwh）             | 4             | 状态为充电时才有效                          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 28            | 充电前电表读数                              | 4             | 0.01kw                                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 29            | 当前电表读数                                | 4             | 0.01kw                                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 30**          | 充电启动方式                                | 1             | 0：本地刷卡启动                             |
|               |                                             |               | 1：后台启动                                 |
|               |                                             |               | 2：本地管理员启动                           |
|               |                                             |               | 3：远程VIN验证启动                          |
|               |                                             |               | 4：远程密码验证启动                         |
|               |                                             |               | 5：本地VIN验证启动                          |
|               |                                             |               | 6：迪文界面流程启动                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 31            | 充电策略                                    | 1             | 0自动充满                                   |
|               |                                             |               | 1按时间充满                                 |
|               |                                             |               | 2定金额                                     |
|               |                                             |               | 3按电量充满                                 |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 32            | 充电策略参数                                | 4             | 时间单位为1秒                               |
|               |                                             |               | 金额单位为0.01元                            |
|               |                                             |               | 电量时单位为0.01kw                          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 33            | 预约标志                                    | 1             | 0-无预约（无效）                            |
|               |                                             |               | 1-预约有效                                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 34**          | 充电/预约卡号                               | 32            | ASCII码，不够长度填’\0’                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 35            | 预约超时时间                                | 1             | 单位分钟                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 36**          | 预约/开始充电开始时间                       | 8             | 标准时间                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 37            | 充电前卡余额                                | 4             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 38            | 预留                                        | 4             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 39**          | 充电功率                                    | 4             | 0.1Kw/BIT                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 40            | 系统变量3                                   | 4             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 41            | 系统变量4                                   | 4             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 42            | 系统变量5                                   | 4             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 43            | 出风口温度                                  | 1             | 偏移量-50，-50 - 200                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 44            | 环境温度                                    | 1             | 偏移量-50，-50 - 200                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 45            | 充电枪温度                                  | 1             | 偏移量-50，-50 - 200                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 46            | 车辆VIN码                                   | 18            | 直流桩有效,正常有效长度是17字节             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 47            | 舱门状态                                    | 1             | BIT0:                                       |
|               |                                             |               | 0：不在舱-开门；                            |
|               |                                             |               | 1：在舱-关门                                |
|               |                                             |               | BIT1:                                       |
|               |                                             |               | 0：充电用户不允许限充电功率                 |
|               |                                             |               | 1：充电用户允许限充电功率                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 48            | 充电流水号                                  | 32            |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 49            | 本次充电累计充电电费                        | 4             | 从本次充电开始到目前的累计充电电费，这里是  |
|               |                                             |               | 整型，要乘以0.01才能得到真实的金额          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 50            | 本次充电累计充电服务费                      | 4             | 从本次充电开始到目前的累计充电服务费，这里  |
|               |                                             |               | 是整型，要乘以0.01才能得到真实的金额        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 51            | 枪归位状态                                  | 1             | 0：归位                                     |
|               |                                             |               | 1：离位                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 52            | 地锁状态                                    | 1             | 0：开锁                                     |
|               |                                             |               | 1：闭锁                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 53            | 千分位电量                                  | 1             | 如平台不对电量第三位小数做强检要求可忽略本  |
|               |                                             |               | 字段。                                      |
|               |                                             |               | 如本字段为：0x09,千分位电量为0.009Kw*h      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 54            | 直流桩交流电表电量                          | 4             | 三位小数点，如10000表示10.0Kw.h             |
|               |                                             |               | 这个变量只有少数直流桩非标项目有接交流电表  |
|               |                                             |               | 才有这个量                                  |
|               |                                             |               |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 55            | 当前充电模式                                | 1             | 0/1-单枪充电                                |
|               |                                             |               | 2-单机柜双枪并充充电                        |
|               |                                             |               | 3-双机柜双枪并充充电                        |
|               |                                             |               |                                             |
|               |                                             |               | 因为充电桩有自动识别功能，所以会有可能在充  |
|               |                                             |               | 电中改变此状态，从0/1-->2，但变成并充状态后 |
|               |                                             |               | 不会恢复成单枪充电                          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 56            | 充放电标志                                  | 1             | 充电                                        |
|               |                                             |               | 0xf1-放电                                   |
|               |                                             |               |                                             |
|               |                                             |               | 非协议定义值，都表示充电                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```

    表3_2_4 充电桩状态信息包上报

    说明：

    当一桩有多个枪时，在一个上报周期内要把每个枪的状态单独上报。即总共只有一个一个socket连接并且会发
    送多个104报文给平台，但每个104报文中的字段3“充电桩编码”内容都是一样的，只是字段5“充电口（枪）
    号”会有1~N。

    建议桩的字段7“工作状态”发生变化时立即发送给后台。

    充电桩在可充电状态下收到后台启动指令时，立即把工作状态改变成“1-正准备开始充电”，若由“正准备开
    始充电”状态变成“0-空闲中、3-充电结束、4-启动失败、6-系统故障”，表示此次充电启动失败，状态由“
    0-空闲中或1-正准备开始充电”变成“2-充电进行中”则表示启动充电成功。

    一机多枪的机型，一个桩与后台只有一个socket连接，而不是每个枪都与平台有独立的socket连接。每个枪的
    终端在后台都要有一个独立的桩编码，但桩这里只会上传一个桩主编码，子编码要后台处理。如一种一机四枪
    的充电机，其只有一个主监控与后台通信，其，则其下面对应的四个枪的二维码编码则是“00112201”、“
    00112202”、“00112203”、“00112204”，每个枪的编码是后台根据桩编码和枪号来确定的，若用户扫码
    00112203桩进行充电，则后台要向桩号“001122”的通道3发送启动充电指令。桩编码为“001122”的多枪充
    电桩，字段3 不会有单独“00112201”向后台发送的报文。

    总电量 =本次充电累计充电电量(27字段)  + (千分位电量(52字段))/10


<a id="cmd-105"></a>
### 3.2.5  (cmd=105)服务器应答充电桩签到命令 [cmd=105]

    报文功能：后台服务器对收到充电桩签到报文后的应答，如表3_2_5所示。

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3             | 106报文随机数应答                           | 4             | 匹配码                                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4*            | 登入验证                                    | 1             | 0-不启用CMD1202认证                         |
|               |                                             |               | 1-启用CMD1202登入认证                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5*            | 加密标志                                    | 1             | 不加密                                      |
|               |                                             |               | ASE加密                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6             | RSA公共模数                                 | 128           | 字段5值为1时填充                            |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7*            | RSA公密                                     | 4             | 字段5值为1时填充                            |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8             | 启停用标志                                  | 1             | 0x00-正常使用                               |
|               |                                             |               | 0x55-暂停服务（只对在充电机空闲时有效）     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9             | 平台标准BCD时间                             | 8             | 充电桩校时                                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 10            | 平台是否支持三位小数222报文上传             | 1             | 0xDE-平台支持222三位小数上传                |
|               |                                             |               | 其他-使用202报文上传订单                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 11            | AES秘钥                                     | 32            | 如果加密通信，后续使用的AES秘钥值           |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```

    表3_2_5 服务器应答充电桩签到命令

    说明：

    由桩签到106报文的字段4可知道当前充电桩是否支持报文加密，桩支持加密才能下发字段5内容为1的报文。

    字段5内容为1时，后续桩没有断开当前socket连接时上传的报文应用数据都为加密格式


<a id="cmd-106"></a>
### 3.2.6  (cmd=106)充电桩签到信息上报 [cmd=106]

    报文功能：充电桩上报签到信息，如表3_2_6所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 标志                         | 1             | 不支持加密 1-支持ASE加密                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5*            | 充电桩软件版本               | 4             | 类型为小端整形（INT），如：                 |
|               |                              |               | 0x09 0x52 00 00表示：0x5209,则版本号为：    |
|               |                              |               | 210.01                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 充电桩项目类型               | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | 启动次数                     | 4             | 终端每次启动，计数保存                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 数据上传模式                 | 1             | 1：应答模式                                 |
|               |                              |               | 2：主动上报模式                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9*            | 签到间隔时间                 | 2             | 签到时间单位分钟                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 运行内部变量                 | 1             | 0:正常工作模式                              |
|               |                              |               | 1:IAP模式                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11*           | 充电枪个数                   | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | 心跳上报周期                 | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 心跳包检测超时次数           | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14*           | 充电记录数量                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15*           | 当前充电桩系统时间           | 8             | 标准时间                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16            | 预留                         | 8             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 预留                         | 8             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 预留                         | 8             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 桩生成随机数                 | 4             | 随机数                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 桩后台通信协议版本           | 2             | 十进制30表示V3.0                            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 白名单版本号                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22            | 设备类型                     | 1             | 充电桩                                      |
|               |                              |               | 1    集中器                                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23            | 充电桩资产编码               | 32            | ASCII编码，’/0’代表结束，最长32字节       |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_2_6 充电桩签到信息上报


    注意：以下情况需要上报该报文：

    充电桩上电完成初始化完成，与后台服务器连接成功，第一个发送签到信息到中心监控；此种方式报文不能加
    密。

    充电桩检测到网络中断以后，又恢复连接，自动向中心监控上报签到信息；此种方式报文不能加密。

    充电桩智能终端按照周期签到参数设置要求，自动定时向中心监控上报签到信息。此种方式根据之前服务器指
    示决定是否启用加密。

    服务可通过控制指令请求上发签到报文，此种方式根据之前服务器指示决定是否启用加密。

    当桩上报的“当前充电桩系统时间”误差大于5秒时，建议后台下发CMD=3中的同步时间命令，对充电桩时间进
    行同步。

    6.加密方式采用 AES256，CBC，PKCS7 方式加密,IV 则为：2022011808080855。

    7.桩收到启用加密标志后，后续通信报文全部采用AES256进行对业务数据进行加密。


<a id="cmd-107"></a>
### 3.2.7  (cmd=107)服务器应答充电桩告警信息 [cmd=107]

    服务器暂时不用回复，仅处理接收数据。


<a id="cmd-108"></a>
### 3.2.8  (cmd=108)充电桩告警信息上报(预留) [cmd=108]

    报文功能：充电桩告警信息，见表3_2_7所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 告警位信息    | 32            | 每一位代码一个告警，共可表示256个告警，具体 |
|               |               |               | 含义见附录4（为服务器能了解桩的告警信息）   |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_2_7 充电桩告警信息上报


    说明：

    当告警信息发生变化时立即上报，在告警信息没有发送变化时，目前暂定间隔10分钟上报一次

    桩出现告警不代表不能继续给车充电，桩出现告警后能不能继续充电要看CMD104中的序号7状态位是否为系统
    故障


<a id="cmd-109"></a>
### 3.2.9  (cmd=109)服务器应答充电桩启动完成命令 [cmd=109]

    报文功能：服务器应答充电桩启动完成命令，见表3_2_8所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
```

    表3_2_8 服务器应答充电桩启动完成命令


<a id="cmd-110"></a>
### 3.2.10 (cmd=110)充电桩上报充电启动完成命令(可选项) [cmd=110]

    报文功能：充电桩上报充电启动完成命令，见表3_2_9所示。

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                                  | 32            | ASCII编码                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪号                                    | 1             | 充电枪号                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5*            | 充电失败原因                                | 4             | 0表示充电启动成功，其他参考附录3            |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6*            | 发送此报文原因                              | 2             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7*            | 预留                                        | 2             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8*            | 预留                                        | 4             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9*            | BRM-BMS通讯协议版本号                       | 3             | 0x00 0x01 0x01表示v1.1                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 10*           | BRM-电池类型                                | 1             | 电池类型：0x01-铅酸电池，0x02-镍氢电池      |
|               |                                             |               | ,0x03-磷酸铁锂电池,0x04-锰酸锂电池,0x05-钴  |
|               |                                             |               | 酸锂电池,0x06-三元次料电池,0x07-聚合物锂离  |
|               |                                             |               | 子电池,0x08-钛酸锂电池,0xff-其他电池        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 11            | BRM-整车动力蓄电池系统额定容量/Ah           | 4             | 精度：0.1                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 12*           | BRM-整车动力蓄电池系统额定总电压/V          | 4             | 精度：0.1                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 13*           | BRM-电池生产厂商                            | 4             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 14*           | BRM-电池组序号                              | 4             | 预留，由厂商自行定义                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 15*           | BRM-电池组生厂日期：年                      | 2             | 如0x07 0xdf表示2015                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 16*           | BRM-电池组生厂日期：月                      | 1             | 如0x01表示1月                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 17            | BRM-电池组生厂日期：日                      | 1             | 如0x01表示1号                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 18*           | BRM-电池组充电次数                          | 4             | 以BMS统计为准                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 19*           | BRM-电池组产权标识                          | 1             | 0X01-表示租赁，0x01表示车自有               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 20*           | 预留                                        | 1             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 21*           | BRM-车辆识别码vin                           | 17            |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 22*           | BRM-BMS软件版本号                           | 8             | Byte1表示版本流水号：0x01~0xfe；            |
|               |                                             |               | byte2表示日：0x01表示1日；                  |
|               |                                             |               | byte3：0x01表示1月；                        |
|               |                                             |               | byte4和byte5表示年:0x07 0xdf表示2015年；    |
|               |                                             |               | Byte6和byte7、byte8预留，填0xffffff         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 23*           | BCP-单体动力蓄电池最高允许充电电压          | 4             | 根据分辨率：0.1A位，数据范围：0-24V         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 24*           | BCP-最高允许充电电流                        | 4             | 分辨率：0.1A/位                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 25*           | BCP-动力蓄电池标称总能量                    | 4             | 分辨率：0.1kw.h，范围0-1000kw.h             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 26*           | BCP-最高允许充电总电压                      | 4             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 27*           | BCP-最高允许温度                            | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 28*           | BCP-整车动力蓄电池荷电状态                  | 2             | 分辨率：0.1，0-100 %                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 29*           | BCP-整车动力蓄电池当前电池电压              | 4             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 30            | 充电流水号                                  | 32            |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```

    表3_2_9 充电桩上报充电启动完成命令


    注：

    在VIN方式自动充电模式时，一定要实现此命令接收完BRM报文获取到车辆的VIN编码，主动发送此报文给后台
    ，后台收到车辆VIN后决策是否插枪启动自动充电功能。

    此命令不是必发送报文，充电是否成功主要根据104状态和202、222订单报文。


<a id="cmd-111"></a>
### 3.2.11 (cmd=111)服务器应答充电桩上报模块信息(预留) [cmd=111]

    报文详细信息见表3_2_10所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 3*            | 报文类型      | 1             | 0-应答  1-查  |
|               |               |               | 询            |
+---------------+---------------+---------------+---------------+
```

    表3_2_10 服务器应答充电桩上报模块信息

    注：

    服务器如果主动下发查询，则设置字段3“报文类型”为1，收到充电机返回的112报文后就不需要再回复111报
    文。


<a id="cmd-112"></a>
### 3.2.12 (cmd=112)充电桩模块信息上报(预留) [cmd=112]

    报文功能：充电桩模块信息，见表3_2_11所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 上报方式      | 1             | 0-主动上报  1-被动查询                      |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 模块数量      | 1             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 6*            | 模块类型      | 1             | 0：500V标准；1：750V标准；2:500V恒功率模块  |
|               |               |               | ；3：750V恒功率模块；4：低压250V模块；5：第 |
|               |               |               | 二代恒功率模块；6：低压档100V模块；         |
+---------------+---------------+---------------+---------------------------------------------+
| 7*            | 模块1 AC版本  | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 8*            | 模块1 DC版本  | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 9*            | 模块1状态     | 1             | 0：离线                                     |
|               |               |               | 1：在线                                     |
+---------------+---------------+---------------+---------------------------------------------+
| 10*           | 模块1输出电压 | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 11*           | 模块1输出电流 | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 12*           | 模块1告警     | 4             | 参考附录8                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 13*           | 模块2 AC版本  | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 14*           | 模块2 DC版本  | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 15*           | 模块2状态     | 1             | 0：离线                                     |
|               |               |               | 1：在线                                     |
+---------------+---------------+---------------+---------------------------------------------+
| 16*           | 模块2输出电压 | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 17*           | 模块2输出电流 | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 18*           | 模块2告警     | 4             | 参考附录8                                   |
+---------------+---------------+---------------+---------------------------------------------+
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
|               |               |               |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| ……          | ……          | ……          | ……                                        |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_2_11 充电桩模块信息上报


<a id="cmd-113"></a>
### 3.2.13 (cmd=113)服务器查询最近一次充电各时段信息 [cmd=113]

    报文功能：服务器应答充电桩上报充电信息报文，如表3_2_12所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 3             | 充电口号      | 1             | 充电口号      |
+---------------+---------------+---------------+---------------+
| 4             | 标志          | 1             | 1-查询        |
+---------------+---------------+---------------+---------------+
```

    表3_2_12 服务器查询最近一次充电各时段信息


    注：1.此命令服务器根据业务需求主动下发给充电桩



<a id="cmd-114"></a>
### 3.2.14 (cmd=114)充电桩应答服务器查询最近一次充电各时段信息 [cmd=114]

    报文功能：充电桩上报充电信息，见表3_2_13所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪号                     | 1             | 充电枪号                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5*            | 工作状态                     | 1             | 0-空闲中                                    |
|               |                              |               | 1-正准备开始充电                            |
|               |                              |               | 2-充电进行中                                |
|               |                              |               | 3-充电结束                                  |
|               |                              |               | 4-启动失败                                  |
|               |                              |               | 5-预约状态                                  |
|               |                              |               | 6-系统故障(不能给汽车充电)                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6*            | 开始充电开始时间             | 8             | 标准时间，与104报文的36字段一样。           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 时段1充电电量                | 2             | [00:00:00~00:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8*            | 时段2充电电量                | 2             | [00:30:00~01:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9*            | 时段3充电电量                | 2             | [01:00:00~01:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10*           | 时段4充电电量                | 2             | [01:30:00~02:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11*           | 时段5充电电量                | 2             | [02:00:00~02:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12*           | 时段6充电电量                | 2             | [02:30:00~03:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13*           | 时段7充电电量                | 2             | [03:00:00~03:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14*           | 时段8充电电量                | 2             | [03:30:00~04:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15*           | 时段9充电电量                | 2             | [04:00:00~04:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16*           | 时段10充电电量               | 2             | [04:30:00~05:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17*           | 时段11充电电量               | 2             | [05:00:00~05:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18*           | 时段12充电电量               | 2             | [05:30:00~06:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19*           | 时段13充电电量               | 2             | [06:00:00~06:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20*           | 时段14充电电量               | 2             | [06:30:00~07:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21*           | 时段15充电电量               | 2             | [07:00:00~07:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22*           | 时段16充电电量               | 2             | [07:30:00~08:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23*           | 时段17充电电量               | 2             | [08:00:00~08:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24*           | 时段18充电电量               | 2             | [08:30:00~09:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25            | 时段19充电电量               | 2             | [09:00:00~09:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26*           | 时段20充电电量               | 2             | [09:30:00~10:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 27*           | 时段21充电电量               | 2             | [10:00:00~10:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 28*           | 时段22充电电量               | 2             | [10:30:00~11:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 29*           | 时段23充电电量               | 2             | [11:00:00~11:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 30*           | 时段24充电电量               | 2             | [11:30:00~12:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 31*           | 时段25充电电量               | 2             | [12:00:00~12:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 32*           | 时段26充电电量               | 2             | [12:30:00~13:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 33*           | 时段27充电电量               | 2             | [13:00:00~13:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 34*           | 时段28充电电量               | 2             | [13:30:00~14:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 35*           | 时段29充电电量               | 2             | [14:00:00~14:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 36*           | 时段30充电电量               | 2             | [14:30:00~15:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 37*           | 时段31充电电量               | 2             | [15:00:00~15:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 38*           | 时段32充电电量               | 2             | [15:30:00~16:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 39*           | 时段33充电电量               | 2             | [16:00:00~16:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 40*           | 时段34充电电量               | 2             | [16:30:00~17:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 41*           | 时段35充电电量               | 2             | [17:00:00~17:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 42*           | 时段36充电电量               | 2             | [17:30:00~18:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 43*           | 时段37充电电量               | 2             | [18:00:00~18:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 44*           | 时段38充电电量               | 2             | [18:30:00~19:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 45*           | 时段39充电电量               | 2             | [19:00:00~19:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 46*           | 时段40充电电量               | 2             | [19:30:00~20:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 47*           | 时段41充电电量               | 2             | [20:00:00~20:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 48*           | 时段42充电电量               | 2             | [20:30:00~21:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 49*           | 时段43充电电量               | 2             | [21:00:00~21:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 50*           | 时段44充电电量               | 2             | [21:30:00~22:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 51*           | 时段45充电电量               | 2             | [22:00:00~22:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 52*           | 时段46充电电量               | 2             | [22:30:00~23:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 53*           | 时段47充电电量               | 2             | [23:00:00~23:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 54*           | 时段48充电电量               | 2             | [23:30:00~00:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_2_13 最近一次充电各时段信息


    注：此报文充电桩不主动上报，服务器下发CMD113查询命令来时才应答此报文。


    3.3  充电信息数据

    3.3.1  (CMD=201/221)服务器应答充电桩上报充电信息报文

    报文功能：服务器应答充电桩上报充电信息报文，见表3_3_1所示。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 充电口号                     | 1             | 充电口号                     |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 充电卡号                     | 32            | ASCII码                      |
+---------------+------------------------------+---------------+------------------------------+
| 5*            | 内部索引号                   | 4             | 与202报文字段17一致          |
+---------------+------------------------------+---------------+------------------------------+
| 6             | 7、8、9字段有效标志          | 1             | 无效                         |
|               |                              |               | 有效                         |
+---------------+------------------------------+---------------+------------------------------+
| 7             | 充电优惠前金额               | 4             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 8             | 充电折扣金额                 | 4             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 9             | 充电实扣金额                 | 4             | 优惠后实扣金额               |
+---------------+------------------------------+---------------+------------------------------+
| 10            | 用户剩余金额                 | 4             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 11            | 充电实扣电费                 | 4             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 12            | 充电实扣服务费               | 4             |                              |
+---------------+------------------------------+---------------+------------------------------+
```

    表3_3_1 务器应答充电桩上报充电信息报文

    说明：201 报文对应回复桩上传202报文 ;221 报文对应回复桩上传222报文


    3.3.2  (CMD=202/222)充电桩上报充电记录信息

    报文功能：充电桩上报充电信息。充电桩给汽车充完电，网络正常应该立即上报此报文，见表3_3_2所示。

    CMD=222 也是充电桩上报订单报文，整个报文字段内容跟202一样，只不过202上报的订单所有电量字段都是放
    大100倍（电量保留两位小数点），而222报文的所有电量字段放大1000倍，即精度为0.001kwh（电量保留三位
    小数），桩上传订单202报文，平台用201应答;桩上传订单222报文，平台用221应答.

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪位置类型               | 1             | 1-直流 2-交流                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 充电枪口                     | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6*            | 充电卡号                     | 32            | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 充电开始时间                 | 8             | 标准时间                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8*            | 充电结束时间                 | 8             | 标准时间                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9*            | 充电时间长度                 | 4             | 单位秒                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10*           | 开始SOC                      | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11*           | 结束SOC                      | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12*           | 充电结束原因                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13*           | 本次充电电量                 | 4             | 命令202报文此字段单位是0.01kWh/bit          |
|               |                              |               | 命令222报文此字段单位是0.001kWh/bit         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 充电前电表读数               | 4             | 命令202报文此字段单位是0.01kWh/bit          |
|               |                              |               | 命令222报文此字段单位是0.001kWh/bit         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 充电后电表读数               | 4             | 命令202报文此字段单位是0.01kWh/bit          |
|               |                              |               | 命令222报文此字段单位是0.001kWh/bit         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16*           | 本次充电金额                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17*           | 内部索引号                   | 4             | 4字节有符号整形，每一条充电记录都唯一编号,  |
|               |                              |               | 用于充电机内部做唯一标志                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 充电前卡余额                 | 4             | 只有在刷卡启动及卡里有金额的应用模式才有效  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 当前充电记录索引             | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 总充电记录条目               | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 预留                         | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22*           | 充电策略                     | 1             | 0:充满为止                                  |
|               |                              |               | 1:时间控制充电                              |
|               |                              |               | 2:金额控制充电                              |
|               |                              |               | 3:电量控制充电                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23*           | 充电策略参数                 | 4             | 时间单位为1秒                               |
|               |                              |               | 金额单位为0.01元                            |
|               |                              |               | 电量时单位为0.01kw                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24*           | 车辆 VIN                     | 17            | 直流桩上传，没有填’\0’                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25            | 车牌号                       | 8             | 可选项，没有填’\0’                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26*           | 时段1充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [00:00:00~00:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段1                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令222报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 27*           | 时段2充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [00:30:00~01:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段2                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令222报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 28*           | 时段3充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [01:00:00~01:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段3                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令222报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 29*           | 时段4充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [01:30:00~02:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段4                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令222报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 30*           | 时段5充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [02:00:00~02:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段5                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令222报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 31*           | 时段6充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [02:30:00~03:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段6                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令222报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 32*           | 时段7充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [03:00:00~03:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段7                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 33*           | 时段8充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [03:30:00~04:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段8                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 34*           | 时段9充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [04:00:00~04:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段9                                       |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 35*           | 时段10充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [04:30:00~05:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段10                                      |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 36*           | 时段11充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [05:00:00~05:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段11                                      |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 37*           | 时段12充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [05:30:00~06:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段12（分时段最大时段数）                  |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 38*           | 时段13充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [06:00:00~06:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 无效时段                                    |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 39*           | 时段14充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [06:30:00~07:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 无效时段                                    |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 40*           | 时段15充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [07:00:00~07:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 无效时段                                    |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 41*           | 时段16充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [07:30:00~08:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 无效时段                                    |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
|               | ……                         | …            | 48时段费率模型（1103）生效：                |
|               |                              |               | 半小时一个时段                              |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 无效时段                                    |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 73*           | 时段48充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [23:30:00~00:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 无效时段                                    |
|               |                              |               |                                             |
|               |                              |               | 命令202报文此字段是2字节，命令222报文此字段 |
|               |                              |               | 是4字节                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 74*           | 启动方式                     | 1             | 0：本地刷卡启动                             |
|               |                              |               | 1：后台启动                                 |
|               |                              |               | 2：本地管理员启动                           |
|               |                              |               | 3：远程VIN验证启动                          |
|               |                              |               | 4：远程密码验证启动                         |
|               |                              |               | 5：本地VIN验证启动                          |
|               |                              |               | 6：迪文界面流程启动                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 75            | 充电流水号                   | 32            | Tips:建议使用ASCII码                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 76            | 充电服务费                   | 4             | 分辨率0.01元                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 77            | 千分位电量                   | 1             | 如平台不对电量第三位小数做强检要求可忽略本  |
|               |                              |               | 字段。                                      |
|               |                              |               | 如本字段为：0x09,千分位电量为0.009Kw*h      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 78            | 并充标志                     | 1             | 0/1-单枪充电                                |
|               |                              |               | 2-单机柜双枪并充充电                        |
|               |                              |               | 3-双机柜双枪并充充电                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 79            | 充放电标志                   |               | 充电                                        |
|               |                              |               | 0xf1-放电                                   |
|               |                              |               |                                             |
|               |                              |               | 非协议定义值，都表示充电                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 80            | 电表加密数据                 | 34            | 瑞银电表解密后数据内容为：                  |
|               |                              |               | 17 字节枪口识别号(BCD)                      |
|               |                              |               | 4 字节计量开始时间(秒时戳,HEX)              |
|               |                              |               | 4 字节计量结束时间(秒时戳,HEX)              |
|               |                              |               | 4 字节正向充电电量(3 位小数,HEX)            |
|               |                              |               | 4 字节电表安装时间(秒时戳,HEX)              |
|               |                              |               | 1 字节端钮历史状态(0 正常，1 发生过端钮盖打 |
|               |                              |               | 开时间)                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 81            | 电表表号                     | 6             | 瑞银电表表号(BCD)                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 82            | 电表协议版本                 | 2             | 瑞银电表通讯协议版本号(HEX)                 |
+---------------+------------------------------+---------------+---------------------------------------------+
| 83            | 加密方式                     | 1             | 当前加密方式(工厂模式下配置，抄             |
|               |                              |               | 读无任何限制)                               |
|               |                              |               | 00:软件AES128 加密                          |
|               |                              |               | 01:RJMU 国密SM1(暂不支持)                   |
|               |                              |               | 02:RJMU 国密SM4(暂不支持)                   |
|               |                              |               | 03:国网ESAM 加密                            |
|               |                              |               | 04:ECC256 签名算法                          |
|               |                              |               | 05:其他                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_3_2 充电桩上报充电记录信息

    说明：

    此条报文是充电费用的依据，是充电桩最重要的报文。后台收到此报文，一定要进行入数据库持久化保存，严
    禁丢弃，除非判断是重复订单才可以过滤掉。

    “重复订单”的判断依据是，当前收到的202/222订单报文的字段“6-充电卡号、7-充电开始时间、8-充电结
    束时间、10-充电开始SOC、11-充电结束SOC、12-充电结束原因，13-充电电量、14-充电前电表读数、24-车辆
    VIN、75-充电流水号”这些所有字段与之前已入库的订单字段全部一模一样时，才能判定为重复订单，只要任
    何一个字段有差异，都不能判定是重复订单，都要进行入库计费处理或进行人员审核结算。

    若平台收到有异常字段的订单，也不能丢弃掉异常字段的202订单报文，平台必须对任何判断异常的订单进行
    存储，需在WEB端列出异常订单条目，并让运营商管理员对此类异常订单进行人工审核和结算。


    4.若上报此报文没有收到服务器应答报文，则间隔10再上报，直到服务器应答为止，平台收到202报文，必须
    无任何条件要进行回复201报文。

    5.充电桩为了保证记录能到送达后台，保证充电订单不丢失，会出现一条充电记录多次上传给后台。而且建议
    充电桩刚上电时第一次连接后台成功时，把最近的50（这个条目可能变化）条充电记录上报给后台。所以后台
    得具有重复报文过滤功能，当收到的新的202订单报文的字段“6-充电卡号、7-充电开始时间、8-充电结束时
    间、10-充电开始SOC、11-充电结束SOC、12-充电结束原因，13-充电电量、14-充电前电表读数、24-车辆VIN
    、75-充电流水号”所历史入库的订单字段内容全部一样时，才能判断为同一条充电记录。

    总电量 = 本次充电电量(13字段)  + (千分位电量(77字段))/10

    总费用 = 本次充电金额(16字段)  +  (千分位电量(77字段) * 当前时段费率)/1000


<a id="cmd-203"></a>
### 3.3.3  (cmd=203)服务器应答帐户查询信息 [cmd=203]

    报文功能：服务器应答充电桩充电上报最新一次充电信息报文，见表3_3_3所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 响应码                       | 4             | 0:有效帐户                                  |
|               |                              |               | 1:非法帐户（黑卡等）                        |
|               |                              |               | 2:余额不足                                  |
|               |                              |               | 3:把黑卡恢复成正常卡                        |
|               |                              |               | 4:把正常卡变黑卡                            |
|               |                              |               | 5:非法卡号（卡号不存在）                    |
|               |                              |               | 6:挂失                                      |
|               |                              |               | 7:销卡（桩端写卡）                          |
|               |                              |               | 8．密码错误                                 |
|               |                              |               | 9.功能不支持                                |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 帐户余额                     | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 全时段电费费率(预留)         | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 服务费率(预留)               | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 充电密码验证                 | 1             | 0-不验证1-验证                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 验证VIN标志                  | 1             | 0-不验证1-验证                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 车牌验证(预留)               | 1             | 0-不验证1-验证                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 预留                         | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 流水号                       | 32            | 后台不下发则本地生成                        |
|               |                              |               | （推荐ASCII）                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12            | VIN                          | 17            | 当卡绑定了VIN后，下发有效值，如果没有绑定， |
|               |                              |               | 默认全填0                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13            | 充电枪号                     | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_3_3 服务器应答帐户查询信息


<a id="cmd-204"></a>
### 3.3.4  (cmd=204)充电桩充电上传用户帐户查询报文 [cmd=204]

    报文功能：充电桩充电上传用户帐户查询报文，见表3_3_4所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 充电卡号                     | 32            | ASCII码，不足补’\0’                       |
|               |                              |               | 默认卡号是固定16位，不足会在前面补‘0’，如 |
|               |                              |               | 卡号“12233445566”默认是上传“             |
|               |                              |               | 0000112233445566”                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5*            | 充电卡余额                   | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6*            | 充电卡黑白名单标志           | 1             | 0x00-正常卡                                 |
|               |                              |               | 0x01-黑卡                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 用户充电卡密码               | 32            | 用户输入密码（约定6位）后，对密码进行MD5 32 |
|               |                              |               | 位加密的密文                                |
|               |                              |               | 用户选择无密码时，每个字节均为0x00          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 卡扇区数据随机数             | 48            | 充电卡第9号扇区0号block上前三块48字节数据   |
|               |                              |               | 字符串ASCII编码方式编码，字符串使用字符串结 |
|               |                              |               | 束符’\0’结束                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | M1卡序号                     | 4             | M1卡时有效，没有填0                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10            | 认证方式                     | 1             | 0:刷卡认证 1：密码充电认证                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11            | 充电枪号                     | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_3_4 充电桩充电上传用户帐户查询报文


    注：

    旧版本协议报文没有7、8字段，那就是桩在此报文不上传相应的用户充电卡密码。

    字段8 “卡扇区数据”在发卡时需要为每个充电卡写入一个随机的48字节字符串数据，在此增加此字段主要考
    虑充电卡的安全性。用户刷卡后充电桩上传此字段到后台，后台比较之前的发卡数据，即可验证当前卡是否合
    法卡。

    若发卡系统有能力，最好其发卡时写入的随机“卡扇区数据”通过MD5加密后进行保存，充电桩后台服务器收
    到桩CMD204上传“卡扇区数据随机数”字段后，先进行MD5运算，然后再与数据库的值进行比较，若一直就认
    为卡是合法的。这样可以进一步保证充电卡的安全。

    账户+密码验证方式充电，若平台不支持，回复的203报文响应码不能是“0：有效账户”


<a id="cmd-205"></a>
### 3.3.5  (cmd=205)服务器应答充电密码验证报文(预留) [cmd=205]

    报文功能：服务器应答充电密码验证报文，见表3_3_5所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 响应码        | 4             | 0：密码正确                  |
|               |               |               | 其它:密码错误                |
+---------------+---------------+---------------+------------------------------+
| 4*            | 帐户余额      | 4             | 密码正确是填真实数据，否则填 |
|               |               |               | 0                            |
+---------------+---------------+---------------+------------------------------+
```

    表3_3_5 服务器应答充电密码验证报文


<a id="cmd-206"></a>
### 3.3.6  (cmd=206)充电桩上传用户密码验证报文(预留) [cmd=206]

    报文功能：充电桩上传用户密码验证报文，见表3_3_6所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 充电卡号                     | 32            | ASCII码，不足补’\0’                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5*            | 用户充电密码                 | 32            | 用户输入密码（约定6位）后，对密码进行MD5 32 |
|               |                              |               | 位加密的密文                                |
|               |                              |               | 用户选择无密码时，每个字节均为0xFF          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | 卡扇区数据随机数             | 48            | 充电卡第9号扇区0号block上前三块48字节数据字 |
|               |                              |               | 符串ASCII编码方式编码，字符串使用字符串结束 |
|               |                              |               | 符’\0’结束                                |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_3_6 充电桩上传用户密码验证报文


    注：

    字段6 “卡扇区数据随机数”在发卡时需要为每个充电卡写入一个随机的48字节字符串数据，在此增加此字段
    主要考虑充电卡的安全性。用户刷卡后充电桩上传此字段到后台，后台比较之前的发卡数据，即可验证当前卡
    是否合法卡。

    若发卡系统有能力，最好其发卡时写入的随机“卡扇区数据”通过MD5加密后进行保存，充电桩后台服务器收
    到桩CMD204上传“卡扇区数据随机数”字段后，先进行MD5运算，然后再与数据库的值进行比较，若一直就认
    为卡是合法的。这样可以进一步保证充电卡的安全。

<a id="cmd-207"></a>
### 3.3.7  (cmd=207) 平台回复”即插即充“请求充电结果 [cmd=207]

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪号                     | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5*            | 车辆VIN码                    | 17            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6*            | 车辆VIN 绑定账号             | 32            | ASCII编码，可以是卡号/账号等，如无则填0xff. |
|               |                              |               | 离线充电则由桩填写空。                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 充电流水号                   | 32            | ASCII编码，验证通过平台应下发本次充电的流水 |
|               |                              |               | 号，离线的话由桩本地生成流水号。            |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8*            | 验证结果                     | 1             | 1:成功可启动充电。2:失败停止充电。          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9*            | 验证原因                     | 1             | 当字段7为 2，此字段有意义：                 |
|               |                              |               | 1:余额不足2:车辆被冻结3:黑名单车辆4:未知车  |
|               |                              |               | 辆5:当前车辆不允许VIN充电，6:其他原因       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10*           | 可充电余额                   | 4             | 如果没有使用到的可以发0x00                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11*           | 屏幕停机密码                 | 6             | ASIIC编码，密码纯数字。当桩即插即充启动成功 |
|               |                              |               | 后，可以在屏幕上输入此密码进行停机，如果没  |
|               |                              |               | 有则填0xff。                                |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-208"></a>
### 3.3.8  (cmd=208) 充电桩上报“即插即充“启动充电请求 [cmd=208]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 充电枪号      | 1             |                              |
+---------------+---------------+---------------+------------------------------+
| 5*            | 车辆VIN 码    | 17            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 6*            | 充电满策略    | 1             | 0:充满为止                   |
|               |               |               | 1:时间控制充电               |
|               |               |               | 2:金额控制充电               |
|               |               |               | 3:电量控制充电               |
+---------------+---------------+---------------+------------------------------+
| 7*            | 充电满策略参  | 4             | 时间单位为1秒                |
|               | 数            |               | 金额单位为0.01元             |
|               |               |               | 电量时单位为0.01kw           |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-209"></a>
### 3.3.9  (cmd=209) 平台回复“即插即充” 启动充电结果(没用) [cmd=209]

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 3*            | 充电桩编码    | 32            | ASCII编码     |
+---------------+---------------+---------------+---------------+
| 4*            | 充电枪号      | 1             |               |
+---------------+---------------+---------------+---------------+
| 5*            | 车辆VIN 码    | 17            | ASCII编码     |
+---------------+---------------+---------------+---------------+
```

<a id="cmd-210"></a>
### 3.3.10 (cmd=210)充电桩上报“即插即充” 启动充电结果(没用) [cmd=210]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 充电枪号      | 1             |                              |
+---------------+---------------+---------------+------------------------------+
| 5*            | 启动结果      | 4             | 0:正常，其他:按照故障编码上  |
|               |               |               | 传                           |
+---------------+---------------+---------------+------------------------------+
```

    3.4  直流充电桩BMS信息数据(预留)

<a id="cmd-301"></a>
### 3.4.1  (cmd=301)服务器应答充电桩上报BMS信息 [cmd=301]

    报文功能：服务器应答充电桩上报BMS信息，见表3_4_1所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
```

    表3_4_1 服务器应答充电桩上报BMS信息

<a id="cmd-302"></a>
### 3.4.2  (cmd=302)充电桩上报BMS信息 [cmd=302]

    报文功能：直流充电桩上报BMS信息，见表3_4_2所示。

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1             | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2*            | 预留                                        | 2             | 预留                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3*            | 报文次序计数                                | 2             | 从1开始计数，溢出后重新从1开始计数          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪号                                    | 2             | 充电枪号                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5*            | 充电桩编码                                  | 32            | ASCII编码                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6*            | 工作状态                                    | 1             | 0-空闲中                                    |
|               |                                             |               | 1-正准备开始充电                            |
|               |                                             |               | 2-充电进行中                                |
|               |                                             |               | 3-充电结束                                  |
|               |                                             |               | 4-启动失败                                  |
|               |                                             |               | 5-预约状态                                  |
|               |                                             |               | 6-系统故障(不能给汽车充电)                  |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7*            | 车连接状态                                  | 1             | 0-断开 1-半连接 2-连接                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8*            | BRM-BMS通讯协议版本号                       | 3             | 0x00 0x01 0x01表示v1.1                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9*            | BRM-电池类型                                | 1             | 电池类型：0x01-铅酸电池，0x02-镍氢电池      |
|               |                                             |               | ,0x03-磷酸铁锂电池,0x04-锰酸锂电池,0x05-钴  |
|               |                                             |               | 酸锂电池,0x06-三元次料电池,0x07-聚合物锂离  |
|               |                                             |               | 子电池,0x08-钛酸锂电池,0xff-其他电池        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 10*           | BRM-整车动力蓄电池系统额定容量/Ah           | 4             | 精度：0.1                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 11            | BRM-整车动力蓄电池系统额定总电压/V          | 4             | 精度：0.1                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 12*           | BRM-电池生产厂商                            | 4             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 13*           | BRM-电池组序号                              | 4             | 预留，由厂商自行定义                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 14*           | BRM-电池组生厂日期：年                      | 2             | 如0x07 0xdf表示2015                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 15*           | BRM-电池组生厂日期：月                      | 1             | 如0x01表示1月                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 16*           | BRM-电池组生厂日期：日                      | 1             | 如0x01表示1号                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 17            | BRM-电池组充电次数                          | 4             | 以BMS统计为准                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 18*           | BRM-电池组产权标识                          | 1             | 0X01-表示租赁，0x01表示车自有               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 19*           | 预留                                        | 1             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 20*           | BRM-车辆识别码vin                           | 17            |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 21*           | BRM-BMS软件版本号                           | 8             | Byte1表示版本流水号：0x01~0xfe；            |
|               |                                             |               | byte2表示日：0x01表示1日；                  |
|               |                                             |               | byte3：0x01表示1月；                        |
|               |                                             |               | byte4和byte5表示年:0x07 0xdf表示2015年；    |
|               |                                             |               | Byte6和byte7、byte8预留，填0xffffff         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 22*           | BCP-单体动力蓄电池最高允许充电电压          | 4             | 根据分辨率：0.1A位，数据范围：0-24V         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 23*           | BCP-最高允许充电电流                        | 4             | 分辨率：0.1A/位                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 24*           | BCP-动力蓄电池标称总能量                    | 4             | 分辨率：0.1kw.h，范围0-1000kw.h             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 25*           | BCP-最高允许充电总电压                      | 4             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 26*           | BCP-最高允许温度                            | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 27*           | BCP-整车动力蓄电池荷电状态                  | 2             | 分辨率：0.1，0-100 %                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 28*           | BCP-整车动力蓄电池当前电池电压              | 4             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 29*           | BRO-BMS是否充电准备好                       | 1             | 0x00-表示未做好充电准备，0xaa表示BMS完成充  |
|               |                                             |               | 电准备，0xff表示无效                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 30*           | BCL-电压需求                                | 4             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 31*           | BCL-电流需求                                | 4             | 分辨率：0.1A                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 32*           | BCL-充电模式                                | 1             | 0x01表示恒压充电，0x02表示恒流充电          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 33*           | BCS-充电电压测量值                          | 4             | 分辨率：0.1V                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 34*           | BCS-充电电流测量值                          | 4             | 分辨率：0.1A                                |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 35*           | BCS-最高单体动力蓄电池电压                  | 4             | 分辨率：0.01V                               |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 36*           | BCS-最高单体动力蓄电池组号                  | 1             | 0-15                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 37*           | BCS-当前荷电状态soc%                        | 2             | 分辨率：0.1，0-100%                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 38*           | 估算剩余充电时间                            | 4             | 0-600min                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 39*           | BSM-最高单体动力蓄电池电压所在编号          | 1             | 1-256                                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 40*           | BSM-最高动力蓄电池温度                      | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 41*           | BSM-最高温度检测点编号                      | 1             | 1-128                                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 42*           | BSM-最低动力蓄电池温度                      | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 43*           | BSM-最低动力蓄电池温度检测点编号            | 1             | 1-128                                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 44*           | BSM-单体动力蓄电池电压过高或过低            | 1             | 0x00-正常，0x01-过高，0x10-过低             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 45*           | BSM-整车动力蓄电池荷电状态soc过高或过低     | 1             | 0x00-正常，0x01-过高，0x10-过低             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 46*           | BSM-动力蓄电池充电过电流                    | 1             | 0x00-正常，0x01-过流，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 47*           | BSM-动力蓄电池温度过高                      | 1             | 0x00-正常，0x01-过高，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 48*           | BSM-动力蓄电池绝缘状态                      | 1             | 0x00-正常，0x01-不正常，0x10-不可信状态     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 49*           | BSM-动力蓄电池组输出连接器连接状态          | 1             | 0x00-正常，0x01-不正常，0x10-不可信状态     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 50*           | BSM-允许充电                                | 1             | 0x00-禁止，0x01-允许                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 51*           | BST-BMS达到所需求的SOC目标值                | 1             | 0x00-未达到所需soc目标值，0x01-达到所需soc  |
|               |                                             |               | 目标值，0x10-不可信状态                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 52*           | BST-BMS达到总电压的设定值                   | 1             | 0x00-未达到总电压设定值，0x01-达到总电压设  |
|               |                                             |               | 定值，0x10-不可信状态                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 53*           | BST-达到单体电压的设定值                    | 1             | 0x00-未达到单体电压设定值，0x01-达到单体电  |
|               |                                             |               | 压设定值，0x10-不可信状态                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 54*           | BST-充电机主动终止                          | 1             | 0x00-正常，0x01-充电机终止，0x10-不可信状态 |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 55*           | BST-绝缘故障                                | 1             | 0x00-正常，0x01-故障，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 56*           | BST-输出连接器过温故障                      | 1             | 0x00-正常，0x01-故障，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 57*           | BST-BMS元件，输出连接器过温                 | 1             | 0x00-正常，0x01-故障，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 58*           | BST-充电连接器故障                          | 1             | 0x00-充电连接器正常，0x01-充电连接器故障，  |
|               |                                             |               | 0x10-不可信状态                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 59*           | BST-电池组温度过高故障                      | 1             | 0x00-电池组温度正常，0x01-电池组温度过高，  |
|               |                                             |               | 0x10-不可信状态                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 60*           | BST-高压继电器故障                          | 1             | 0x00-正常，0x01-故障，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 61*           | BST-检测点2电压检测故障                     | 1             | 0x00-正常，0x01-故障，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 62*           | BST-其他故障                                | 1             | 0x00-正常，0x01-故障，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 63*           | BST-电流过大                                | 1             | 0x00-电流正常，0x01-电流超过需求值，0x10-不 |
|               |                                             |               | 可信状态                                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 64*           | BST-电压异常                                | 1             | 0x00-正常，0x01-电压异常，0x10-不可信状态   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 65*           | BSD-终止荷电状态soc                         | 2             | 分辨率：0.1，0-100%                         |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 66*           | BSD-动力蓄电池单体最低电压                  | 4             | 分辨率：0.01,0-24                           |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 67*           | BSD-动力蓄电池单体最高电压                  | 4             | 分辨率：0.01,0-24                           |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 68*           | BSD-动力蓄电池最低温度                      | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 69*           | BSD-动力蓄电池最高温度                      | 1             | 对-50的偏移量，0表示50，250表示200          |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 70*           | BEM-接收SPN2560=0x00的充电机辨识报文超时    | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 71*           | BEM-接收SPN2560=0xaa的充电机辨识报文超时    | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 72*           | BEM-接收充电机的时间同步和最大输出能力报文  | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
|               | 超时                                        |               |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 73*           | BEM-接收充电机完成充电准备报文超时          | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 74*           | BEM-接收充电机充电状态报文超时              | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 75*           | BEM-接收充电机终止充电报文超时              | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 76*           | BEM-接收充电机充电统计报文超时              | 1             | 0x00-正常，0x01-超时，0x10-不可信状态       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 77*           | BEM-其他                                    | 1             |                                             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```

    表3_4_2 直流充电桩上报BMS信息


    注：

    直流桩进入充电阶段时，上报此报文。

    在充电过程中，目前暂时先按30s上报一次。

    一般情况用302格式上报给服务器。

<a id="cmd-303"></a>
### 3.4.3  (cmd=303)服务器应答充电桩上报BMS信息 [cmd=303]

    报文功能：服务器应答充电桩上报BMS信息，见表3_4_3所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             | 预留          |
+---------------+---------------+---------------+---------------+
```

    表3_4_3 服务器应答充电桩上报BMS信息


<a id="cmd-304"></a>
### 3.4.4  (cmd=304)充电桩上报BMS信息(预留-暂时不用) [cmd=304]

    报文功能：充电桩上报BMS信息，见表3_4_4所示。

```text
+---------------+------------------------------+---------------+------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                         |
+---------------+------------------------------+---------------+------------------------------+
| 1             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 2             | 预留                         | 2             | 预留                         |
+---------------+------------------------------+---------------+------------------------------+
| 3             | 充电桩编码                   | 32            | ASCII编码                    |
+---------------+------------------------------+---------------+------------------------------+
| 4             | 工作状态                     | 1             | 0-空闲中                     |
|               |                              |               | 1-正准备开始充电             |
|               |                              |               | 2-充电进行中                 |
|               |                              |               | 3-充电结束                   |
|               |                              |               | 4-启动失败                   |
|               |                              |               | 5-预约状态                   |
|               |                              |               | 6-系统故障(不能给汽车充电)   |
+---------------+------------------------------+---------------+------------------------------+
| 5             | 车连接状态                   | 1             | 0-断开 1-半连接 2-连接       |
+---------------+------------------------------+---------------+------------------------------+
| 6             | BRM车辆辨识报文              | 64            |                              |
+---------------+------------------------------+---------------+------------------------------+
| 7             | VBI报文                      | 64            |                              |
+---------------+------------------------------+---------------+------------------------------+
| 8             | BCP动力蓄电池充电参数        | 16            |                              |
+---------------+------------------------------+---------------+------------------------------+
| 9             | BRO电池充电准备就绪状态      | 8             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 10            | BCL电池充电需求              | 8             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 11            | BCS电池充电总状态            | 16            |                              |
+---------------+------------------------------+---------------+------------------------------+
| 12            | BSM动力蓄电池状态信息        | 8             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 13            | BST中止充电                  | 8             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 14            | BSD BMS统计数据              | 8             |                              |
+---------------+------------------------------+---------------+------------------------------+
| 15            | BEM报文                      | 8             |                              |
+---------------+------------------------------+---------------+------------------------------+
```

    表3_4_4 充电桩上报BMS信息


    注：

    进入阶段时，上报此报文

    在充电过程中，目前暂时先按1分钟上报一次

    3.5  历史记录

    3.5.3  (CMD=401/421)服务器查询充电桩历史充电记录

    报文功能：服务器查询充电桩历史充电记录，见表3_4_5所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 查询记录起始索引             | 4             | 值越大表示越旧, 0表示查询最近一条充电记录   |
|               |                              |               | 1表示查询最近倒数第2次充电记录，以此类推    |
+---------------+------------------------------+---------------+---------------------------------------------+
| *4            | 充电流水号                   | 32            |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_4_5 服务器查询充电桩历史充电记录


    注：

    一次只能查询一条充电记录。

    查询记录起始索引不能超过充电桩中最大的充电记录条数。

    401 报文对应回复桩上传402报文 ;421 报文对应回复桩上传422报文


    3.5.4  (CMD=402/422)充电桩上报历史的充电记录

    CMD=422 也是充电桩上报历史充电记录报文，整个报文字段内容跟422一样，只不过402上报的订单所有电量字
    段都是放大100倍（电量保留两位小数点），而422报文的所有电量字段放大1000倍，即精度为0.001kwh（电量
    保留三位小数），桩上传订单402报文，平台用401应答;桩上传订单422报文，平台用421应答.


    报文功能：充电桩上报历史的充电记录信息，见表3_4_6所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 充电枪位置类型               | 1             | 1-直流 2-交流                               |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | 充电枪口                     | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6*            | 充电卡号                     | 32            | ASCII码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 充电开始时间                 | 8             | 标准时间                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8*            | 充电结束时间                 | 8             | 标准时间                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9*            | 充电时间长度                 | 4             | 单位秒                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 10*           | 开始SOC                      | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 11*           | 结束SOC                      | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 12*           | 充电结束原因                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 13*           | 本次充电电量                 | 4             | 命令402报文此字段单位是0.01kWh/bit          |
|               |                              |               | 命令422报文此字段单位是0.001kWh/bit         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 14            | 充电前电表读数               | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 15            | 充电后电表读数               | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 16*           | 本次充电金额                 | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17            | 内部索引号                   | 4             | 每一条充电记录都唯一编号                    |
|               |                              |               | 有符号整形，-1表示查询失败                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 18            | 充电前卡余额                 | 4             | 只有在刷卡启动及卡里有金额的应用模式才有效  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 19            | 当前充电记录索引             | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 20            | 总充电记录条目               | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 21            | 预留                         | 1             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 22*           | 充电策略                     | 1             | 0:充满为止                                  |
|               |                              |               | 1:时间控制充电                              |
|               |                              |               | 2:金额控制充电                              |
|               |                              |               | 3:电量控制充电                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 23*           | 充电策略参数                 | 4             | 时间单位为1秒                               |
|               |                              |               | 金额单位为0.01元                            |
|               |                              |               | 电量时单位为0.01kw                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 24*           | 车辆 VIN                     | 17            | 直流桩上传，没有填’\0’                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 25            | 车牌号                       | 8             | 可选项，没有填’\0’                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 26*           | 时段1充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [00:00:00~00:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段1                                       |
|               |                              |               |                                             |
|               |                              |               | 命令402报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令422报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 27*           | 时段2充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [00:30:00~01:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段2                                       |
|               |                              |               |                                             |
|               |                              |               | 命令402报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令422报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 28*           | 时段3充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [01:00:00~01:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段3                                       |
|               |                              |               |                                             |
|               |                              |               | 命令402报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令422报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 29*           | 时段4充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [01:30:00~02:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段4                                       |
|               |                              |               |                                             |
|               |                              |               | 命令402报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令422报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 30*           | 时段5充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [02:00:00~02:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段5                                       |
|               |                              |               |                                             |
|               |                              |               | 命令402报文此字段是2字节，单位是0.01kWh/bit |
|               |                              |               |                                             |
|               |                              |               | 命令422报文此字段是4字节，单位是            |
|               |                              |               | 0.001kWh/bit                                |
+---------------+------------------------------+---------------+---------------------------------------------+
| 31*           | 时段6充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [02:30:00~03:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段6                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 32*           | 时段7充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [03:00:00~03:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段7                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 33*           | 时段8充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [03:30:00~04:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段8                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 34*           | 时段9充电电量                | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [04:00:00~04:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段9                                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 35*           | 时段10充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [04:30:00~05:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段10                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 36*           | 时段11充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [05:00:00~05:30:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段11                                      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 37*           | 时段12充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [05:30:00~06:00:00]                         |
|               |                              |               | 分时段费率模型（1105）生效：                |
|               |                              |               | 时段12（分时段最大时段数）                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 38*           | 时段13充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [06:00:00~06:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 39*           | 时段14充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [06:30:00~07:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 40*           | 时段15充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [07:00:00~07:30:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 41*           | 时段16充电电量               | 2/4           | 48时段费率模型（1103）生效：                |
|               |                              |               | [07:30:00~08:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 42*           | ……                         | …            | 48时段费率模型（1103）生效：                |
|               |                              |               | 半小时一个时段                              |
+---------------+------------------------------+---------------+---------------------------------------------+
| 73*           | 时段48充电电量               | 2/4           | [23:30:00~00:00:00]                         |
+---------------+------------------------------+---------------+---------------------------------------------+
| 74            | 启动方式                     | 1             | 0：本地刷卡启动                             |
|               |                              |               | 1：后台启动                                 |
|               |                              |               | 2：本地管理员启动                           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 75            | 充电流水号                   | 32            |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 76            | 充电服务费                   | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 77            | 千分位电量                   | 1             | 如平台不对电量第三位小数做强检要求可忽略本  |
|               |                              |               | 字段。                                      |
|               |                              |               | 如本字段为：0x09,千分位电量为0.009Kw*h      |
+---------------+------------------------------+---------------+---------------------------------------------+
| 78            | 并充标志                     | 1             | 0/1-单枪充电                                |
|               |                              |               | 2-单机柜双枪并充充电                        |
|               |                              |               | 3-双机柜双枪并充充电                        |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_4_6 充电桩上报历史的充电记录

    注：

    充电桩为了保证记录能到送达后台，可能出现一条充电记录多次上传给后台，所以后台应具体重复报文过滤功
    能，当“充电卡号、充电启始时间、充电结束时间”三者为一样时，可判断为同一条充电记录。

    当后台查询的记录不存在时，字段17“内部索引号”填-1，表示查询失败。


    3.6  升级命令

    说明：所有升级的服务器所发指令，没有特殊说明，在没有收到桩回复时，默认以1S的频率重发报文，重发5
    次后何没有收到桩的正确回复时，升级失败。


<a id="cmd-1001"></a>
### 3.6.1  (cmd=1001)服务器下发擦除指令 [cmd=1001]

    报文功能：清除充电桩相应的软件，为升级工作做准备，见表3_6_1所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 擦除/查询指令 | 4             | 擦除:0xaa55有 |
|               |               |               | 效            |
|               |               |               | 查询:0x0000有 |
|               |               |               | 效            |
+---------------+---------------+---------------+---------------+
```

    表3_6_1 升级工作报文


    说明：此命令下发的频率每秒不超过1次


<a id="cmd-1002"></a>
### 3.6.2  (cmd=1002)充电桩回复服务器下发擦除指令 [cmd=1002]

    报文功能：清除充电桩相应的软件，为升级工作做准备，见表3_6_2所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1*            | 擦除完成百分  | 1             | 当为100%时表示擦除完成       |
|               | 比            |               |                              |
+---------------+---------------+---------------+------------------------------+
```

    表3_6_2 清除充电桩报文


<a id="cmd-1003"></a>
### 3.6.3  (cmd=1003)服务器下发升级文件名指令 [cmd=1003]

    报文功能：服务器要下发的文件名称，见表3_6_3所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1*            | 文件名        | n(n<128)      | asicc码，不需要带结束符’\0  |
|               |               |               | ’                           |
+---------------+---------------+---------------+------------------------------+
```

    表3_6_3 服务器下发升级文件名指令


    说明：服务器必须收到桩100%完成擦除标志后才能下发。


<a id="cmd-1004"></a>
### 3.6.4  (cmd=1004) 充电桩应答服务器下发升级文件名指令 [cmd=1004]

    报文功能：应答服务器指令，代表桩已准备就绪接收文件，见表3_6_4所示。

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1*            | 允许服务发送的升级数据报文数据长度          | 4             | CMD=1007的数据长度不能超过此限制,建议不超过 |
|               |                                             |               | 4096 byte                                   |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```

    表3_6_4 充电桩应答服务器下发升级文件名指令


    说明：建议以linux平台带RAM外设的监控这个长度为4096 Byte,嵌入式小型单片机建议不超过128 Byte.


<a id="cmd-1005"></a>
### 3.6.5  (cmd=1005)服务器下发升级文件大小 [cmd=1005]

    报文功能：服务器要下发的文件名称，见表3_6_4所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 文件长度      | 4             | 单位BYTE      |
+---------------+---------------+---------------+---------------+
```

    表3_6_4 服务器下发升级文件


<a id="cmd-1006"></a>
### 3.6.6  (cmd=1006)充电桩应答服务器下发升级文件大小指令 [cmd=1006]

    报文功能：应答服务器指令，代表桩已准备就绪接收文件，见表3_6_5所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 响应标志      | 4             | 0-正常        |
|               |               |               | 1-大小异常    |
+---------------+---------------+---------------+---------------+
```

    表3_6_5 充电桩应答服务器下发升级文件大小指令


    注：服务器收到响应文件大小异常时，应停止下发升级文件数据，建议在升级前，先发送1006命令，判断成功
    后再发送1001擦除命令。


<a id="cmd-1007"></a>
### 3.6.7  (cmd=1007)服务器下发升级文件数据 [cmd=1007]

    报文功能：服务器要下发的文件数据，见表3_6_6所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 升级文件数据  | n             | 单位BYTE      |
+---------------+---------------+---------------+---------------+
```

    表3_6_6  服务器下发升级文件数据


    说明：

    为保证升级数据准确性，升级文件包的数据的包头“序列号域”必须严格每发送一次不同文件数据内容时依次
    加1，服务只能收到桩应答完本次发送的文件数据后才能再发下一包。

    此报文在没有收到桩应答时，以整个应用帧要完全一样间隔100ms频率重发，超时次数为50次

    文件数据长度最大为命令1004告知的数据长度.其发送数据为二进制模式。

    只允许最后一个报文因剩余数据长度没有达到指定的数据长度N时，所发送的数据长度按实际剩余长度发数，
    其它的数据报文都必须按1004告知的数据长度发送。


<a id="cmd-1008"></a>
### 3.6.8  (cmd=1008)充电桩应答服务器下发升级文件数据指令 [cmd=1008]

    报文功能：应答服务器指令，代表桩已正确接收服务下发的升级数据，可以接收下一包了，见表3_6_7所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1*            | 正确接收到SN  | 1             | 已正确接收到的SN             |
+---------------+---------------+---------------+------------------------------+
| 2*            | 写入成功标志  | 1             | 写入成功                     |
|               |               |               | 写入失败                     |
+---------------+---------------+---------------+------------------------------+
| 3             | 预留          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 4             | 预留          | 4             |                              |
+---------------+---------------+---------------+------------------------------+
```

    表3_6_7 应答服务器指令


    说明：这个SN是指报文头部的“序列号域”。


<a id="cmd-1009"></a>
### 3.6.9  (cmd=1009)服务器下发升级文件数据结束指令 [cmd=1009]

    报文功能：服务器下发所传送的文件已结束，见表3_6_8所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```

    表3_6_8 服务器下发升级文件数据结束指令


<a id="cmd-1010"></a>
### 3.6.10 (cmd=1010)充电桩应答服务器下发升级文件数据结束指令 [cmd=1010]

    报文功能：回复平台已接收到完整的升级文件，见表3_6_9所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```

    表3_6_9充电桩应答服务器下发升级文件数据结束指令


<a id="cmd-1011"></a>
### 3.6.11 (cmd=1011)服务器下发重启指令 [cmd=1011]

    报文功能：文件下载完成，开始升级，见表3_6_10所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```

    表3_6_10  服务器下发重启指令


<a id="cmd-1012"></a>
### 3.6.12 (cmd=1012)充电桩应答服务器下发重启指令 [cmd=1012]

    报文功能：文件下载完成，开始升级，见表3_6_10所示。

```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1*            | 预留          | 4             |               |
+---------------+---------------+---------------+---------------+
```

    表3_6_10  充电桩应答服务器下发重启指令


<a id="cmd-1021"></a>
### 3.6.13 (cmd=1021)服务器回复充电桩主动请求升级命令 [cmd=1021]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1*            | 响应结果      | 4             | 响应成功                     |
|               |               |               | 设备代号有误，不允许升级     |
|               |               |               | 项目代码不存在，不允许升级   |
|               |               |               | 文件大小出错，停止升级       |
|               |               |               |                              |
|               |               |               | 说明：非0都表示失败          |
+---------------+---------------+---------------+------------------------------+
| 2*            | 响应说明      | 32            | 字符串，对响应的文字说明     |
+---------------+---------------+---------------+------------------------------+
```


<a id="cmd-1022"></a>
### 3.6.14 (cmd=1022)充电桩主动请求升级命令 [cmd=1022]

    报文功能：通知服务器给充电桩下发升级文件

```text
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                                    | 长度（字节)   | 说明                                        |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 1*            | 设备代号                                    | 4             | 1-V6-SEV-AC-M1-STM32F207 交流桩             |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 2*            | 项目代码                                    | 4             | 每个项目都一个代码，平台升级软件映射表与桩  |
|               |                                             |               | 实际编码对应。如                            |
|               |                                             |               | 101-101项目协议标准后台 协议项目            |
|               |                                             |               | 102-云快充后台协议项目                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 3*            | 当前软件版本                                | 4             | 类型为小端整形（INT），如：                 |
|               |                                             |               | 0x09 0x52 00 00表示：0x5209,则版本号为：    |
|               |                                             |               | 210.01                                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 4*            | 最大可接收文件大小                          | 4             | 单位K                                       |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 5*            | 设备描述                                    | 32            | 字符串类型“如V6交流桩”                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 6             | 命令标志                                    | 4             | 0x6e657874 -表示断点续传                    |
|               |                                             |               | 未定义的，都表示从重开始                    |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 7             | 断点续传文件启始偏移位置                    | 4             | 文件启始偏移位置                            |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 8             | 断点续传SN                                  | 1             | 只有断点续传下有效，在接下来的CMD=1007包头  |
|               |                                             |               | 部的sn                                      |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
| 9             | 允许服务发送的升级数据报文数据长度          | 4             | 断电续传CMD=1007的数据长度不能超过此限制,建 |
|               |                                             |               | 议不超过1024byte，默认512                   |
|               |                                             |               |                                             |
|               |                                             |               | M默认or                                     |
+---------------+---------------------------------------------+---------------+---------------------------------------------+
```

    表3_6_10  充电桩应答服务器下发重启指令


    说明：1.桩上传的命令标志为0x6e657874-断点续传时，服务器下一帧直接发送1007命令，而不用重新从1001
    开始。



    3.7  与计费策略相关的指令

    3.7.1  （CMD=1101）后台服务器查询24时电费计价策略信息

    报文功能：后台查询24时段电费计价策略信息，报文体为空。


    3.7.2  （CMD=1102）充电桩应答后台服务器查询24时电费计价策略信息

    报文功能：后台查询24时段电费计价策略信息（用BIN码表示），见表3_7_1所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1*            | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2*            | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 费率1         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 6*            | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 7*            | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 8*            | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 9*            | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 10*           | 费率2         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 11*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 12*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 13*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 14*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 15*           | 费率3         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 16*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 17*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 18*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 19*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 20*           | 费率4         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 21*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 22*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 23*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 24*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 25*           | 费率5         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 26*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 27*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 28*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 29*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 30*           | 费率6         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 31*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 32*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 33*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 34*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 35*           | 费率7         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 36*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 37*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 38*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 39*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 40*           | 费率8         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 41*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 42*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 43*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 44*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 45*           | 费率9         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 46*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 47*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 48*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 49*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 50*           | 费率10        | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 51*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 52*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 53*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 54*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 55*           | 费率11        | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 56*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 57*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 58*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 59*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 60*           | 费率12        | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_7_1 充电桩应答后台服务器查询24时电费计价策略信息

    说明：

    本命令定义最大12个时间时段，时间必须符合24时计算，以30分钟为步长，共48个时间段；设置时间段范围为
    从00:00~24:00，时间时段总和必须为48个时段，没设置的需补零。


    3.7.3  （CMD=1103）后台服务器设置24时段电费计价策略信息

    报文功能：后台服务器设置24时段电费计价策略信息（用BIN码表示），若平台存在跨时段服务费，请使用
    CMD1105见表3_7_2所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1*            | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 2*            | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 费率1         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 6*            | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 7*            | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 8*            | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 9*            | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 10*           | 费率2         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 11*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 12*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 13*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 14*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 15*           | 费率3         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 16*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 17*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 18*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 19*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 20*           | 费率4         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 21*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 22*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 23*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 24*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 25*           | 费率5         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 26*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 27*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 28*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 29*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 30*           | 费率6         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 31*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 32*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 33*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 34*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 35*           | 费率7         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 36*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 37*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 38*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 39*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 40*           | 费率8         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 41*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 42*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 43*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 44*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 45*           | 费率9         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 46*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 47*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 48*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 49*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 50*           | 费率10        | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 51*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 52*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 53*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 54*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 55*           | 费率11        | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
| 56*           | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 57*           | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 58*           | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 59*           | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| 60*           | 费率12        | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_7_2 台服务器设置24时电费计价策略信息

    说明：

    为保证桩的费率实时与后台同步，在管理员更改充电费率、桩上报106报文签到时和后台启动充电前下发报文
    进行费率同步。

    费率默认是2位小数点，即下发的数据放大了100倍，要乘0.01才能得到真实的值。一般2费率保留2位小数即可
    满足充电桩的应用需求，建议客户使用2位小数点的费率。以下是费率下发数据与真实费率对应表3_7_3。


```text
+---------------+------------------------------+
| 下发费率数据  | 实际费率（元/度）            |
| 值            |                              |
+---------------+------------------------------+
| 68            | 0.68元/度                    |
+---------------+------------------------------+
| 123           | 1.23元/度                    |
+---------------+------------------------------+
| 1234          | 12.34元/度                   |
+---------------+------------------------------+
```

    表3_7_3 充电桩费率表


    本命令定义最大12个时间时段，时间必须符合24时计算，以30分钟为步长，共48个时间段；设置时间段范围为
    从00:00~24:00，时间时段总和必须为48个时段，没设置的时间时段需补零。

    示例：如设置3个时间时段，则下发数据填充如下：

```text
+---------------+---------------+---------------+---------------+---------------+
| 开始小时      | 开始分钟      | 结束小时      | 结束分钟      | 费率(元/度)   |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 10            | 30            | 1.20          |
+---------------+---------------+---------------+---------------+---------------+
| 10            | 30            | 20            | 00            | 1.00          |
+---------------+---------------+---------------+---------------+---------------+
| 20            | 00            | 24            | 00            | 0.46          |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
| 00            | 00            | 00            | 00            | 0             |
+---------------+---------------+---------------+---------------+---------------+
```

    注：

    1. 协议定义要按照此格式顺序填充12个时间时段，缺时段、始终时间相等或大小错误，充电桩都认为下发数
    据错误，应答失败。

    充电桩依次搜索查找排序时间时段，当满足48个时段，便停止搜索下一个时间时段；后台监控下发前也要对48
    个时段进行效验。

    本费率生效后，cmd202报文的时段电量与为48个时段，意味着48时段电量生效。


    3.7.4  （CMD=1104）充电桩应答后台服务器设置24时电费计价策略信息

    报文功能：回复平台是否设置成功，见表表3_7_4所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1*            | 确认结果      | 1             | 0--成功  1--失败             |
+---------------+---------------+---------------+------------------------------+
```

    表3_7_4 充电桩应答后台服务器设置24时电费计价策略信息

    3.7.5  （CMD=1105）后台服务器设置分时段计价策略信息

    报文功能：后台服务器设置分时段电费计价策略信息，见表3_7_5所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率1     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率1     |               | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率2     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率2     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
| …            | …            | .             | ……                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率n-1   | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率n-1   | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率12    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率12    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.0001才能得到真实的值（BIN）               |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_7_5 台服务器设置分时电费计价策略信息

    3.7.6  （CMD=1106）充电桩应答后台服务器设置分时段计价策略信息

    报文功能：回复平台是否设置成功，见表表3_7_6所示。

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1*            | 确认结果      | 1             | 0--成功  1--失败             |
+---------------+---------------+---------------+------------------------------+
```

    表3_7_6 充电桩应答后台服务器设置24时电费计价策略信息

    3.7.7  （CMD=1107）后台服务器查询分时电费计价策略信息

    报文功能：后台查询24时段电费计价策略信息，报文体为空。

    3.7.8  （CMD=1108）充电桩回复分时电费计价策略信息

    报文功能：后台服务器设置24时段电费计价策略信息（用BIN码表示），见表3_7_7所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率1     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率1     |               | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率2     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率2     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率3     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率3     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 费率4         | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率4     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率5     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率5     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率6     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率6     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率7     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率7     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率8     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率8     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率9     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率9     | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率10    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率10    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率11    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率11    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 开始分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束小时      | 1             | 0~24                                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 结束分钟      | 1             | 0或30                                       |
+---------------+---------------+---------------+---------------------------------------------+
|               | 充电费率12    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
|               | 服务费率12    | 4             | 该时段内每度电的电费，用整型值表示，要乘    |
|               |               |               | 0.01才能得到真实的值                        |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_7_7 台服务器设置分时电费计价策略信息



    3.9  白名单报文

<a id="cmd-1301"></a>
### 3.9.1  (cmd=1301)服务器下发白名单操作日志数据包 [cmd=1301]

    报文功能：后台逐条下发白名单信息报文，见表3_9_1所示。

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码                   | 32            | ASCII编码                                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 白名单类型                   | 1             | 1-充电卡号                                  |
|               |                              |               | 2-VIN码                                     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5*            | 操作                         | 1             | 0:增加；                                    |
|               |                              |               | 2:清空；                                    |
|               |                              |               | 4:查询白名单版本号(7.8字段不需要)           |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6*            | 白名单版本号                 | 4             | 当前下发的名单版本号。服务器向充电系统发送  |
|               |                              |               | 的版本号为0时则充电系统将清空白名单。       |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7*            | 下发的白名单条数             | 4             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8*            | 车辆VIN/充电卡号             | 17/32         | 卡号不足32位的，在尾部填’\0’              |
|               |                              |               | 字段4类型为充电卡时，此字段为32字节，类型为 |
|               |                              |               | VIN时，此字段为32字节                       |
+---------------+------------------------------+---------------+---------------------------------------------+
| ….           | ………..                     | ..            | ……                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 17*           | 车辆VIN/充电卡号             | 17/32         | 卡号不足32位的，在尾部填’\0’              |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    表3_9_1 服务器下发白名单操作日志数据包

    后台发送白名单依次发送，每次发送10条，充电桩接收到后，回复应答指令。应答操作结果为成功时，后台才
    可以下发下10条白名单。

    白名单下发流程是：先查询桩上白名单版本号，若一致，就不需要下发，若不一致，则先使用清空操作，把历
    史名单清完，然后再下发新的白名单。

    白名单数量不能超过100个。


<a id="cmd-1302"></a>
### 3.9.2  (cmd=1302) 充电桩应答白名单操作日志数据包 [cmd=1302]

    报文功能：回复白名单更新结果，见表3_9_2所示。

```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节）  | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             | 预留                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                                   |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 白名单类型    | 1             | 1-充电卡号                                  |
|               |               |               | 2-VIN码                                     |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 操作          | 1             | 0：增加；2：清空；4:查询白名单版本号        |
+---------------+---------------+---------------+---------------------------------------------+
| 6*            | 名单版本      | 4             | 当前充电系统最新的名单版本号。为0时则充电系 |
|               |               |               | 统将清空白名单。                            |
+---------------+---------------+---------------+---------------------------------------------+
| 7*            | 操作结果      | 1             | 0：更新成功；其他：更新失败                 |
+---------------+---------------+---------------+---------------------------------------------+
```

    表3_9_2 充电桩应答白名单操作日志数据包

    3.10  FTP远程升级和FTP方式日志上传

<a id="cmd-1401"></a>
### 3.10.1  (cmd=1401)服务器下发FTP远程升级命令 [cmd=1401]

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 升级软件文件版本号           | 2             | HEX整形，例如：209.02表示为：A6 51          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | FTP服务器IP地址              | 32            | 例：IP：16.80.1.20                          |
|               |                              |               | 指令为：0x10 0x50 0x01 0x14                 |
|               |                              |               | 该字段为空时，使用本地默认FTP地址。建议默认 |
|               |                              |               | 使用IP方式                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 5             | FTP 用户名                   | 16            | 字符串，不足补0x00                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | FTP 密码                     | 16            | 字符串，不足补0x00                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | FTP 下载路径                 | 64            | 字符串，不足补0x00，示例:                   |
|               |                              |               | ftp://172.16.4.254/SINEXCEL /dcharg.bin情况 |
|               |                              |               | 下：                                        |
|               |                              |               | 此字段填充                                  |
|               |                              |               | ”/SINEXCEL /dcharg.bin”                   |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | 执行方式                     | 1             | 1.空闲执行                                  |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9*            | 本次升级设备类型             | 1             | 0/1:交直流主监控板（TCU/S7/S1/交流桩）      |
|               |                              |               | 2:CCU -充电控制器                           |
|               |                              |               | 3:DCDC模块                                  |
|               |                              |               | 4:ACDC模块                                  |
|               |                              |               | 5: 群充控制器                               |
|               |                              |               | 6:分体机主机控制器                          |
|               |                              |               | 7.V6-STM32-AC V6交流桩                      |
|               |                              |               | 8.V6-GD-AC V6交流桩                         |
|               |                              |               |                                             |
|               |                              |               | 若没有下发此字段，默认就是升级充电机        |
|               |                              |               | TCU/S1/S7主控制器                           |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    说明：服务器通过1401命令通知设备进行升级的，并且采用3.6节中定义的协议格式下发升级文件，这个方式
    1401报文中的第4字段“FTP服务器IP地址或者域名”必须是IP格式而不能使用域名，而且升级服务器使用的端
    口，都是双方固定好的（不是21端口）。


<a id="cmd-1402"></a>
### 3.10.2  (cmd=1402)充电桩应答服务器下发FTP远程升级命令 [cmd=1402]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3             | 结果          | 1             | 1:收到开始连接               |
|               |               |               | 2:版本号一致,不执行下载      |
|               |               |               | 3:充电中,空闲执行下载        |
|               |               |               | 4.:其他原因，执行失败        |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-1403"></a>
### 3.10.3  (cmd=1403)充电桩应答FTP升级包下载进度 [cmd=1403]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3             | 进度结果      | 1             | 1:ftp 地址连接失败           |
|               |               |               | 2:ftp 服务登录失败           |
|               |               |               | 3:目录无权限                 |
|               |               |               | 4:下载失败                   |
|               |               |               | 5:下载50%                    |
|               |               |               | 6:下载完成，进入升级模式     |
+---------------+---------------+---------------+------------------------------+
```

<a id="cmd-1406"></a>
### 3.10.3  (cmd=1406)服务器下发获取充电桩日志信息命令 [cmd=1406]

```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             | 预留                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3             | 获取日志类型                 | 1             | 1.bms日志2.系统日志3.记录日志4.全部日志     |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4             | FTP服务器IP地址              | 32            | 字符串，不足补0x00                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 6             | FTP 用户名                   | 16            | 字符串，不足补0x00                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 7             | FTP 密码                     | 16            | 字符串，不足补0x00                          |
+---------------+------------------------------+---------------+---------------------------------------------+
| 8             | FTP 存放日志路径             | 32            | 暂时不填                                    |
+---------------+------------------------------+---------------+---------------------------------------------+
| 9             | 执行方式                     | 1             | 1.空闲执行 2.立即执行                       |
+---------------+------------------------------+---------------+---------------------------------------------+
```

    说明：仅支持采用3.11节中定义的协议格式上传文件，这个报文中的第4字段“FTP服务器IP地址或者域名”必
    须是IP格式而不能使用域名，而且升级服务器使用的端口，都是双方固定好的（不是21端口）。


<a id="cmd-1407"></a>
### 3.10.4  (cmd=1407)充电桩应答服务器下发获取充电桩日志命令 [cmd=1407]

```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3             | 结果          | 1             | 0:成功                       |
|               |               |               | 1:ftp 地址连接失败           |
|               |               |               | 2:ftp 服务登录失败           |
|               |               |               | 3:目录无权限                 |
|               |               |               | 4:其他错误                   |
+---------------+---------------+---------------+------------------------------+
```



    3.11  协议方式日志上传

<a id="cmd-1501"></a>
### 3.11.1  (cmd=1501)申请上传文件 [cmd=1501]
```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             | 预留                         |
+---------------+---------------+---------------+------------------------------+
| 3*            | 充电桩编码    | 32            | ASCII编码                    |
+---------------+---------------+---------------+------------------------------+
| 4*            | 申请上传文件  | 128           | 字符串格式，以’\0’结尾     |
|               | 名            |               |                              |
+---------------+---------------+---------------+------------------------------+
|               |               |               |                              |
+---------------+---------------+---------------+------------------------------+
```

    说明：日志保存文件名建议服务器先建立一个按桩号命名的目录，然后使用“字段4前缀+时间+字段4后缀”，
    如字段4上传的是charger.xls文件名，则保存成 112233445566/charger202106151625.xls文件，其中“
    112233445566/”是按桩号生成的目录路径。


<a id="cmd-1502"></a>
### 3.11.2  (cmd=1502)服务器允许上传 [cmd=1502]
```text
+---------------+---------------+---------------+------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                         |
+---------------+---------------+---------------+------------------------------+
| 1             | 预留          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 2             | 预留          | 2             |                              |
+---------------+---------------+---------------+------------------------------+
| 3*            | 应答码        | 4             | 允许发送                     |
|               |               |               | 其他-不支持日志上传          |
+---------------+---------------+---------------+------------------------------+
```


<a id="cmd-1503"></a>
### 3.11.3  (cmd=1503)上传日志数据 [cmd=1503]
```text
+---------------+---------------+---------------+---------------------------------------------+
| 序号          | 字段定义      | 长度（字节)   | 说明                                        |
+---------------+---------------+---------------+---------------------------------------------+
| 1             | 预留          | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 2             | 预留          | 2             |                                             |
+---------------+---------------+---------------+---------------------------------------------+
| 3*            | 本次数据长度  | 4             | 字段5数据长                                 |
+---------------+---------------+---------------+---------------------------------------------+
| 4*            | 本次报文编号  | 4             | 新文件数据上传的第一包的数据从1开始累加，服 |
|               |               |               | 务器收到重复的编号要丢弃掉                  |
+---------------+---------------+---------------+---------------------------------------------+
| 5*            | 日志数据      | n             | 建议一次数据包上传不大于1024字节            |
+---------------+---------------+---------------+---------------------------------------------+
```


    说明：

    发送完此报文，在500ms内没有收到服务器回复1504报文，则重发，并连接发送30次都没有收到服务器的1504
    报文，则中止此次的日志上传。根据业务逻辑来重新走发送1501报文流程。

    2.服务器在接收日志文件中途，因种种原因出错或断开连接，也要把已接收到的日志数据保存到文件当中。


<a id="cmd-1504"></a>
### 3.11.4  (cmd=1504)服务器应答上传日志 [cmd=1504]
```text
+---------------+------------------------------+---------------+---------------------------------------------+
| 序号          | 字段定义                     | 长度（字节)   | 说明                                        |
+---------------+------------------------------+---------------+---------------------------------------------+
| 1             | 预留                         | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 2             | 预留                         | 2             |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 3*            | 标识                         | 4             | 正常接收                                    |
|               |                              |               | 接收出错，中断此次日志上传                  |
|               |                              |               |                                             |
+---------------+------------------------------+---------------+---------------------------------------------+
| 4*            | 已成功接收到的报文编号       | 4             | 这个要与最后一次收到的1503报文中的字段4一样 |
|               |                              |               | 。                                          |
+---------------+------------------------------+---------------+---------------------------------------------+
```


<a id="cmd-1505"></a>
### 3.11.5  (cmd=1505)当前文件日志数据上传完成 [cmd=1505]
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             |               |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             |               |
+---------------+---------------+---------------+---------------+
```


    说明：这个命令仅仅只是通知服务器，当前的日志文件已上传完成，让服务器保存并关闭刚接收到的文件描述
    符。整个SOCKET连接不能接收到文件结束后就直接关闭，而应由桩这边在整体日志都传完再来关闭。因为桩上
    一次可以传多个日志到服务器，如一个文件上传结束了，可继续发送CMD1501命令来申请上传其他日志文件。



<a id="cmd-1506"></a>
### 3.11.6  (cmd=1506)当前文件接收完成 [cmd=1506]
```text
+---------------+---------------+---------------+---------------+
| 序号          | 字段定义      | 长度（字节)   | 说明          |
+---------------+---------------+---------------+---------------+
| 1             | 预留          | 2             |               |
+---------------+---------------+---------------+---------------+
| 2             | 预留          | 2             |               |
+---------------+---------------+---------------+---------------+
```

    说明：桩收到1506回复后，若还有文件要上传的，则继续发送1501报文，若没有则收到服务器回应此报文后，
    即可关闭SOCKET连接，然后桩再连接到正式运营服务器上。





    附录1  告警编码定义（CMD=104最高告警码字段）

```text
+---------------+------------------------------+---------------------------------------------+
| 告警编码      | 告警含义                     | 说明                                        |
+---------------+------------------------------+---------------------------------------------+
| 0             | 无告警                       |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1             | 绝缘检测异常                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2             | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 3             | 紧急停机                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 4             | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 5             | 直流输出过压                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 6             | 直流输出欠压                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 7             | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 8             | 直流输出断路                 | U1板采样模块输出端电压异常,需要检测系统接线 |
|               |                              | 或校准                                      |
+---------------+------------------------------+---------------------------------------------+
| 9             | 环境温度过高                 | 群充模块过温                                |
+---------------+------------------------------+---------------------------------------------+
| 10            | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 11            | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 12            | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 13            | 直流输出反接                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 14            | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 15            | 预留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 16            | 模块类型不一致               | 我司有750V、500V和恒功率等模块类型          |
+---------------+------------------------------+---------------------------------------------+
| 17            | 熔断器故障                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 18            | 直流接触器异常               | 交流接触器异常/直流接触器异常               |
+---------------+------------------------------+---------------------------------------------+
| 19            | 模块故障                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 20            | 模块CAN通信异常              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 21            | 保留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 22            | 交流输入电压过压             |                                             |
+---------------+------------------------------+---------------------------------------------+
| 23            | 交流输入电压欠压             |                                             |
+---------------+------------------------------+---------------------------------------------+
| 24            | 交流输入频率过频             |                                             |
+---------------+------------------------------+---------------------------------------------+
| 25            | 交流输入频率欠频             |                                             |
+---------------+------------------------------+---------------------------------------------+
| 26            | 保留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 27            | 防雷器故障                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 28            | 保留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 29            | 交流AC输入A相缺相            |                                             |
+---------------+------------------------------+---------------------------------------------+
| 30            | 交流AC输入B相缺相            |                                             |
+---------------+------------------------------+---------------------------------------------+
| 31            | 交流AC输入C相缺相            |                                             |
+---------------+------------------------------+---------------------------------------------+
| 32            | 直流输出短路                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 33            | 充电枪锁故障                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 34            | 低压辅源异常                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 35            | 充电枪温度过高               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 36            | 采集器代码错误               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 40            | 保留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1000          | 控制板通讯故障               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1001          | 采集板通讯故障               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1002          | 电表通讯异常                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1003          | 与集中器通信中断             | 特定项目才有                                |
+---------------+------------------------------+---------------------------------------------+
| 1004          | 后台通信中断                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1005          | 保留                         |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1006          | 读卡器故障                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 1007          | 电表电量为0                  |                                             |
+---------------+------------------------------+---------------------------------------------+
|               |                              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2001          | 紧急停机故障                 | 与编码3一样处理                             |
+---------------+------------------------------+---------------------------------------------+
| 2002          | 绝缘故障                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2003          | 直流过压                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2004          | 直流欠压                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2005          | 软启失败                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2006          | 输出反接故障                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2007          | 接触器异常                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2008          | 模块故障                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2009          | 电网电压高                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2010          | 电网电压低                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2011          | 电网频率高                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2012          | 电网频率低                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2013          | 模块通信异常                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2014          | 模块类型不一致               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2015          | 充电机系统掉电               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2016          | 直流输出断路                 | 接触器没正常闭合 或熔断丝损坏               |
+---------------+------------------------------+---------------------------------------------+
| 2017          | 进风口过温保护               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2018          | 进风口低温保护               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2019          | 出风口过温保护               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2020          | 群充模块过温                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2021          | 防雷故障                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2022          | 交流接触器异常               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2023          | 充电枪头过温                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2024          | 直流输出过流                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2025          | 充电枪锁异常                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2026          | 快充段,此枪无效              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2027          | 快充段，此枪无效             | 门禁保护                                    |
+---------------+------------------------------+---------------------------------------------+
| 2028          | 门禁保护                     | CAN3通信错误（扩展板）                      |
+---------------+------------------------------+---------------------------------------------+
| 2029          | CAN3通信错误（扩展板）       | 群充模块通信超时                            |
+---------------+------------------------------+---------------------------------------------+
| 2030          | 运行剩余天数无效             |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2031          | 控制导引故障                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2038          | 电网电压高，告警不停机       |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2039          | 电网电压低，告警不停机       |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2040          | 绝缘异常                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2041          | 输出短路                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2042          | 模块过温                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2043          | 模块异常                     |                                             |
+---------------+------------------------------+---------------------------------------------+
|               |                              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100000以上告警为交流桩告警                                                                 |
+---------------+------------------------------+---------------------------------------------+
| 100001        | 迪文通信告警                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100002        | 读卡器通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100003        | 防雷器故障                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100004        | 主开关及熔断器故障           |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100005        | 紧急停机故障                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100032        | 电表1通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100033        | 电表2通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100034        | 电表3通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100035        | 电表4通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100036        | 电表5通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100037        | 电表6通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100038        | 电表7通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100039        | 电表8通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100040        | 电表9通信告警                |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100041        | 电表10通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100042        | 电表11通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100043        | 电表12通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100044        | 电表13通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100045        | 电表14通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100046        | 电表15通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100047        | 电表16通信告警               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100065        | 过压告警                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100066        | 充电欠压告警                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100067        | 过流告警                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100068        | 继电器故障                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100076        | 过温告警                     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100077        | 输入欠压告警                 |                                             |
+---------------+------------------------------+---------------------------------------------+
```


    说明：

    1.因为交流桩与直流桩很多告警不一样，为了方便各自的编码管理，把两个系统的告警独立编号

    2.上表中，有些同一名称的告警，但有两个不同的编码，也是为了方便充电桩的软件处理，服务器按照这个完
    整列表做个告警映射表即可。



    附录2  停止原因编码定义

```text
+---------------+---------------------------------------------+---------------------------------------------+
| 编码          | 含义                                        | 说明                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 0             | 正常结束                                    | BMS主动停机                                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 1             | 接收BMS的辨识报文超时                       | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 2             | 接收电池充电参数报文超时                    | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 3             | 接收BMS完成充电准备报文超时                 | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 4             | 接收电池充总状态报文超时                    | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 5             | 接收电池充电需求报文超时                    | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 6             | 接收BMS中止充电报文超时                     | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 7             | 接收BMS充电统计报文超时                     | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 20            | 收到bem报文停止                             | BMS报文错误，充电机主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 21            | 收到bst报文停止                             | BMS发送BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 22            | 收到BSM报文错误停止                         | BMS发送BSM状态有误，充电机主动停止          |
+---------------+---------------------------------------------+---------------------------------------------+
| 23            | BMS温度过高异常                             | BMS报文的当前温度比BMS发送的最高允许温度高  |
|               |                                             | 或超过人工设定值（目前默认是100度）,充电机  |
|               |                                             | 主动停止                                    |
+---------------+---------------------------------------------+---------------------------------------------+
| 24            | 单体电压过高异常                            | BMS报文的当前温度比BMS发送的最高允许单体电  |
|               |                                             | 压高或超过人工设定值（目前默认是6V）,充电机 |
|               |                                             | 主动停止                                    |
+---------------+---------------------------------------------+---------------------------------------------+
| 25            | 需求电流异常                                | 需求电流是负数，充电机主动停止              |
+---------------+---------------------------------------------+---------------------------------------------+
| 30            | BST的SOC目标值                              | BMS发出BST报文，BMS主动停止,正常充满停止    |
+---------------+---------------------------------------------+---------------------------------------------+
| 31            | BST的电压设定值                             | BMS发出BST报文，BMS主动停止,正常充满停止    |
+---------------+---------------------------------------------+---------------------------------------------+
| 32            | BST单体电压满                               | BMS发出BST报文，BMS主动停止,正常充满停止    |
+---------------+---------------------------------------------+---------------------------------------------+
| 33            | BST_00_6                                    | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 34            | BST绝缘故障                                 | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 35            | BST连接器过温                               | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 36            | BST元件过温                                 | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 37            | BST连接器故障                               | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 38            | BST电池组过温                               | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 39            | BST其他故障                                 | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 40            | BST_02_4                                    | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 41            | BST_02_6                                    | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 42            | BST电流过大                                 | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 43            | BST电压异常                                 | BMS发出BST报文，BMS主动停止                 |
+---------------+---------------------------------------------+---------------------------------------------+
| 200           | 用户中止                                    | 用户操作停止，充电机主动停止                |
+---------------+---------------------------------------------+---------------------------------------------+
| 201           | 系统告警1                                   | 控制板上报告警，充电机主动停止              |
+---------------+---------------------------------------------+---------------------------------------------+
| 202           | 系统告警2                                   | 控制板上报告警，充电机主动停止              |
+---------------+---------------------------------------------+---------------------------------------------+
| 300           | CC1连接断开                                 | CC1断开，充电机主动停止                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 301           | 用户刷卡停止                                | 用户刷卡停止，充电机主动停止                |
+---------------+---------------------------------------------+---------------------------------------------+
| 302           | 紧急停机                                    | 用户操作紧急按钮，充电机主动停止            |
+---------------+---------------------------------------------+---------------------------------------------+
| 303           | 预处理加电失败                              | 充电卡锁定失败，充电机主动停止              |
+---------------+---------------------------------------------+---------------------------------------------+
| 304           | 绝缘检测异常                                | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 305           | 控制板通讯异常                              | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 306           | 充电电量达到设定值                          | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 307           | 充电时间达到设定值                          | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 308           | 充电金额达到设定值                          | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 309           | 电表通讯异常                                | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 310           | 充电金额超过用户卡余额                      | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 311           | 后台终止                                    | 收到后台关机指令，充电机主动停止            |
+---------------+---------------------------------------------+---------------------------------------------+
| 312           | 系统告警中止                                | 控制板上报系统故障，充电机主动停止          |
+---------------+---------------------------------------------+---------------------------------------------+
| 313           | 后台通讯中止                                | 集中器通讯断开，充电机主动停止              |
+---------------+---------------------------------------------+---------------------------------------------+
| 314           | 充电电压异常中止                            | 控制板上传充电电压比需求电压大，充电机主动  |
|               |                                             | 停止                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 315           | 充电电流异常中止                            | 控制板上传充电电流比需求电流大，充电机主动  |
|               |                                             | 停止                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 316           | BMS的SOC满中止                              | 系统SOC达到设定值（默认100%），充电机主动停 |
|               |                                             | 止                                          |
+---------------+---------------------------------------------+---------------------------------------------+
| 317           | 电表电量异常增大中止                        | 电表电量突然持续异常跳变到较大的值，监控板  |
|               |                                             | 和控制板都要判断                            |
+---------------+---------------------------------------------+---------------------------------------------+
| 318           | 电表电量异常变小中止                        | 电表电量突然持续异常跳变到较小的值，监控板  |
|               |                                             | 和控制板都要判断                            |
+---------------+---------------------------------------------+---------------------------------------------+
| 319           | VIN码不匹配                                 | 车辆VIN码与设定的不匹配                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 320           | 后台回复VIN码验证超时                       |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 321           | 不支持VIN码方式充电                         |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 401           | 管理员界面中止                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 402           | 软件升级                                    | 系统软件进行升级，中止充电                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 403           | 充电启动超时                                | 启动充电时间60秒内没进入充电阶段            |
+---------------+---------------------------------------------+---------------------------------------------+
| 404           | BMS 单体动力蓄电池电压异常                  | 车发送的BSM报文状态异常                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 405           | BMS 整车动力蓄电池荷电状态                  | 系统突然断电，充电机主动停止                |
+---------------+---------------------------------------------+---------------------------------------------+
| 406           | BMS 动力蓄电池充电过电流                    | 车发送的BSM报文状态异常                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 407           | BMS 动力蓄电池温度过高                      | 车发送的BSM报文状态异常                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 408           | BMS 动力蓄电池绝缘状态                      | 车发送的BSM报文状态异常                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 409           | BMS 蓄电池组输出连接器状态                  | 车发送的BSM报文状态异常                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 410           | 充电电压超过BMS最大允许值                   |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 411           | BMS其他位状态异常                           | 车发送的BSM报文状态异常                     |
+---------------+---------------------------------------------+---------------------------------------------+
| 412           | BCS上传电压异常                             | BCS报文上传电压或充电电压不匹配异常         |
+---------------+---------------------------------------------+---------------------------------------------+
| 413           | 断网停止充电                                | 网络断开后，充电电量达到设定值              |
+---------------+---------------------------------------------+---------------------------------------------+
| 414           | BSM报文超时                                 | 充电中接收电池BSM报文超时                   |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2000          | 系统其他故障                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2001          | 紧急停机故障                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2002          | 绝缘故障                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2003          | 直流过压                                    | 电池电压超过设置的过压保护值                |
+---------------+---------------------------------------------+---------------------------------------------+
| 2004          | 直流欠压                                    | 充电电压低于充电机最低输出电压              |
+---------------+---------------------------------------------+---------------------------------------------+
| 2005          | 软启失败                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2006          | 输出反接故障                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2007          | 接触器异常                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2008          | 模块故障                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2009          | 电网电压高                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2010          | 电网电压低                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2011          | 电网频率高                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2012          | 电网频率低                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2013          | 模块通信异常                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2013          | 模块类型不一致                              | 系统设置的模块类型与实际模块类型不一致（    |
|               |                                             | 500V/750V等）                               |
+---------------+---------------------------------------------+---------------------------------------------+
| 2015          | 系统辅源掉电                                | 系统交流侧突然断电                          |
+---------------+---------------------------------------------+---------------------------------------------+
| 2016          | 直流输出断路                                | 接触器没正常闭合 或熔断丝损坏               |
+---------------+---------------------------------------------+---------------------------------------------+
| 2017          | 进风口过温保护                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2018          | 进风口低温保护                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2019          | 出风口过温保护                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2020          | 群充模块过温                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2021          | 防雷故障                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2022          | 交流接触器异常                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2023          | 充电枪头过温                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2024          | 直流输出过流                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2025          | 充电枪锁异常                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2026          | 快充段,此枪无效                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2027          | 门禁保护                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2028          | CAN3通信错误（扩展板）                      |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2029          | 群充模块通信超时                            |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2030          | 运行剩余天数无效                            |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2031          | 控制导引故障                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2038          | 电网电压高，告警不停机                      |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2039          | 电网电压低，告警不停机                      |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2040          | 绝缘异常                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2041          | 输出短路                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2042          | 模块过温                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 2043          | 模块异常                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3000          | 输入断路器故障                              | 查看断路器是否跳闸或损坏，若是，更换        |
|               |                                             | 万用表查看断路器反馈线电阻                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 3001          | 输出熔断器故障                              | 用万用表查看熔断器是否损坏，或反馈线电阻是  |
|               |                                             | 否正常                                      |
+---------------+---------------------------------------------+---------------------------------------------+
| 3002          | 系统风扇故障                                | 暂无，预留                                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 3003          | BMS通信故障                                 | Bms重连3次超时                              |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3005          | 中间接触器故障                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3013          | H2协议版本不一致                            | 同一个系统中，不同地址的控制器版本不一致    |
+---------------+---------------------------------------------+---------------------------------------------+
| 3014          | H2心跳超时                                  | 同一个系统中，非1号控制板未接收到1号板报文  |
|               |                                             | 查看板子之间通信CAN线                       |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3100          | 绝缘检测阶段，枪口带压                      |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3101          | 绝缘超时，模块未开机                        |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3102          | 绝缘超时，模块开机                          |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3103          | BMS绝缘电压低                               |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3104          | BCP电池电压异常                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3105          | BMS单体电压过高                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3106          | BMS温度过高                                 | 检测到车辆当前电池温度（BSM）超过其允许的最 |
|               |                                             | 高温度（BCP）                               |
|               |                                             | 车厂                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 3107          | BMS状态异常                                 | 暂无，预留                                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 3108          | BCS上传电压异常                             | 暂无，预留                                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 3109          | BMS单体动力蓄电池电压过低                   |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3110          | BMS整车动力蓄电池SOC过低                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3111          | 车辆内部回路异常终止                        | 10min电流小于1A                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3112          | 车辆需求电压大于允许                        | BCL需求电压大于BCP最大允许电压              |
|               |                                             | 车厂                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 3113          | 车辆需求电流大于允许                        | BCL需求电流大于BCP最大允许电流              |
|               |                                             | 车厂                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 3114          | 电能更新异常                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3115          | 电表采集异常                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3116          | 控制器复位                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3117          | 电表电量跳变                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3118          | 日志超限                                    | CCU单日保存LOG日志过多（代码问题）          |
+---------------+---------------------------------------------+---------------------------------------------+
| 3119          | 烟感故障                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3120          | 水浸故障                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3121          | 桩体倾斜                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3122          | 直流接触器DC+拒动故障                       |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3123          | 直流接触器DC+粘连故障                       |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3124          | 直流接触器DC-拒动故障                       |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3125          | 直流接触器DC-粘连故障                       |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3126          | 辅源故障（BMS）                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3127          | M2复位                                      |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3128          | M1复位                                      |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3129          | M2与M1通信超时                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3130          | M1芯片通信故障（M1的CPU之间通信异常）       |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3131          | CCU与M2通信故障                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3132          | 主机电表通信故障（M2与电表）                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3133          | 主枪下发停机                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3134          | 主枪开机状态异常                            |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3135          | 车辆温度超过设置值                          |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3136          | 充电桩与需求电压超限                        |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3137          | 充电桩与需求电流超限                        |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3138          | 充电车辆最高单体电压不变                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3139          | 充电车辆最高电池温度不变                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3140          | 需求小电流充电时间达到设定值                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3141          | 车辆达到需求电压时间设定值                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3142          | 充电桩与电表电压误差超限                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3143          | 充电桩与电表电流误差超限                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3144          | 进线端电压异常                              | 终端开机时检测到模块给过来的电压异常        |
+---------------+---------------------------------------------+---------------------------------------------+
| 3145          | BMT车辆电池温度超过允许值（桩停止保护）     |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3146          | 单体电池最高与最低偏差大                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 3200          | 接收BSM报文超时                             | 车厂                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 3202          | BSM允许充电异常                             | 车辆要求暂停充电（BSM）10分钟内未再次启动充 |
|               |                                             | 电                                          |
|               |                                             | 报文、车厂                                  |
+---------------+---------------------------------------------+---------------------------------------------+
| 3203          | BRO准备就绪异常                             | 车辆准备就绪后变为未就绪                    |
|               |                                             | 报文、车厂                                  |
+---------------+---------------------------------------------+---------------------------------------------+
|               |                                             |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 4000          | 未知停机                                    | 未知                                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 100002        | 读卡器通信告警                              |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 100003        | 防雷器故障                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 100004        | 主开关及熔断器故障                          |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 100005        | 紧急停机故障                                |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 100032        | 电表1通信异常                               |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 100033        | 电表2通信异常                               |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101000        | 断开连接                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101001        | 未准备就绪                                  |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101002        | 充电过压                                    | 电池电压超过设置的过压保护值                |
+---------------+---------------------------------------------+---------------------------------------------+
| 101003        | 充电过流                                    | 充电电流超过设置的电流保护值                |
+---------------+---------------------------------------------+---------------------------------------------+
| 101004        | 充电欠压                                    | 充电电压低于充电机最低输出电压              |
+---------------+---------------------------------------------+---------------------------------------------+
| 101005        | 用户刷卡停止充电                            |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101006        | 后台停止                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101007        | 充电时间达到设定值                          | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 101008        | 充电金额达到设定值                          | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 101009        | 充电电量达到设定值                          | 充电机主动停止                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 101010        | 应用软件升级停止                            | 软件升级                                    |
+---------------+---------------------------------------------+---------------------------------------------+
| 101011        | 系统掉电停止                                | 交流侧突然断电                              |
+---------------+---------------------------------------------+---------------------------------------------+
| 101012        | 未知原因                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101013        | 用户界面中止                                | 在用户界面按停止充电按钮                    |
+---------------+---------------------------------------------+---------------------------------------------+
| 101014        | 金额不足                                    | 充电卡或帐号余额不足                        |
+---------------+---------------------------------------------+---------------------------------------------+
| 101015        | 电池充满                                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
| 101016        | 达到用户设定充电条件停止                    |                                             |
+---------------+---------------------------------------------+---------------------------------------------+
```




    附录3  充电启动失败编码定义


```text
+---------------+------------------------------+---------------------------------------------+
| 编码          | 含义                         | 说明                                        |
+---------------+------------------------------+---------------------------------------------+
| 直流充电桩                                                                                 |
+---------------+------------------------------+---------------------------------------------+
| 1             | CC1未连接                    |                                             |
+---------------+------------------------------+---------------------------------------------+
| 2             | 绝缘检测超时                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 3             | 绝缘检测异常                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 4             | 充电机暂停服务               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 5             | 充电机系统故障,不能充电      |                                             |
+---------------+------------------------------+---------------------------------------------+
| 6             | 辅电不匹配                   |                                             |
+---------------+------------------------------+---------------------------------------------+
| 7             | 辅电开启失败                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 9             | 充电启动超时                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 10            | BMS通信握手失败              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 11            | BMS通信配置失败              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 12            | BMS参数异常                  |                                             |
+---------------+------------------------------+---------------------------------------------+
| 13            | 桩正在充电中，不能再启动     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 14            | 本地模式，不能启动充电       |                                             |
+---------------+------------------------------+---------------------------------------------+
| 15            | 启动未知错误                 |                                             |
+---------------+------------------------------+---------------------------------------------+
| 16            | 桩已预约，启动失败           |                                             |
+---------------+------------------------------+---------------------------------------------+
| 17            | 预约枪口号不存在的           |                                             |
+---------------+------------------------------+---------------------------------------------+
| 18            | 预约账户不一致               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 19            | 保留                         | 没有使用                                    |
+---------------+------------------------------+---------------------------------------------+
| 20            | 参数错误1                    | 命令7的字段4（充电生效类型）值错误          |
+---------------+------------------------------+---------------------------------------------+
| 21            | 参数错误2                    | 命令7的字段7（充电策略参数）值错误，详情见  |
|               |                              | 本表备注1                                   |
+---------------+------------------------------+---------------------------------------------+
| 30            | 其他未定义失败               |                                             |
+---------------+------------------------------+---------------------------------------------+
|               |                              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 80            | 设备不可用                   | 计费模型有误                                |
|               |                              | 充电桩时间错误                              |
|               |                              | 充电桩内部故障                              |
+---------------+------------------------------+---------------------------------------------+
| 96            | 不允许充电操作               | 并充时辅枪不允许启动充电                    |
|               |                              |                                             |
+---------------+------------------------------+---------------------------------------------+
| 交流充电桩                                                                                 |
+---------------+------------------------------+---------------------------------------------+
| 100001        | 充电机系统故障               |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100002        | 车辆准备就绪超时             |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100003        | 桩正在充电中，不能再启动     |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100004        | 本地模式，不能启动充电       |                                             |
+---------------+------------------------------+---------------------------------------------+
| 100005        | 枪口号不对                   |                                             |
+---------------+------------------------------+---------------------------------------------+
```

    备注1：充电策略为1（按时间充电），则充电策略参数最小值为500（即最小时间为5分钟）；充电策略为2（
    按费用充电），则充电策略参数最小值为100（即最小费用为1元钱）；充电策略为3（按电量充电），则充电
    策略参数最小值为100（即最小电量为1度电）；



    附录4  系统告警位定义表（CMD=108全部告警内容字段）

```text
+---------------+---------------+---------------------------------------------+
| 告警字节      | 偏移量        | 告警含义说明                                |
+---------------+---------------+---------------------------------------------+
| 1             | BIT0          | 预留(没有故障)                              |
+---------------+---------------+---------------------------------------------+
| 1             | BIT1          | 紧急停机                                    |
+---------------+---------------+---------------------------------------------+
| 1             | BIT2          | 绝缘故障                                    |
+---------------+---------------+---------------------------------------------+
| 1             | BIT3          | 直流过压                                    |
+---------------+---------------+---------------------------------------------+
| 1             | BIT4          | 直流欠压                                    |
+---------------+---------------+---------------------------------------------+
| 1             | BIT5          | 软启失败                                    |
+---------------+---------------+---------------------------------------------+
| 1             | BIT6          | 直流输出反接                                |
+---------------+---------------+---------------------------------------------+
| 1             | BIT7          | 直流接触器异常                              |
+---------------+---------------+---------------------------------------------+
| 2             | BIT0          | 模块故障                                    |
+---------------+---------------+---------------------------------------------+
| 2             | BIT1          | 交流输入过压                                |
+---------------+---------------+---------------------------------------------+
| 2             | BIT2          | 交流输入欠压                                |
+---------------+---------------+---------------------------------------------+
| 2             | BIT3          | 交流输入过频                                |
+---------------+---------------+---------------------------------------------+
| 2             | BIT4          | 交流输入欠频                                |
+---------------+---------------+---------------------------------------------+
| 2             | BIT5          | 模块通信异常                                |
+---------------+---------------+---------------------------------------------+
| 2             | BIT6          | 模块类型不一致                              |
+---------------+---------------+---------------------------------------------+
| 2             | BIT7          | 系统辅源掉电                                |
+---------------+---------------+---------------------------------------------+
| 3             | BIT0          | 直流输出断路                                |
+---------------+---------------+---------------------------------------------+
| 3             | BIT1          | 进风口过温保护                              |
+---------------+---------------+---------------------------------------------+
| 3             | BIT2          | 进风口低温保护                              |
+---------------+---------------+---------------------------------------------+
| 3             | BIT3          | 出风口过温保护                              |
+---------------+---------------+---------------------------------------------+
| 3             | BIT4          | 群充模块过温                                |
+---------------+---------------+---------------------------------------------+
| 3             | BIT5          | 防雷故障                                    |
+---------------+---------------+---------------------------------------------+
| 3             | BIT6          | 交流接触器异常                              |
+---------------+---------------+---------------------------------------------+
| 3             | BIT7          | 充电枪头过温                                |
+---------------+---------------+---------------------------------------------+
| 4             | BIT0          | 直流输出过流                                |
+---------------+---------------+---------------------------------------------+
| 4             | BIT1          | 充电枪锁异常                                |
+---------------+---------------+---------------------------------------------+
| 4             | BIT2          | 快充段，此枪无效                            |
+---------------+---------------+---------------------------------------------+
| 4             | BIT3          | 门禁保护                                    |
+---------------+---------------+---------------------------------------------+
| 4             | BIT4          | CAN3通信错误（扩展板）                      |
+---------------+---------------+---------------------------------------------+
| 4             | BIT5          | 运行剩余天数无效（old）                     |
|               |               | 群充模块通信故障（new）                     |
+---------------+---------------+---------------------------------------------+
| 4             | BIT6          | 输入缺相                                    |
+---------------+---------------+---------------------------------------------+
| 4             | BIT7          | 控制导引故障                                |
+---------------+---------------+---------------------------------------------+
| 5             | BIT0          | 模块未准备就绪                              |
+---------------+---------------+---------------------------------------------+
| 5             | BIT1          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 5             | BIT2          | 枪锁故障 开锁失败                           |
+---------------+---------------+---------------------------------------------+
| 5             | BIT3          | 枪锁故障 关锁失败                           |
+---------------+---------------+---------------------------------------------+
| 5             | BIT4          | 软起失败，模块没有开启                      |
+---------------+---------------+---------------------------------------------+
| 5             | BIT5          | 软件失败，电池电压没有检测到                |
+---------------+---------------+---------------------------------------------+
| 5             | BIT6          | 电网电压高，告警不停机                      |
+---------------+---------------+---------------------------------------------+
| 5             | BIT7          | 电网电压低，告警不停机                      |
+---------------+---------------+---------------------------------------------+
| 6             | BIT0          | 绝缘异常                                    |
+---------------+---------------+---------------------------------------------+
| 6             | BIT1          | 输出短路                                    |
+---------------+---------------+---------------------------------------------+
| 6             | BIT2          | 模块过温                                    |
+---------------+---------------+---------------------------------------------+
| 6             | BIT3          | 模块异常                                    |
+---------------+---------------+---------------------------------------------+
| 6             | BIT4          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 6             | BIT5          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 6             | BIT6          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 6             | BIT7          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 国网TCU故障，其他客户请无视                                                 |
+---------------+---------------+---------------------------------------------+
| 7             | BIT0          |                                             |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 7             | BIT1          |                                             |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 7             | BIT2          |                                             |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 7             | BIT3          | 紧急停机                                    |
+---------------+---------------+---------------------------------------------+
| 7             | BIT4          | 烟感故障                                    |
+---------------+---------------+---------------------------------------------+
| 7             | BIT5          | 交流输入断路器故障                          |
+---------------+---------------+---------------------------------------------+
| 7             | BIT6          | 输出高压接触器据动/误动故障                 |
+---------------+---------------+---------------------------------------------+
| 7             | BIT7          | 输出高压熔断器故障                          |
+---------------+---------------+---------------------------------------------+
| 8             | BIT0          | 电子锁故障                                  |
+---------------+---------------+---------------------------------------------+
| 8             | BIT1          | 风扇故障                                    |
+---------------+---------------+---------------------------------------------+
| 8             | BIT2          | 防雷器故障                                  |
+---------------+---------------+---------------------------------------------+
| 8             | BIT3          | 绝缘检测故障                                |
+---------------+---------------+---------------------------------------------+
| 8             | BIT4          | 电池反接                                    |
+---------------+---------------+---------------------------------------------+
| 8             | BIT5          | 充电中控制导引故障                          |
+---------------+---------------+---------------------------------------------+
| 8             | BIT6          | 充电机过温                                  |
+---------------+---------------+---------------------------------------------+
| 8             | BIT7          | 充电接口过温                                |
+---------------+---------------+---------------------------------------------+
| 9             | BIT0          | 充电器未归位                                |
+---------------+---------------+---------------------------------------------+
| 9             | BIT1          | BMS通讯故障                                 |
+---------------+---------------+---------------------------------------------+
| 9             | BIT2          | 输入过压                                    |
+---------------+---------------+---------------------------------------------+
| 9             | BIT3          | 输入欠压                                    |
+---------------+---------------+---------------------------------------------+
| 9             | BIT4          | 输出过压                                    |
+---------------+---------------+---------------------------------------------+
| 9             | BIT5          | 输出欠压                                    |
+---------------+---------------+---------------------------------------------+
| 9             | BIT6          | 输出过流                                    |
+---------------+---------------+---------------------------------------------+
| 9             | BIT7          | 模块故障                                    |
+---------------+---------------+---------------------------------------------+
| 10            | BIT0          | 模块交流输入故障                            |
+---------------+---------------+---------------------------------------------+
| 10            | BIT1          | 模块交流输入过压故障                        |
+---------------+---------------+---------------------------------------------+
| 10            | BIT2          | 模块交流输入欠压故障                        |
+---------------+---------------+---------------------------------------------+
| 10            | BIT3          | 模块交流输入缺相故障                        |
+---------------+---------------+---------------------------------------------+
| 10            | BIT4          | 模块直流输出短路                            |
+---------------+---------------+---------------------------------------------+
| 10            | BIT5          | 模块直流输出过流                            |
+---------------+---------------+---------------------------------------------+
| 10            | BIT6          | 模块直流输出过压                            |
+---------------+---------------+---------------------------------------------+
| 10            | BIT7          | 模块直流输出欠压                            |
+---------------+---------------+---------------------------------------------+
| 11            | BIT0          | 直流输出电流过流(old)                       |
|               |               | 充电模块过温                                |
+---------------+---------------+---------------------------------------------+
| 11            | BIT1          | 充电桩监控器离线(old)                       |
|               |               | 充电模块通信故障                            |
+---------------+---------------+---------------------------------------------+
| 11            | BIT2          | 系统采集板离线(old)                         |
|               |               | 充电模块风扇故障                            |
+---------------+---------------+---------------------------------------------+
| 11            | BIT3          | 控制板通讯故障(old)                         |
|               |               | 门禁故障                                    |
+---------------+---------------+---------------------------------------------+
| 11            | BIT4          | 交流输入电压不平衡(old)                     |
|               |               | 直流输出接触器粘连                          |
+---------------+---------------+---------------------------------------------+
| 11            | BIT5          | AC接触器异常(old)                           |
|               |               | 绝缘监测告警                                |
+---------------+---------------+---------------------------------------------+
| 11            | BIT6          | 交流AC输入A相缺相(old)                      |
|               |               | 泄放回路故障                                |
+---------------+---------------+---------------------------------------------+
| 11            | BIT7          | 交流AC输入B相缺相(old)                      |
|               |               | 充电桩过温告警                              |
+---------------+---------------+---------------------------------------------+
| 12            | BIT0          | 交流AC输入C相缺相(old)                      |
|               |               | 充电枪过温告警                              |
+---------------+---------------+---------------------------------------------+
| 12            | BIT1          | 直流输出短路(old)                           |
|               |               | 交流输入接触器拒动/误动故障                 |
+---------------+---------------+---------------------------------------------+
| 12            | BIT2          | 电磁锁故障(old)                             |
|               |               | 交流输入接触器粘连                          |
+---------------+---------------+---------------------------------------------+
| 12            | BIT3          | 熔断器故障(old)                             |
|               |               | 辅源故障                                    |
+---------------+---------------+---------------------------------------------+
| 12            | BIT4          | 电表电量为0(old)                            |
|               |               | 并联接触器故障                              |
+---------------+---------------+---------------------------------------------+
| 12            | BIT5          | 并联接触器粘连                              |
+---------------+---------------+---------------------------------------------+
| 12            | BIT6          | 心跳超时                                    |
+---------------+---------------+---------------------------------------------+
| 12            | BIT7          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 监控上层故障                                                                |
+---------------+---------------+---------------------------------------------+
| 13            | BIT0          | 迪文通信告警(old)                           |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 13            | BIT1          | 电表1通信告警(old)                          |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 13            | BIT2          | 读卡器通信告警(old)                         |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 13            | BIT3          | 电表2通信告警(old)                          |
|               |               | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 13            | BIT4          | 迪文通信告警                                |
+---------------+---------------+---------------------------------------------+
| 13            | BIT5          | 电表通信告警                                |
+---------------+---------------+---------------------------------------------+
| 13            | BIT6          | 读卡器通信告警                              |
+---------------+---------------+---------------------------------------------+
| 13            | BIT7          | CAN1总线错误                                |
+---------------+---------------+---------------------------------------------+
| 14            | BIT0          | BMS总线错误                                 |
+---------------+---------------+---------------------------------------------+
| 14            | BIT1          | 群充+并充通讯错误，停机                     |
+---------------+---------------+---------------------------------------------+
| 14            | BIT2          | 从机故障导致  停机                          |
+---------------+---------------+---------------------------------------------+
| 14            | BIT3          | 上传充电记录异常                            |
+---------------+---------------+---------------------------------------------+
| 14            | BIT4          | 费率参数异常                                |
+---------------+---------------+---------------------------------------------+
| 14            | BIT5          | 注册信息无效，系统异常 暂停服务             |
+---------------+---------------+---------------------------------------------+
| 14            | BIT6          | 版本校验超时                                |
+---------------+---------------+---------------------------------------------+
| 14            | BIT7          | 设置参数无回应                              |
+---------------+---------------+---------------------------------------------+
| 15            | BIT0          | 接收心跳报文超时                            |
+---------------+---------------+---------------------------------------------+
| 15            | BIT1          | 时间同步超时                                |
+---------------+---------------+---------------------------------------------+
| 15            | BIT2          | 数据同步超时                                |
+---------------+---------------+---------------------------------------------+
| 15            | BIT3          | 协议版本不一致                              |
+---------------+---------------+---------------------------------------------+
| 15            | BIT4          | 电表计量异常                                |
+---------------+---------------+---------------------------------------------+
| 15            | BIT5          | 配置不一致                                  |
+---------------+---------------+---------------------------------------------+
| 15            | BIT6          | 同步数据长度不一致                          |
+---------------+---------------+---------------------------------------------+
| 15            | BIT7          | CAN口发送异常                               |
+---------------+---------------+---------------------------------------------+
| 16            | BIT0          | CAN口发送故障                               |
+---------------+---------------+---------------------------------------------+
| 16            | BIT1          | 1号获取日期时间失败                         |
+---------------+---------------+---------------------------------------------+
| 16            | BIT2          | 初始化读取配置超时                          |
+---------------+---------------+---------------------------------------------+
| 16            | BIT3          | 初始化写入配置超时                          |
+---------------+---------------+---------------------------------------------+
| 16            | BIT4          | 初始化同步配置失败                          |
+---------------+---------------+---------------------------------------------+
| 16            | BIT5          | 电表2通信告警                               |
+---------------+---------------+---------------------------------------------+
| 16            | BIT6          | 电能数据更新异常                            |
+---------------+---------------+---------------------------------------------+
| 16            | BIT7          | 电表采集数据异常                            |
+---------------+---------------+---------------------------------------------+
| 17            | BIT0          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT1          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT2          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT3          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT4          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT5          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT6          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 17            | BIT7          | 预留                                        |
+---------------+---------------+---------------------------------------------+
| 分体机层面故障                                                              |
+---------------+---------------+---------------------------------------------+
| 18            | BIT0          | 输入过压故障                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT1          | 输入欠压故障                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT2          | 输入过压告警                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT3          | 输入欠压告警                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT4          | 输入过频                                    |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT5          | 输入欠频                                    |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT6          | 交流接触器故障                              |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 18            | BIT7          | 辅助电源掉电                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT0          | 防雷器故障                                  |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT1          | 急停                                        |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT2          | 门禁告警                                    |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT3          | 进风口过温                                  |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT4          | 进风口低温                                  |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT5          | 出风口过温                                  |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT6          | 群充模块过温                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 19            | BIT7          | 群充模块通信故障                            |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT0          | 电表通信故障                                |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT1          | 充电模块通信故障                            |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT2          | Reserve                                     |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT3          | Reserve                                     |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT4          | Reserve                                     |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT5          | Reserve                                     |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT6          | Reserve                                     |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| 20            | BIT7          | Reserve                                     |
| (分体机)      |               |                                             |
+---------------+---------------+---------------------------------------------+
| …………….   |               | ……………………………………………….       |
+---------------+---------------+---------------------------------------------+
| …………….   |               | ……………………………………………….       |
+---------------+---------------+---------------------------------------------+
| 32            | BIT0          | …………………………………………………      |
+---------------+---------------+---------------------------------------------+
| 32            | BIT1          | …………………………………………………      |
+---------------+---------------+---------------------------------------------+
| 32            | BIT2          | …………………………………………………      |
+---------------+---------------+---------------------------------------------+
| 32            | BIT3          | …………………………………………………      |
+---------------+---------------+---------------------------------------------+
```
















    注：桩出现告警不代表不能继续给车充电，桩出现告警后能不能继续充电要看CMD104中的状态位是否为系统故
    障


    附录5  通信报文校验C参考实现

    unsigned int addChecksum(const char * buffer, int length)

    {

    unsigned int sum=0;

    unsigned int i=0;


    if (!buffer)

    {

    return 0;

    }


    for(i=0;i<length;i++)

    {

    sum = sum + *buffer;

    buffer++;

    }


    return sum&0xff;

    }


    符录6  通信报文交互参考流程




    APP扫码/远程启动流程


    刷卡充电


    后台远程升级


    附录7  不加密报文与加密报文说明

    加密后的“业务数据长度”独立出来，跟之前的报文字段没有关系，加密后的新增加2字节“业务数据长度”
    放在每个报文的业务数据之前，根据是否加密决定报文是否带有2字节“业务数据长度”字段。


    如：以下是CMD01不加密报文的数据域组成

```text
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 序号          | 字段定义      | 长度（字节)   | 说明                         |
| 据            |               |               |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 1             | 预留          | 2             | 预留                         |
| 据            |               |               |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 2             | 预留          | 2             | 预留                         |
| 据            |               |               |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 3*            | 类型          | 1             | 0-查询 1-设置                |
| 据            |               |               |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 4*            | 设置/查询参数 | 4             | 参见“参数地址列表1”        |
| 据            |               | 启始地址      |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 5*            | 设置/查询个数 | 1             | 注：字符串类型一次只能设置一 |
| 据            |               |               |               | 个                           |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 6*            | 设置参数字节  | 2             |                              |
| 据            |               | 数            |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
| 数            | 7*            | 设置数据      | N             | 当类型为设置时才有此字段     |
| 据            |               |               |               |                              |
| 域            |               |               |               |                              |
+---------------+---------------+---------------+---------------+------------------------------+
```


    如：以下是CMD01加密报文的数据域组成

```text
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 加密模式      | 业务数据长度  | 2             | 实际的业务有效数据长度(此字段不参与加密)    |
| 据            | 特有字段      |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 序号          | 字段定义      | 长度（字节)   | 说明                                        |
| 据            |               |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 1             | 预留          | 2             | 预留                                        |
| 据            |               |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 2             | 预留          | 2             | 预留                                        |
| 据            |               |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 3*            | 类型          | 1             | 0-查询 1-设置                               |
| 据            |               |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 4*            | 设置/查询参数 | 4             | 参见“参数地址列表1”                       |
| 据            |               | 启始地址      |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 5*            | 设置/查询个数 | 1             | 注：字符串类型一次只能设置一个              |
| 据            |               |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 6*            | 设置参数字节  | 2             |                                             |
| 据            |               | 数            |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
| 数            | 7*            | 设置数据      | N             | 当类型为设置时才有此字段                    |
| 据            |               |               |               |                                             |
| 域            |               |               |               |                                             |
+---------------+---------------+---------------+---------------+---------------------------------------------+
```



    附录8  CMD112模块告警定义

```text
+---------------+---------------+------------------------------+
| 告警字节      | 偏移量        | 告警含义说明                 |
+---------------+---------------+------------------------------+
| 1             | BIT0          | 输出过压                     |
+---------------+---------------+------------------------------+
| 1             | BIT1          | 过温保护                     |
+---------------+---------------+------------------------------+
| 1             | BIT2          | 模块失控                     |
+---------------+---------------+------------------------------+
| 1             | BIT3          | 风扇故障                     |
+---------------+---------------+------------------------------+
| 1             | BIT4          | DC未较准                     |
+---------------+---------------+------------------------------+
| 1             | BIT5          | 输出反接                     |
+---------------+---------------+------------------------------+
| 1             | BIT6          | 输出欠压                     |
+---------------+---------------+------------------------------+
| 1             | BIT7          | 模块地址冲突                 |
+---------------+---------------+------------------------------+
| 2             | BIT0          | 均流不平衡度                 |
+---------------+---------------+------------------------------+
| 2             | BIT1          | CAN通讯失败                  |
+---------------+---------------+------------------------------+
| 2             | BIT2          | PFC故障                      |
+---------------+---------------+------------------------------+
| 2             | BIT3          | 其他故障(不可恢复故障)       |
+---------------+---------------+------------------------------+
| 2             | BIT4          | DC软启动失败                 |
+---------------+---------------+------------------------------+
| 2             | BIT5          | DC继电器故障                 |
+---------------+---------------+------------------------------+
| 2             | BIT6          | SCI通讯异常                  |
+---------------+---------------+------------------------------+
| 2             | BIT7          | 交流电压快速掉电             |
+---------------+---------------+------------------------------+
| 3             | BIT0          | AC侧电流缺相                 |
+---------------+---------------+------------------------------+
| 3             | BIT1          | 交流输入A相缺相              |
+---------------+---------------+------------------------------+
| 3             | BIT2          | 交流输入B相缺相              |
+---------------+---------------+------------------------------+
| 3             | BIT3          | 交流输入C相缺相              |
+---------------+---------------+------------------------------+
| 3             | BIT4          | 正母线电压过高               |
+---------------+---------------+------------------------------+
| 3             | BIT5          | 负母线电压过高               |
+---------------+---------------+------------------------------+
| 3             | BIT6          | 母线电压过低                 |
+---------------+---------------+------------------------------+
| 3             | BIT7          | 母线电压异常                 |
+---------------+---------------+------------------------------+
| 4             | BIT0          | 电网侧过载                   |
+---------------+---------------+------------------------------+
| 4             | BIT1          | 电网侧过载超次               |
+---------------+---------------+------------------------------+
| 4             | BIT2          | 交流输入过流                 |
+---------------+---------------+------------------------------+
| 4             | BIT3          | 电网电压过高                 |
+---------------+---------------+------------------------------+
| 4             | BIT4          | 电网电压过低                 |
+---------------+---------------+------------------------------+
| 4             | BIT5          | 电网频率过高                 |
+---------------+---------------+------------------------------+
| 4             | BIT6          | 电网频率过低                 |
+---------------+---------------+------------------------------+
|               | BIT7          | 电网快速锁相失败             |
+---------------+---------------+------------------------------+
```


    注：预留的位是0还是1都不要处理。




